"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[45428],{60749:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>t,default:()=>h,frontMatter:()=>r,metadata:()=>c,toc:()=>a});const c=JSON.parse('{"id":"mlops/mlops/event/nats/crd","title":"NATS CRD","description":"NATS CRD","source":"@site/docs/mlops/mlops/event/nats/crd.mdx","sourceDirName":"mlops/mlops/event/nats","slug":"/mlops/mlops/event/nats/crd","permalink":"/docs/mlops/mlops/event/nats/crd","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/mlops/mlops/event/nats/crd.mdx","tags":[],"version":"current","lastUpdatedAt":1735233432000,"frontMatter":{"id":"crd","title":"NATS CRD","sidebar_label":"CRD","description":"NATS CRD","keywords":["nats","crd"]},"sidebar":"mlops","previous":{"title":"CLI","permalink":"/docs/mlops/mlops/event/nats/cli"},"next":{"title":"Auth","permalink":"/docs/mlops/mlops/event/nats/auth"}}');var l=s(74848),i=s(28453);const r={id:"crd",title:"NATS CRD",sidebar_label:"CRD",description:"NATS CRD",keywords:["nats","crd"]},t=void 0,d={},a=[{value:"Account",id:"account",level:2},{value:"Stream",id:"stream",level:2},{value:"Consumer",id:"consumer",level:2}];function o(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.admonition,{type:"warning",children:(0,l.jsxs)(n.p,{children:["Stream, Consumer, Account\uc758 name\uc740 \ud30c\uc77c \uacbd\ub85c\ub85c \uc0ac\uc6a9\ub418\uae30 \ub54c\ubb38\uc5d0 ",(0,l.jsx)(n.code,{children:"[a-z0-9]*"})," 32\uc790 \uc774\ud558\ub85c \ub9cc\ub4dc\ub294 \uac83\uc774 \uc88b\uc2b5\ub2c8\ub2e4. \ubc84\uc804 \uc5c5\ub370\uc774\ud2b8\uc5d0 \ub530\ub77c \uc774 \uc81c\uc57d\uc0ac\ud56d\uc774 \uc0ac\ub77c\uc9c8 \uc218 \uc788\ub2e4\uace0 \ud569\ub2c8\ub2e4."]})}),"\n",(0,l.jsx)(n.h2,{id:"account",children:"Account"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"kubectl explain account.spec\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"apiVersion: jetstream.nats.io/v1beta2\nkind: Account\nmetadata:\n  name: <name>\n  namespace: event\nspec:\n  name: <accountName>\n  servers:\n    - nats://<host>:<port>\n    - nats://<user>:<password>@<host>:<port>\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"Stream"}),"\uacfc ",(0,l.jsx)(n.code,{children:"Consumer"}),"\ub97c \uc0dd\uc131\ud560 \ub54c, ",(0,l.jsx)(n.code,{children:".spec.account"}),"\ub97c \uc124\uc815\ud558\uba74 \ud574\ub2f9 Account \uc815\ubcf4\uc5d0 \ubd80\ud569\ud558\ub294 NATS \uc11c\ubc84\uc5d0\ub9cc \uc0dd\uc131\ub429\ub2c8\ub2e4."]}),"\n",(0,l.jsx)(n.h2,{id:"stream",children:"Stream"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://docs.nats.io/nats-concepts/jetstream/streams",children:"https://docs.nats.io/nats-concepts/jetstream/streams"})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"kubectl explain streams.spec\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'apiVersion: jetstream.nats.io/v1beta2\nkind: Stream\nmetadata:\n  name: <name>\n  namespace: event\nspec:\n  name: <streamName>\n  subjects: # \uc774 Stream\uc774 consume\ud558\ub294 subjects\n    - <subject>\n\n  storage: file # memory | file\n  replicas: 3 # 1, 3, 5 \ub85c \uc124\uc815\n  # noAck: false\n\n  retention: limits # limits | interest | workqueue\n  discard: old # old | new\n  # limits\n  maxAge: "336h" # 00h00m00s | "", \uba54\uc2dc\uc9c0 \ucd5c\ub300 \ubcf4\uad00 \uae30\uac04\n  # maxMsgs: -1 # \ucd5c\ub300 \uc800\uc7a5 \uba54\uc2dc\uc9c0 \uc218\n  # maxBytes: -1 # \ucd5c\ub300 \uc800\uc7a5 \uc6a9\ub7c9\n\n  # maxMsgSize: -1 # \uba54\uc2dc\uc9c0 \ud558\ub098\uc758 \ucd5c\ub300 \ud06c\uae30, default: 1 MB\n\n  # account: <accountName>\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"retention"}),": ",(0,l.jsx)(n.strong,{children:"\uc218\uc815\ubd88\uac00"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"limits"}),": max \uc635\uc158\uc5d0 \uc758\ud574 \uc815\ud574\uc9c4 \uac12\uc744 \ub118\uc5b4\uac04 \uba54\uc2dc\uc9c0\uac00 \uc788\uc744 \ub54c, ",(0,l.jsx)(n.code,{children:"discard"})," \uc635\uc158\uc5d0 \ub530\ub77c \uc0ad\uc81c\ud569\ub2c8\ub2e4","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\ub2e4\ub978 \uc635\uc158\uc73c\ub85c \uc124\uc815\ud558\ub354\ub77c\ub3c4 \ud56d\uc0c1 \uc801\uc6a9\ub418\ub294 \uc81c\ud55c\uc785\ub2c8\ub2e4"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"interest"}),": \ud604\uc7ac \uc815\uc758\ub41c Consumer\uac00 \ubaa8\ub450 \uba54\uc2dc\uc9c0\ub97c \ubc1b\uace0 Ack\ub97c \ubcf4\ub0c8\uc744 \ub54c \uc0ad\uc81c\ud569\ub2c8\ub2e4"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"workqueue"}),": \ud55c Consumer\uac00 \uba54\uc2dc\uc9c0\ub97c \ubc1b\uace0 Ack\ub97c \ubcf4\ub0c8\uc744 \ub54c \uc0ad\uc81c\ud569\ub2c8\ub2e4","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\ud55c Stream\uc5d0 \ub3d9\uc77c\ud55c subject\ub97c \uac16\ub294 Consumer\ub97c \uc815\uc758\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"discard"}),":","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"old"}),": \uac00\uc7a5 \uc624\ub798\ub41c \uba54\uc2dc\uc9c0\ub97c \uc0ad\uc81c\ud569\ub2c8\ub2e4"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"new"}),": \uc0c8\ub85c \ub4e4\uc5b4\uc624\ub294 \uba54\uc2dc\uc9c0\ub97c \uac70\ubd80\ud569\ub2c8\ub2e4"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"consumer",children:"Consumer"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://docs.nats.io/nats-concepts/jetstream/consumers",children:"https://docs.nats.io/nats-concepts/jetstream/consumers"})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"kubectl explain consumer.spec\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'apiVersion: jetstream.nats.io/v1beta2\nkind: Consumer\nmetadata:\n  name: <name>\n  namespace: event\nspec:\n  streamName: <streamName>\n  durableName: <consumerName>\n  deliverPolicy: all # all | last | new | byStartSequence | byStartTime\n  # optStartSeq: 0\n  # optStartTime: "2022-07-05T01:32:00+09:00"\n\n  ackPolicy: explicit # none | all | explicit\n  ackWait: 10m\n  maxAckPending: 100\n  maxDeliver: 3\n\n  # account: <accountName>\n\n  ########\n  # pull #\n  ########\n  maxWaiting: 512 # pull \uc751\ub2f5\uc744 \ubc1b\uae30 \uc704\ud574 \ub300\uae30\ud558\uace0 \uc788\ub294 \ucd5c\ub300 \uc694\uccad \uc218\n\n  ########\n  # push #\n  ########\n  # \ud074\ub77c\uc774\uc5b8\ud2b8\uac00 deliverSubject\ub97c subscribe\ud558\uba74 \uc11c\ubc84\uac00 \uba54\uc2dc\uc9c0\ub97c push\n  deliverSubject: <deliverSubject>\n  # deliverGroup: <queueGroup>\n\n  rateLimitBps: -1\n'})}),"\n",(0,l.jsx)(n.admonition,{type:"info",children:(0,l.jsxs)(n.p,{children:["Pull Consumer\ub294 ",(0,l.jsx)(n.code,{children:"deliverGroup: <queueGroup>"}),"\uacfc ",(0,l.jsx)(n.code,{children:"ackPolicy: explicit"}),"\uc744 \uc124\uc815\ud55c Push Consumer\uc640 \uae30\ub2a5\uc801\uc73c\ub85c \ub3d9\uc77c\ud569\ub2c8\ub2e4."]})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"filterSubject"}),": stream\uc758 subject\ub97c \ud544\ud130\ub9c1\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n",(0,l.jsxs)(n.li,{children:["Ack \uc815\ucc45","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"ackPolicy"}),": ",(0,l.jsx)(n.strong,{children:"\uc218\uc815\ubd88\uac00"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"none"})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"all"}),": \uc911\uac04\uc5d0 \ud55c \ubc88\uc774\ub77c\ub3c4 Ack \uc751\ub2f5\uc744 \ubc1b\uc73c\uba74 \uc774\uc804\uc5d0 \ubc1b\uc740 \uba54\uc2dc\uc9c0\ub294 Ack\ub97c \ubc1b\uc740 \uac83\uc73c\ub85c \uac04\uc8fc"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"explicit"}),": \ubaa8\ub4e0 \uba54\uc2dc\uc9c0\uc5d0 Ack \uc751\ub2f5(Pull\uc5d0\uc11c\ub9cc \uc0ac\uc6a9 \uac00\ub2a5)"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"maxAckPending"}),": Ack \uc815\ucc45\uc744 \uc0ac\uc6a9\ud560 \ub54c, \ud074\ub77c\uc774\uc5b8\ud2b8\uac00 \uba54\uc2dc\uc9c0\ub97c \uac00\uc838\uac04 \ud6c4 Ack\ub97c \ubcf4\ub0b4\uc9c0 \uc54a\uc740 \uba54\uc2dc\uc9c0 \uc218\uac00 \uc774 \uac12\uc744 \ub118\uc5b4\uac00\uba74 \uc77c\uc2dc \uc911\uc9c0\ub429\ub2c8\ub2e4."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"ackWait"}),": ",(0,l.jsx)(n.code,{children:"00h00m00s"})," Ack \uc815\ucc45\uc744 \uc0ac\uc6a9\ud560 \ub54c, \ud074\ub77c\uc774\uc5b8\ud2b8\uac00 \uba54\uc2dc\uc9c0\ub97c \uac00\uc838\uac04 \ud6c4 ",(0,l.jsx)(n.code,{children:"ackWait"})," \uc2dc\uac04 \uc774\ub0b4\uc5d0 Ack\ub97c \ubcf4\ub0b4\uc9c0 \uc54a\uc73c\uba74 \uba54\uc2dc\uc9c0\uac00 \uc7ac\uc804\uc1a1 \ub429\ub2c8\ub2e4."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"maxDeliver"}),": Ack \uc815\ucc45\uc73c\ub85c \uc778\ud574 \uc7ac\uc804\uc1a1 \ub420 \ub54c, \ucd5c\ub300 \uc7ac\uc2dc\ub3c4 \ud69f\uc218"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"deliverPolicy"}),": ",(0,l.jsx)(n.strong,{children:"\uc218\uc815\ubd88\uac00"}),", Consumer\ub97c '\uc0dd\uc131'\ud588\uc744 \ub54c \uc2dc\uc791 \uc704\uce58","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"all"}),": \uac00\uc7a5 \uccab \ubc88\uc9f8 \uba54\uc2dc\uc9c0\ubd80\ud130 \uac00\uc838\uac10"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"last"}),": \uac00\uc7a5 \ub9c8\uc9c0\ub9c9 \uba54\uc2dc\uc9c0\ubd80\ud130 \uac00\uc838\uac10"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"new"}),": \uc0c8\ub85c \ub4e4\uc5b4\uc624\ub294 \uba54\uc2dc\uc9c0\ubd80\ud130 \uac00\uc838\uac10"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"byStartSequence"}),": ",(0,l.jsx)(n.code,{children:"optStartSeq"}),"\uc5d0 \uc124\uc815\ub41c \uba54\uc2dc\uc9c0\ubd80\ud130 \uac00\uc838\uac10"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"byStartTime"}),": ",(0,l.jsx)(n.code,{children:"optStartTime"}),"\uc5d0 \uc124\uc815\ub41c \uc2dc\uac04 \uc774\ud6c4 \uba54\uc2dc\uc9c0\ubd80\ud130 \uac00\uc838\uac10"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"replayPolicy"}),": ",(0,l.jsx)(n.strong,{children:"\uc218\uc815\ubd88\uac00"}),", deliverPolicy\uc5d0 \ub530\ub77c \uc774\uc804 \uba54\uc2dc\uc9c0\ubd80\ud130 \uba54\uc2dc\uc9c0\ub97c replay\ud560 \ub54c, \uc6d0\ub798 \uba54\uc2dc\uc9c0\ub97c \ubc1b\uc740 \uc18d\ub3c4\ub85c \ud560\uc9c0 \uc544\ub2c8\uba74 \uac00\ub2a5\ud55c \ube60\ub978 \uc18d\ub3c4\ub85c \ud560\uc9c0 \uacb0\uc815","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"instant"}),": \uac00\ub2a5\ud55c \ube60\ub978 \uc18d\ub3c4\ub85c replay"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"original"}),": \uc6d0\ub798 \uba54\uc2dc\uc9c0\ub97c \ubc1b\uc740 \uc18d\ub3c4\ub85c replay"]}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>t});var c=s(96540);const l={},i=c.createContext(l);function r(e){const n=c.useContext(i);return c.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),c.createElement(i.Provider,{value:n},e.children)}}}]);