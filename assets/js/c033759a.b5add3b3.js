"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[97670],{20447:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>a,frontMatter:()=>r,metadata:()=>l,toc:()=>t});const l=JSON.parse('{"id":"mlops/storage/ceph/pg","title":"Ceph Placement Group(PG) \uad00\ub9ac","description":"Ceph Placement Group(PG) \uad00\ub9ac","source":"@site/docs/mlops/storage/ceph/pg.mdx","sourceDirName":"mlops/storage/ceph","slug":"/mlops/storage/ceph/pg","permalink":"/docs/mlops/storage/ceph/pg","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/mlops/storage/ceph/pg.mdx","tags":[],"version":"current","lastUpdatedAt":1745336627000,"frontMatter":{"id":"pg","title":"Ceph Placement Group(PG) \uad00\ub9ac","sidebar_label":"PG \uad00\ub9ac","description":"Ceph Placement Group(PG) \uad00\ub9ac","keywords":["ceph","pg"]},"sidebar":"storage","previous":{"title":"OSD \uad00\ub9ac","permalink":"/docs/mlops/storage/ceph/osd"},"next":{"title":"Shared File System","permalink":"/docs/mlops/storage/ceph/cephfs"}}');var c=s(74848),i=s(28453);const r={id:"pg",title:"Ceph Placement Group(PG) \uad00\ub9ac",sidebar_label:"PG \uad00\ub9ac",description:"Ceph Placement Group(PG) \uad00\ub9ac",keywords:["ceph","pg"]},d=void 0,o={},t=[{value:"Placement Group(PG)",id:"placement-grouppg",level:2},{value:"PG AutoScale",id:"pg-autoscale",level:2},{value:"PG State",id:"pg-state",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.h2,{id:"placement-grouppg",children:"Placement Group(PG)"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.a,{href:"/docs/mlops/storage/ceph/osd#data-%ED%9D%90%EB%A6%84",children:"Data \ud750\ub984"})}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["OSD\ub2f9 100 \uac1c\uc758 PG\ub97c \uac16\ub294 \uac83\uc774 \uad8c\uc7a5\ub418\uba70, PG \uc218\ub294(",(0,c.jsx)(n.strong,{children:"pg_num"}),")\uc740 2\uc758 \uac70\ub4ed\uc81c\uacf1\uc73c\ub85c \uc124\uc815\ud574\uc57c\ud569\ub2c8\ub2e4."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"            (OSDs) * 100\nTotal PGs = ------------\n              pool size\n"})}),"\n",(0,c.jsxs)(n.p,{children:["pool size\ub294 \ubcf5\uc81c\ubcf8 \uc218 \ub610\ub294 EC\uc758 K+M \uac12\uc785\ub2c8\ub2e4. OSD 200 \uac1c\uc5d0 \ubcf5\uc81c\ubcf8 3 \uac1c\ub97c \uac16\ub294 pool\uc758 PG\ub294 ",(0,c.jsx)(n.code,{children:"(200 * 100)/ 3 = 6667 <= 8192"}),"\uc73c\ub85c \uacc4\uc0b0\ub420 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n",(0,c.jsx)(n.h2,{id:"pg-autoscale",children:"PG AutoScale"}),"\n",(0,c.jsx)(n.admonition,{title:"Reference",type:"info",children:(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.a,{href:"https://docs.ceph.com/en/latest/rados/operations/placement-groups/#autoscaling-placement-groups",children:"Ceph / Operations / Placement Groups # Autoscaling placement groups"})}),"\n"]})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"kubectl rook-ceph ceph osd pool set <pool> <option> <value>\n"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"<option>"}),": ",(0,c.jsx)(n.code,{children:"<value>"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"pg_autoscale_mode"}),": ",(0,c.jsx)(n.code,{children:"on"}),"|",(0,c.jsx)(n.code,{children:"warn"}),"|",(0,c.jsx)(n.code,{children:"off"})]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"target_size_bytes"}),": ",(0,c.jsx)(n.code,{children:"<targetSize>"})]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"target_size_ratio"}),": ",(0,c.jsx)(n.code,{children:"<targetRatio>"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"target_size_bytes"}),"\ubcf4\ub2e4 \uc6b0\uc120 \uc21c\uc704\uac00 \ub192\uc73c\ubbc0\ub85c, \ub458 \ub2e4 \uc120\uc5b8\ud558\uba74 ",(0,c.jsx)(n.code,{children:"target_size_bytes"}),"\ub294 \ubb34\uc2dc\ub429\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"bulk"}),": ",(0,c.jsx)(n.code,{children:"<bool>"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"kubectl rook-ceph ceph config set global mon_target_pg_per_osd 100\n"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"kubectl rook-ceph ceph osd pool autoscale-status\n"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"POOL"})}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"SIZE"}),": \uc0ac\uc6a9\uc790\uac00 \uc800\uc7a5\ud55c \ub370\uc774\ud130 \ud06c\uae30\uc785\ub2c8\ub2e4."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"TARGET SIZE"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\uad00\ub9ac\uc790\uac00 \uc608\uc0c1\ud558\ub294 ",(0,c.jsx)(n.code,{children:"SIZE"}),"\uc785\ub2c8\ub2e4."]}),"\n",(0,c.jsxs)(n.li,{children:["autoscaler\ub294 max(targetSize, ",(0,c.jsx)(n.code,{children:"\uc2e4\uc81c \uc0ac\uc6a9\uc790\uac00 \uc800\uc7a5\ud55c \ub370\uc774\ud130 \ud06c\uae30"}),") \uac12\uc744 \uace0\ub824\ud569\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"RATE"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"\ubcf5\uc81c\ubcf8 \ub4f1\uc744 \ud3ec\ud568\ud55c \ub370\uc774\ud130 \ud06c\uae30"}),"/",(0,c.jsx)(n.code,{children:"\uc0ac\uc6a9\uc790\uac00 \uc800\uc7a5\ud55c \ub370\uc774\ud130 \ud06c\uae30"})," \uc785\ub2c8\ub2e4."]}),"\n",(0,c.jsxs)(n.li,{children:["\ub2e8\uc21c\ud788 ",(0,c.jsx)(n.code,{children:"\uc0ac\uc6a9\uc790\uac00 \uc800\uc7a5\ud55c \ub370\uc774\ud130"})," + ",(0,c.jsx)(n.code,{children:"\ubcf5\uc81c\ubcf8 1\uac1c"}),"\uc778 \uacbd\uc6b0 2.0\uc774 \ub429\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"RAW CAPACITY"}),": CRUSH\uc5d0 \uc758\ud574 pool\uc774 \ub9e4\ud551\ub41c \uc800\uc7a5 \uc7a5\uce58\uc758 \ucd1d \uc6a9\ub7c9\uc785\ub2c8\ub2e4."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"RATIO"}),": ",(0,c.jsx)(n.code,{children:"SIZE"})," * ",(0,c.jsx)(n.code,{children:"RATE"})," / ",(0,c.jsx)(n.code,{children:"RAW CAPACITY"})]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"TARGET RATIO"}),": \uad00\ub9ac\uc790\uac00 \uc608\uc0c1\ud558\ub294 ",(0,c.jsx)(n.code,{children:"RATIO"}),"\uc785\ub2c8\ub2e4."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"EFFECTIVE RATIO"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"TARGET SIZE"}),"\uac00 \uc124\uc815\ub41c \uacbd\uc6b0 \uc608\uc0c1\ub418\ub294 \uc6a9\ub7c9\uc744 \uace0\ub824\ud569\ub2c8\ub2e4."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"TARGET RATIO"}),"\uac12\ub4e4\uc744 \uc815\uaddc\ud654 \ud569\ub2c8\ub2e4."]}),"\n",(0,c.jsxs)(n.li,{children:["e.g., ",(0,c.jsx)(n.code,{children:"TARGET RATIO"}),"\uac00 1.0\uc778 pool\uc774 2\uac1c\uac00 \uc788\ub2e4\uba74, \uac01\uac01\uc758 ",(0,c.jsx)(n.code,{children:"EFFECTIVE RATIO"}),"\ub294 0.5\uac00 \ub429\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"BIAS"}),": \uc608\uc0c1\ub418\ub294 PG_NUM\uc5d0 \uacf1\ud574\uc9c0\ub294 \uac00\uc911\uce58\ub85c, 1 \ubcf4\ub2e4 \ud06c\uba74 \ub354 \ub9ce\uc740 PG_NUM\uc744 \ud560\ub2f9\ud569\ub2c8\ub2e4."]}),"\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"PG_NUM"})}),"\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.strong,{children:"NEW PG_NUM"})}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"AUTOSCALE"}),": ",(0,c.jsx)(n.code,{children:"on"}),"|",(0,c.jsx)(n.code,{children:"warning"}),"|",(0,c.jsx)(n.code,{children:"off"})]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"BULK"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"True"}),"|",(0,c.jsx)(n.code,{children:"False"})]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"BULK"})," \uc124\uc815\ub418\uba74 \ucd5c\ub300\uce58\uc5d0 \uac00\uae4c\uc6b4 PG_NUM\uc744 \ud560\ub2f9\ud558\uace0, \uc0c1\ud669\uc5d0 \ub530\ub77c PG_NUM\uc744 \uc904\uc785\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"pg-state",children:"PG State"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"creating"}),"\n",(0,c.jsx)(n.li,{children:"peering"}),"\n",(0,c.jsx)(n.li,{children:"active"}),"\n",(0,c.jsx)(n.li,{children:"clean: PG\uc5d0 \uc788\ub294 \ubaa8\ub4e0 Object\uc758 \ubcf5\uc81c\ubcf8\uc774 \uc77c\uce58\ud558\ub294 \uc0c1\ud0dc\uc785\ub2c8\ub2e4."}),"\n",(0,c.jsx)(n.li,{children:"degraded: PG\uc5d0 \uc788\ub294 Object\uc758 \ubcf5\uc81c\ubcf8\uc774 \uc77c\uce58\ud558\uc9c0 \uc54a\ub294 \uc0c1\ud0dc\uc785\ub2c8\ub2e4."}),"\n",(0,c.jsx)(n.li,{children:"recovering: OSD\uac00 down\ub418\uc5c8\ub2e4\uac00 up\ub418\uc5c8\uc744 \ub54c, \ucd5c\uc2e0 \uc0c1\ud0dc\ub85c \ubcf5\uad6c\ud558\ub294 \uc911\uc778 \uc0c1\ud0dc\uc785\ub2c8\ub2e4."}),"\n",(0,c.jsxs)(n.li,{children:["backfilling","\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"PG\uac00 \ub2e4\ub978 OSD\ub85c \uc7ac\ubc30\uce58\ub418\uc5c8\uc744 \ub54c, \uae30\uc874 OSD\uc5d0\uc11c \ubcc0\uacbd\ub41c OSD\ub85c \ub370\uc774\ud130\ub97c \ubcf5\uc0ac\ud558\ub294 \uc911\uc778 \uc0c1\ud0dc\uc785\ub2c8\ub2e4."}),"\n",(0,c.jsx)(n.li,{children:"OSD\uac00 \uc0c8\ub85c \ucd94\uac00\ub418\uc5c8\uc744 \ub54c, CRUSH\ub294 PG\ub4e4\uc744 \uc7ac\ubc30\uce58\ud558\uc5ec \uc0c8\ub85c\uc6b4 OSD\ub97c \ubc14\ub85c \uc4f8 \uc218 \uc788\ub3c4\ub85d \ub9cc\ub4ed\ub2c8\ub2e4."}),"\n",(0,c.jsx)(n.li,{children:"\ubd80\ud558\uac00 \ud070 \uc791\uc5c5\uc785\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.li,{children:"remapped: Acting Set\uc744 \ubcc0\uacbd\ud558\ub294 \uc911\uc778 \uc0c1\ud0dc\uc785\ub2c8\ub2e4."}),"\n",(0,c.jsx)(n.li,{children:"stale"}),"\n"]})]})}function a(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(h,{...e})}):h(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>d});var l=s(96540);const c={},i=l.createContext(c);function r(e){const n=l.useContext(i);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:r(e.components),l.createElement(i.Provider,{value:n},e.children)}}}]);