"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[34157],{10509:(e,a,l)=>{l.r(a),l.d(a,{assets:()=>m,contentTitle:()=>h,default:()=>d,frontMatter:()=>c,metadata:()=>n,toc:()=>p});const n=JSON.parse('{"id":"mlops/nn/llm/parallelism","title":"Parallelism","description":"Parallelism","source":"@site/docs/mlops/nn/llm/parallelism.mdx","sourceDirName":"mlops/nn/llm","slug":"/mlops/nn/llm/parallelism","permalink":"/docs/mlops/nn/llm/parallelism","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/mlops/nn/llm/parallelism.mdx","tags":[],"version":"current","lastUpdatedAt":1757954045000,"frontMatter":{"id":"parallelism","title":"Parallelism","sidebar_label":"Parallelism","description":"Parallelism","keywords":["Neural Network","Large Model","Parallelism"]},"sidebar":"nn","previous":{"title":"GNN","permalink":"/docs/mlops/nn/gnn/"},"next":{"title":"Transformer (1706)","permalink":"/docs/mlops/nn/llm/transformer"}}');var i=l(74848),s=l(28453),t=l(98180),r=l(79883);const c={id:"parallelism",title:"Parallelism",sidebar_label:"Parallelism",description:"Parallelism",keywords:["Neural Network","Large Model","Parallelism"]},h=void 0,m={},p=[{value:"Data Parallelism(DP)",id:"data-parallelismdp",level:2},{value:"Pipeline Parallelism(PP)",id:"pipeline-parallelismpp",level:2},{value:"Tensor Parallelism(TP)",id:"tensor-parallelismtp",level:2},{value:"3D Parallelism",id:"3d-parallelism",level:2}];function o(e){const a={a:"a",annotation:"annotation",h2:"h2",math:"math",mermaid:"mermaid",mi:"mi",mrow:"mrow",p:"p",semantics:"semantics",span:"span",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.h2,{id:"data-parallelismdp",children:"Data Parallelism(DP)"}),"\n",(0,i.jsx)(a.mermaid,{value:"graph LR\n  batch0-0@{ shape: procs, label: Batch0-0 }\n  batch1-0@{ shape: procs, label: Batch1-0 }\n  batch0-1@{ shape: procs, label: Batch0-1 }\n  batch1-1@{ shape: procs, label: Batch1-1 }\n\n  subgraph calc0[forward & backward]\n    gpu0-0[GPU0]\n    gpu1-0[GPU1]\n  end\n\n  batch0-0 --\x3e gpu0-0\n  Weight-0 --\x3e gpu0-0\n\n  batch1-0 --\x3e gpu1-0\n  Weight-0 --\x3e gpu1-0\n\n  Weight-0 --\x3e Weight-1\n  gpu0-0 --\x3e Weight-1\n  gpu1-0 --\x3e Weight-1\n\n  subgraph calc1[forward & backward]\n    gpu0-1[GPU0]\n    gpu1-1[GPU1]\n  end\n\n  batch0-1 --\x3e gpu0-1\n  Weight-1 --\x3e gpu0-1\n\n  batch1-1 --\x3e gpu1-1\n  Weight-1 --\x3e gpu1-1\n\n  Weight-1 --\x3e Weight-2\n  gpu0-1 --\x3e Weight-2\n  gpu1-1 --\x3e Weight-2"}),"\n",(0,i.jsxs)(a.p,{children:["Multi GPU \ud658\uacbd\uc5d0\uc11c \ub370\uc774\ud130\ub97c \ubcd1\ub82c\ud654\ud558\uc5ec \ubaa8\ub378\uc744 \ud559\uc2b5\ud558\ub294 \ubc29\ubc95\uc785\ub2c8\ub2e4. \ub9e4 \uc2a4\ud15d\ub9c8\ub2e4 ",(0,i.jsxs)(a.span,{className:"katex",children:[(0,i.jsx)(a.span,{className:"katex-mathml",children:(0,i.jsx)(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(a.semantics,{children:[(0,i.jsxs)(a.mrow,{children:[(0,i.jsx)(a.mi,{mathvariant:"normal",children:"\u0394"}),(0,i.jsx)(a.mi,{mathvariant:"bold",children:"w"})]}),(0,i.jsx)(a.annotation,{encoding:"application/x-tex",children:"\\Delta \\mathbf{w}"})]})})}),(0,i.jsx)(a.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(a.span,{className:"base",children:[(0,i.jsx)(a.span,{className:"strut",style:{height:"0.6833em"}}),(0,i.jsx)(a.span,{className:"mord",children:"\u0394"}),(0,i.jsx)(a.span,{className:"mord mathbf",style:{marginRight:"0.01597em"},children:"w"})]})})]}),"\ub97c \uc9d1\uacc4\ud558\uc5ec ",(0,i.jsxs)(a.span,{className:"katex",children:[(0,i.jsx)(a.span,{className:"katex-mathml",children:(0,i.jsx)(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(a.semantics,{children:[(0,i.jsx)(a.mrow,{children:(0,i.jsx)(a.mi,{children:"W"})}),(0,i.jsx)(a.annotation,{encoding:"application/x-tex",children:"W"})]})})}),(0,i.jsx)(a.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(a.span,{className:"base",children:[(0,i.jsx)(a.span,{className:"strut",style:{height:"0.6833em"}}),(0,i.jsx)(a.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"W"})]})})]}),"\ub97c \uc5c5\ub370\uc774\ud2b8\ud558\ub294 \ube44\uc6a9\uc774 \ucd94\uac00\uc801\uc73c\ub85c \ubc1c\uc0dd\ud569\ub2c8\ub2e4."]}),"\n",(0,i.jsxs)(a.p,{children:["\ubaa8\ub378\uc774 \ucee4\uc9d0\uc5d0 \ub530\ub77c \ubc1c\uc0dd\ud558\ub294 \uba54\ubaa8\ub9ac \ubb38\uc81c\ub97c \ud574\uacb0\ud558\uae30 \uc704\ud574 ",(0,i.jsx)(a.a,{href:"https://www.microsoft.com/en-us/research/blog/zero-deepspeed-new-system-optimizations-enable-training-models-with-over-100-billion-parameters/",children:"ZeRO"}),"\ub97c \ud568\uaed8 \uc0ac\uc6a9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n",(0,i.jsx)(a.h2,{id:"pipeline-parallelismpp",children:"Pipeline Parallelism(PP)"}),"\n",(0,i.jsx)(a.mermaid,{value:"graph LR\n  batch-0@{ shape: procs, label: Batch-0 }\n  batch-1@{ shape: procs, label: Batch-1 }\n\n  subgraph calc0[forward & backward]\n    direction LR\n    gpu0-0[GPU0] -- feature --\x3e gpu1-0[GPU1]\n  end\n\n  batch-0 --\x3e gpu0-0\n  Weight-0 --\x3e Weight0-0[weight0-0]\n  Weight-0 --\x3e Weight1-0\n  Weight0-0 --\x3e gpu0-0\n  Weight1-0 --\x3e gpu1-0\n\n\n  Weight0-0 --\x3e Weight0-1\n  gpu0-0 --\x3e Weight0-1\n\n  Weight1-0 --\x3e Weight1-1\n  gpu1-0 --\x3e Weight1-1\n\n  subgraph calc1[forward & backward]\n    direction LR\n    gpu0-1[GPU0] -- feature --\x3e gpu1-1[GPU1]\n  end\n\n  batch-1 --\x3e gpu0-1\n  Weight0-1 --\x3e gpu0-1\n\n  Weight1-1 --\x3e gpu1-1\n\n  Weight0-1 --\x3e Weight0-2\n  gpu0-1 --\x3e Weight0-2\n\n  Weight1-1 --\x3e Weight1-2\n  gpu1-1 --\x3e Weight1-2\n\n  Weight0-2 --\x3e Weight-2\n  Weight1-2 --\x3e Weight-2"}),"\n",(0,i.jsx)(a.p,{children:"Multi GPU \ud658\uacbd\uc5d0\uc11c \ubaa8\ub378\uc744 \ub808\uc774\uc5b4 \ub2e8\uc704\ub85c \ubd84\ud560\ud558\uc5ec \ubcd1\ub82c\ud654\ud558\ub294 \ubc29\ubc95\uc785\ub2c8\ub2e4. \ub808\uc774\uc5b4 \ub2e8\uc704\ub85c \ubd84\ud560\ud574\uc11c \ubcd1\ub82c\ud654\ud558\uae30 \ub54c\ubb38\uc5d0 \ubaa8\ub378\uc774 \ucee4\uc9d0\uc5d0 \ub530\ub77c \ubc1c\uc0dd\ud558\ub294 \uba54\ubaa8\ub9ac \ubb38\uc81c\ub97c \ud574\uacb0\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \ub2e8, \uac01 \ub808\uc774\uc5b4\ub294 \uc774\uc804 \ub808\uc774\uc5b4\uc758 \ucd9c\ub825\uc744 \uc785\ub825\uc73c\ub85c \ubc1b\uc544\uc57c\ud558\ubbc0\ub85c \uc77c\ubd80 GPU\uac00 \uc544\ubb34\uc77c\ub3c4 \ud558\uc9c0 \uc54a\ub294 Bubble\uc774\ub77c\ub294 \ubb38\uc81c\uac00 \ubc1c\uc0dd\ud569\ub2c8\ub2e4."}),"\n",(0,i.jsx)("center",{children:(0,i.jsxs)("figure",{children:[(0,i.jsx)(r.A,{src:(0,t.Ay)("img/mlops/nn/llm/parallelism/micro-batch-pipeline-parallelism.drawio")}),(0,i.jsx)("figcaption",{children:(0,i.jsx)(a.p,{children:(0,i.jsx)(a.a,{href:"https://arxiv.org/pdf/1811.06965",children:"Figure 2 - GPipe: Easy Scaling with Micro-Batch Pipeline Parallelism"})})})]})}),"\n",(0,i.jsx)(a.p,{children:"\uc774 \ubb38\uc81c\ub97c \ud574\uacb0\ud558\uae30 \uc704\ud574 \uc704 \uadf8\ub9bc\ucc98\ub7fc mini-batch\ub97c \ub354 \uc791\uc740 \ub2e8\uc704\uc778 micro-batch\ub85c \ub098\ub220\uc11c \ucc98\ub9ac\ud558\ub294 \ubc29\ubc95 \ub4f1\uc774 \uc788\uc2b5\ub2c8\ub2e4."}),"\n",(0,i.jsx)(a.h2,{id:"tensor-parallelismtp",children:"Tensor Parallelism(TP)"}),"\n",(0,i.jsx)(a.p,{children:"Multi GPU \ud658\uacbd\uc5d0\uc11c \ub808\uc774\uc5b4 \uc790\uccb4\ub97c \ubd84\ud560\ud558\uc5ec \ubcd1\ub82c\ud654\ud558\ub294 \ubc29\ubc95\uc785\ub2c8\ub2e4."}),"\n",(0,i.jsx)(a.h2,{id:"3d-parallelism",children:"3D Parallelism"}),"\n",(0,i.jsxs)("center",{children:[(0,i.jsx)("img",{className:"bg-white",src:(0,t.Ay)("img/mlops/nn/llm/parallelism/3d-parallelism-1.png")}),(0,i.jsx)("figcaption",{children:(0,i.jsx)(a.p,{children:(0,i.jsx)(a.a,{href:"https://www.microsoft.com/en-us/research/blog/deepspeed-extreme-scale-model-training-for-everyone/",children:"Figure 1 - DeepSpeed: Extreme-scale model training for\neveryone"})})}),(0,i.jsx)("img",{className:"bg-white",src:(0,t.Ay)("img/mlops/nn/llm/parallelism/3d-parallelism-2.png")}),(0,i.jsx)("figcaption",{children:(0,i.jsx)(a.p,{children:(0,i.jsx)(a.a,{href:"https://www.microsoft.com/en-us/research/blog/deepspeed-extreme-scale-model-training-for-everyone/",children:"Figure 2 - DeepSpeed: Extreme-scale model training for\neveryone"})})})]})]})}function d(e={}){const{wrapper:a}={...(0,s.R)(),...e.components};return a?(0,i.jsx)(a,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},28453:(e,a,l)=>{l.d(a,{R:()=>t,x:()=>r});var n=l(96540);const i={},s=n.createContext(i);function t(e){const a=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function r(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),n.createElement(s.Provider,{value:a},e.children)}},79883:(e,a,l)=>{l.d(a,{A:()=>s});var n=l(96540),i=l(74848);function s(e){let{src:a}=e;const[l,s]=(0,n.useState)("loading..."),t=(0,n.useRef)(null);return(0,n.useEffect)((()=>{if("undefined"==typeof window)return;const e=window.GraphViewer;e?fetch(a).then((e=>{if(!e.ok)throw new Error("Failed to fetch drawio file");return e.text()})).then((a=>{if(!a)return void s("Drawio file is empty");const l={editable:"_blank",highlight:"#0000ff",nav:!0,resize:!0,toolbar:"zoom lightbox",xml:a};t.current.dataset.mxgraph=JSON.stringify(l),s(""),setTimeout((()=>{e.createViewerForElement(t.current)}),0)})).catch((e=>{s("Failed to load diagram: "+e.message)})):s("GraphViewer is not loaded")}),[a]),(0,i.jsxs)("div",{className:"w-full p-4",children:[l&&(0,i.jsx)("p",{children:l}),(0,i.jsx)("div",{className:"w-full bg-white",ref:t})]})}}}]);