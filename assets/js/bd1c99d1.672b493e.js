"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[92350],{28453:(e,t,r)=>{r.d(t,{R:()=>i,x:()=>l});var n=r(96540);const o={},s=n.createContext(o);function i(e){const t=n.useContext(s);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),n.createElement(s.Provider,{value:t},e.children)}},28590:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>a,contentTitle:()=>l,default:()=>d,frontMatter:()=>i,metadata:()=>n,toc:()=>p});const n=JSON.parse('{"id":"lang/go/libraries/reverse-proxy","title":"HTTP Reverse Proxy \uc124\uc815 \uac00\uc774\ub4dc","description":"HTTP Reverse Proxy \uc124\uc815 \uac00\uc774\ub4dc","source":"@site/docs/lang/go/libraries/reverse-proxy.mdx","sourceDirName":"lang/go/libraries","slug":"/lang/go/libraries/reverse-proxy","permalink":"/docs/lang/go/libraries/reverse-proxy","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/lang/go/libraries/reverse-proxy.mdx","tags":[],"version":"current","lastUpdatedAt":1761493575000,"frontMatter":{"id":"reverse-proxy","title":"HTTP Reverse Proxy \uc124\uc815 \uac00\uc774\ub4dc","sidebar_label":"Reverse Proxy \uc124\uc815 \uac00\uc774\ub4dc","description":"HTTP Reverse Proxy \uc124\uc815 \uac00\uc774\ub4dc","keywords":["http","reverse proxy"]},"sidebar":"go","previous":{"title":"WebSocket","permalink":"/docs/lang/go/libraries/websocket"},"next":{"title":"Custom Email \ubcf4\ub0b4\uae30","permalink":"/docs/lang/go/libraries/firebase/custom-email"}}');var o=r(74848),s=r(28453);const i={id:"reverse-proxy",title:"HTTP Reverse Proxy \uc124\uc815 \uac00\uc774\ub4dc",sidebar_label:"Reverse Proxy \uc124\uc815 \uac00\uc774\ub4dc",description:"HTTP Reverse Proxy \uc124\uc815 \uac00\uc774\ub4dc",keywords:["http","reverse proxy"]},l=void 0,a={},p=[{value:"httputil.ReverseProxy",id:"httputilreverseproxy",level:2},{value:"Director or Rewrite \uc124\uc815",id:"director-or-rewrite-\uc124\uc815",level:3},{value:"httputil.NewSingleHostReverseProxy",id:"httputilnewsinglehostreverseproxy",level:3},{value:"OpenTelemetry Transport",id:"opentelemetry-transport",level:3},{value:"ErrorHandler",id:"errorhandler",level:3}];function c(e){const t={admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.h2,{id:"httputilreverseproxy",children:"httputil.ReverseProxy"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-go",children:'import (\n\t"net/http"\n\t"net/http/httputil"\n)\n'})}),"\n",(0,o.jsx)(t.h3,{id:"director-or-rewrite-\uc124\uc815",children:"Director or Rewrite \uc124\uc815"}),"\n",(0,o.jsx)(t.admonition,{type:"warning",children:(0,o.jsx)(t.p,{children:"Director\uc640 Rewrite \uc911 \ud558\ub098\ub9cc \uc124\uc815\ud574\uc57c \ud569\ub2c8\ub2e4."})}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-go",children:"&httputil.ReverseProxy{\n\tDirector: func(r *http.Request) {\n\t\t// target\uc73c\ub85c \uac08 \uc218 \uc788\ub3c4\ub85d \uc694\uccad \uc218\uc815\n\t},\n}\n"})}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-go",children:"&httputil.ReverseProxy{\n\tRewrite: func(pr *httputil.ProxyRequest) {\n\t\t// target\uc73c\ub85c \uac08 \uc218 \uc788\ub3c4\ub85d \uc694\uccad \uc218\uc815\n\t},\n}\n"})}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.code,{children:"pr.SetURL(targetURL)"}),"\uc744 \uc0ac\uc6a9\ud558\uba74 ",(0,o.jsx)(t.code,{children:"pr.Out"}),"\uc774 ",(0,o.jsx)(t.code,{children:"targetURL.Scheme://targetURL.Host/targetURL.Path/pr.In.Path?target.RawQuery&pr.In.RawQuery"}),"\ub85c \uc124\uc815\ub429\ub2c8\ub2e4."]}),"\n",(0,o.jsx)(t.li,{children:(0,o.jsx)(t.code,{children:"pr.SetXForwarded()"})}),"\n"]}),"\n",(0,o.jsx)(t.h3,{id:"httputilnewsinglehostreverseproxy",children:"httputil.NewSingleHostReverseProxy"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-go",children:"// rp := &httputil.ReverseProxy{\n// \tRewrite: func(pr *httputil.ProxyRequest) {\n// \t\tpr.SetURL(targetURL)\n// \t\tpr.Out.Host = pr.In.Host\n// \t},\n// }\nrp := httputil.NewSingleHostReverseProxy(targetURL)\n"})}),"\n",(0,o.jsx)(t.h3,{id:"opentelemetry-transport",children:"OpenTelemetry Transport"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-go",children:'import (\n\t"net/http"\n\n\t"go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp"\n)\n\n&httputil.ReverseProxy{\n\tTransport: otelhttp.NewTransport(\n\t\thttp.DefaultTransport,\n\t\totelhttp.WithFilter(func(r *http.Request) bool {\n\t\t\tspanContext := trace.SpanContextFromContext(r.Context())\n\t\t\treturn spanContext.IsValid() && spanContext.IsSampled()\n\t\t}),\n\t),\n}\n'})}),"\n",(0,o.jsx)(t.h3,{id:"errorhandler",children:"ErrorHandler"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-go",children:'&httputil.ReverseProxy{\n\tErrorHandler: func(w http.ResponseWriter, r *http.Request, err error) {\n\t\tswitch {\n\t\tcase errors.Is(err, syscall.ECONNREFUSED):\n\t\t\t// ...\n\t\tdefault:\n\t\t\t// ...\n\t\t}\n\n\t\thttp.Error(w, "service is unavailable", http.StatusServiceUnavailable)\n\t},\n}\n'})})]})}function d(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}}}]);