"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[94296],{28453:(e,n,l)=>{l.d(n,{R:()=>a,x:()=>t});var r=l(96540);const s={},i=r.createContext(s);function a(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(i.Provider,{value:n},e.children)}},61206:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"mlops/network/metallb/bgp","title":"MetalLB BGP \uc0ac\uc6a9\ud558\uae30","description":"MetalLB\uc5d0\uc11c Border Gateway Protocol(BGP) \uc0ac\uc6a9\ud558\uae30","source":"@site/docs/mlops/network/metallb/bgp.mdx","sourceDirName":"mlops/network/metallb","slug":"/mlops/network/metallb/bgp","permalink":"/docs/mlops/network/metallb/bgp","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/mlops/network/metallb/bgp.mdx","tags":[],"version":"current","lastUpdatedAt":1750180758000,"frontMatter":{"id":"bgp","title":"MetalLB BGP \uc0ac\uc6a9\ud558\uae30","sidebar_label":"BGP","description":"MetalLB\uc5d0\uc11c Border Gateway Protocol(BGP) \uc0ac\uc6a9\ud558\uae30","keywords":["metallb","bgp"]},"sidebar":"network","previous":{"title":"ARP/NDP","permalink":"/docs/mlops/network/metallb/arp"},"next":{"title":"Controller \uc124\uce58","permalink":"/docs/mlops/network/aws-load-balancer/"}}');var s=l(74848),i=l(28453);const a={id:"bgp",title:"MetalLB BGP \uc0ac\uc6a9\ud558\uae30",sidebar_label:"BGP",description:"MetalLB\uc5d0\uc11c Border Gateway Protocol(BGP) \uc0ac\uc6a9\ud558\uae30",keywords:["metallb","bgp"]},t=void 0,c={},o=[{value:"BGP \uc0ac\uc6a9\ud558\uae30",id:"bgp-\uc0ac\uc6a9\ud558\uae30",level:2},{value:"L3 \uc2a4\uc704\uce58 \uc124\uc815",id:"l3-\uc2a4\uc704\uce58-\uc124\uc815",level:3},{value:"BFDProfile",id:"bfdprofile",level:3},{value:"BGPPeer",id:"bgppeer",level:3},{value:"BGPAdvertisement",id:"bgpadvertisement",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",mermaid:"mermaid",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"bgp-\uc0ac\uc6a9\ud558\uae30",children:"BGP \uc0ac\uc6a9\ud558\uae30"}),"\n",(0,s.jsx)(n.mermaid,{value:'flowchart BT\n    subgraph "Node 1"\n      metallbA("MetalLB<br>Speaker")\n    end\n    subgraph "Node 2"\n      metallbB("MetalLB<br>Speaker")\n    end\n\n    subgraph "Node 3"\n      metallbC("MetalLB<br>Speaker")\n    end\n    subgraph "Node 4"\n      metallbD("MetalLB<br>Speaker")\n    end\n\n    torA(ToR Router)\n    torB(ToR Router)\n\n    metallbA--\x3etorA\n    metallbB--\x3etorA\n    metallbC--\x3etorB\n    metallbD--\x3etorB\n\n    spine(Spine Router)\n\n    torA--\x3espine\n    torB--\x3espine'}),"\n",(0,s.jsx)(n.h3,{id:"l3-\uc2a4\uc704\uce58-\uc124\uc815",children:"L3 \uc2a4\uc704\uce58 \uc124\uc815"}),"\n",(0,s.jsx)(n.admonition,{title:"Reference",type:"info",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst9400/software/release/17-12/configuration_guide/rtng/b_1712_rtng_9400_cg/configuring_bgp.html",children:"Cisco / Catalyst 9400 Series Switches / 17.12.x / Configuration BGP"})}),"\n"]})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"Device> show version\n# Cisco IOS XE Software, Version 17.12.02\n# Cisco IOS Software [Dublin], Catalyst L3 Switch Software (CAT9K_IOSXE), Version 17.12.2, RELEASE SOFTWARE (fc2)\n# ...\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"Device> show inventory\n# ...\n# PID: C9300X-24Y ...\n# ...\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"Device> enable\n# Password:\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"Device# configure terminal\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"Device(config)# ip routing\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"Device(config)# router bgp <ASN>\n# \uc0ad\uc81c: no router bgp <ASN>\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"neighbor <peerGroup> peer-group\n# \uc0ad\uc81c: no neighbor <peerGroup> peer-group\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"neighbor <peerGroup> remote-as <remoteASN>\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"neighbor <peerIP> peer-group <peerGroup>\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"neighbor <peerGroup> ebgp-multihop <hops>\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"maximum-paths <int>\n"})}),"\n",(0,s.jsx)(n.p,{children:"Equal Cost Multi-Path(ECMP) \uc124\uc815\uc785\ub2c8\ub2e4. \uae30\ubcf8\uac12\uc740 1\uc785\ub2c8\ub2e4."}),"\n",(0,s.jsxs)(n.admonition,{type:"tip",children:[(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"traceroute <peerIP>\n"})}),(0,s.jsx)(n.p,{children:"\uba85\ub839\uc5b4\ub97c \ud1b5\ud574 \ub098\uc628 hop \uc218\ub97c \uae30\uc900\uc73c\ub85c + 1~2 \uac12\uc744 \uc124\uc815\ud569\ub2c8\ub2e4."})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"end\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"show ip bgp neighbor\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"copy running-config startup-config\n"})}),"\n",(0,s.jsxs)(n.admonition,{type:"tip",children:[(0,s.jsx)(n.p,{children:"peer\uac00 \uc778\uc2dd\ud558\ub294 \uc2a4\uc704\uce58\uc758 IP \uc8fc\uc18c\ub97c \ud655\uc778\ud558\uae30 \uc704\ud574 \uc544\ub798 \uba85\ub839\uc5b4\ub97c \uc2e4\ud589\ud569\ub2c8\ub2e4."}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"Device# show ip route <peerIP>\n"})}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"via <interface>"})," \ud615\uc2dd\uc73c\ub85c interface\ub9cc \ud45c\uc2dc\ub418\ub294 \uacbd\uc6b0 \uc544\ub798 \uba85\ub839\uc5b4\ub97c \uc2e4\ud589\ud558\uc5ec IP \uc8fc\uc18c\ub97c \ud655\uc778\ud569\ub2c8\ub2e4."]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"Device# show run interface <interface>\n"})})]}),"\n",(0,s.jsx)(n.h3,{id:"bfdprofile",children:"BFDProfile"}),"\n",(0,s.jsx)(n.admonition,{title:"Reference",type:"info",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://metallb.io/apis/#bfdprofilespec",children:"MetalLB / API reference # BFDProfileSpec"})}),"\n"]})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: metallb.io/v1beta1\nkind: BFDProfile\nmetadata:\n  name: <name>\n  namespace: metallb-system\nspec:\n  detectMultiplier: 4\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"receiveInterval: 300ms"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"transmitInterval: 300ms"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"detectMultiplier: <int>"}),": \uba87 \ubc88 \uc2e4\ud328\ud558\uba74 \ub9c1\ud06c \ub04a\uae40\uc73c\ub85c \ud310\ub2e8\ud560\uc9c0\uc5d0 \ub300\ud55c \uac12\uc785\ub2c8\ub2e4."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"bgppeer",children:"BGPPeer"}),"\n",(0,s.jsx)(n.admonition,{title:"Reference",type:"info",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://metallb.io/apis/#bgppeerspec",children:"MetalLB / API reference # BGPPeerSpec"})}),"\n"]})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: metallb.io/v1beta2\nkind: BGPPeer\nmetadata:\n  name: <name>\n  namespace: metallb-system\nspec:\n  myASN: <ASN>\n  peerASN: <peerASN>\n  peerAddress: <peerAddress>\n  ebgpMultiHop: true\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"myASN: <ASN>"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"MetalLB \uc790\uae30 \uc790\uc2e0\uc5d0\ub300\ud55c Autonomous System Numbers(ASN)\uc785\ub2c8\ub2e4."}),"\n",(0,s.jsx)(n.li,{children:"64512 ~ 65534\ub294 Private ASN\uc785\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"peerASN: <peerASN>"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"peerAddress: <peerAddress>"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"ebgpMultiHop: false"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"bfdProfile: <bfdProfileName>"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"bgpadvertisement",children:"BGPAdvertisement"}),"\n",(0,s.jsx)(n.admonition,{title:"Reference",type:"info",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://metallb.io/apis/#bgpadvertisementspec",children:"MetalLB / API reference # BGPAdvertisementSpec"})}),"\n"]})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: metallb.io/v1beta1\nkind: BGPAdvertisement\nmetadata:\n  name: <name>\n  namespace: metallb-system\nspec:\n  ipAddressPools:\n    - <ipAddressPool>\n  peers:\n    - <peerName>\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"ipAddressPoolSelectors: []"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/docs/mlops/kubernetes/object-management/label#label-selector",children:"LabelSelector"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'for speaker in $(kubectl get pods -n metallb-system -l app.kubernetes.io/component=speaker -o name); do\n  kubectl exec -n metallb-system $speaker -c frr -- vtysh -c "show ip bgp summary"\ndone\n'})})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);