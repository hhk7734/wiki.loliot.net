"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[85620],{30553:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>a,contentTitle:()=>r,default:()=>d,frontMatter:()=>o,metadata:()=>c,toc:()=>i});var l=t(74848),n=t(28453);const o={id:"custom-action",title:"AWS ParallelCluster CustomActions",sidebar_label:"CustomActions",description:"AWS ParallelCluster CustomActions",keywords:["ParallelCluster","custom actions","start scripts"]},r=void 0,c={id:"mlops/mlops/aws/parallel-cluster/custom-action",title:"AWS ParallelCluster CustomActions",description:"AWS ParallelCluster CustomActions",source:"@site/docs/mlops/mlops/aws/parallel-cluster/custom-action.mdx",sourceDirName:"mlops/mlops/aws/parallel-cluster",slug:"/mlops/mlops/aws/parallel-cluster/custom-action",permalink:"/docs/mlops/mlops/aws/parallel-cluster/custom-action",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedAt:1730210406e3,frontMatter:{id:"custom-action",title:"AWS ParallelCluster CustomActions",sidebar_label:"CustomActions",description:"AWS ParallelCluster CustomActions",keywords:["ParallelCluster","custom actions","start scripts"]},sidebar:"mlops",previous:{title:"ParallelCluster",permalink:"/docs/mlops/mlops/aws/parallel-cluster/"},next:{title:"etc",permalink:"/docs/mlops/mlops/aws/parallel-cluster/etc"}},a={},i=[{value:"HeadNode.CustomActions",id:"headnodecustomactions",level:2},{value:"Scheduling.SlurmQueues.CustomActions",id:"schedulingslurmqueuescustomactions",level:2},{value:"\ub2e4\uc911 \uc0ac\uc6a9\uc790 \uc9c0\uc6d0(Multi-user support)",id:"\ub2e4\uc911-\uc0ac\uc6a9\uc790-\uc9c0\uc6d0multi-user-support",level:3}];function u(e){const s={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,n.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.h2,{id:"headnodecustomactions",children:"HeadNode.CustomActions"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.a,{href:"https://docs.aws.amazon.com/ko_kr/parallelcluster/latest/ug/HeadNode-v3.html#HeadNode-v3-CustomActions",children:"https://docs.aws.amazon.com/ko_kr/parallelcluster/latest/ug/HeadNode-v3.html#HeadNode-v3-CustomActions"})}),"\n"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-yaml",metastring:'title="cluster-config.yaml"',children:"HeadNode:\n  CustomActions:\n    OnNodeStart: # OnNodeStart|OnNodeConfigured|OnNodeUpdated\n      Script: <script> # http://<script>|s3://<script>\n      Args:\n        - <arg>\n      # \uc5ec\ub7ec \uac1c\uc758 \uc2a4\ud06c\ub9bd\ud2b8\ub97c \uc21c\ucc28\uc801\uc73c\ub85c \uc2e4\ud589\ud574\uc57c \ud560 \uacbd\uc6b0 \uc544\ub798\uc640 \uac19\uc774 \uc791\uc131\ud569\ub2c8\ub2e4.\n      # Sequence:\n      #   - Script: <script>\n      #     Args:\n      #       - <arg>\n"})}),"\n",(0,l.jsx)(s.h2,{id:"schedulingslurmqueuescustomactions",children:"Scheduling.SlurmQueues.CustomActions"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.a,{href:"https://docs.aws.amazon.com/ko_kr/parallelcluster/latest/ug/Scheduling-v3.html#Scheduling-v3-SlurmQueues-CustomActions",children:"https://docs.aws.amazon.com/ko_kr/parallelcluster/latest/ug/Scheduling-v3.html#Scheduling-v3-SlurmQueues-CustomActions"})}),"\n"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-yaml",metastring:'title="cluster-config.yaml"',children:"Scheduling:\n  SlurmQueues:\n    - Name: <queue>\n      CustomActions:\n        OnNodeStart: # OnNodeStart|OnNodeConfigured\n          Script: <script> # http://<script>|s3://<script>\n          Args:\n            - <arg>\n          # \uc5ec\ub7ec \uac1c\uc758 \uc2a4\ud06c\ub9bd\ud2b8\ub97c \uc21c\ucc28\uc801\uc73c\ub85c \uc2e4\ud589\ud574\uc57c \ud560 \uacbd\uc6b0 \uc544\ub798\uc640 \uac19\uc774 \uc791\uc131\ud569\ub2c8\ub2e4.\n          # Sequence:\n          #   - Script: <script>\n          #     Args:\n          #       - <arg>\n"})}),"\n",(0,l.jsx)(s.h3,{id:"\ub2e4\uc911-\uc0ac\uc6a9\uc790-\uc9c0\uc6d0multi-user-support",children:"\ub2e4\uc911 \uc0ac\uc6a9\uc790 \uc9c0\uc6d0(Multi-user support)"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.a,{href:"https://github.com/aws/aws-parallelcluster/wiki/Multi-User-Support",children:"https://github.com/aws/aws-parallelcluster/wiki/Multi-User-Support"})}),"\n"]}),"\n",(0,l.jsxs)(s.p,{children:["EFS, FSx \ub4f1 \ucef4\ud4e8\ud2b8 \ub178\ub4dc\uac00 \uc811\uadfc \uac00\ub2a5\ud55c \uacbd\ub85c\ub97c ",(0,l.jsx)(s.code,{children:"/shared"}),"\ub77c\uace0 \uac00\uc815\ud588\uc744 \ub54c, \uc544\ub798 \uba85\ub839\uc5b4\ub97c \ud65c\uc6a9\ud558\uc5ec ",(0,l.jsx)(s.code,{children:"/shared/userlistfile"}),"\uc5d0 \uc0ac\uc6a9\uc790 \ubaa9\ub85d\uc744 \uc791\uc131\ud569\ub2c8\ub2e4."]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:'echo "$USER,`id -u $USER`" >> /shared/userlistfile\n'})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",metastring:'title="/shared/userlistfile"',children:"hhk7734,1001\n"})}),"\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.code,{children:"compute-node-on-node-configured.sh"})," \uc2a4\ud06c\ub9bd\ud2b8\uc5d0 \uc544\ub798 \ub0b4\uc6a9\uc744 \ucd94\uac00\ud569\ub2c8\ub2e4."]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",metastring:'title="compute-node-on-node-configured.sh"',children:'#!/bin/bash\n\n. "/etc/parallelcluster/cfnconfig"\n\nIFS=","\n\nif [ "${cfn_node_type}" = "ComputeFleet" ]; then\n    while read USERNAME USERID\n    do\n        # -M do not create home since head node is exporting /homes via NFS\n        # -u to set UID to match what is set on the head node\n        if ! [ $(id -u $USERNAME 2>/dev/null || echo -1) -ge 0 ]; then\n            useradd -M -u $USERID $USERNAME\n        fi\n    done < "/shared/userlistfile"\nfi\n'})})]})}function d(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,l.jsx)(s,{...e,children:(0,l.jsx)(u,{...e})}):u(e)}},28453:(e,s,t)=>{t.d(s,{R:()=>r,x:()=>c});var l=t(96540);const n={},o=l.createContext(n);function r(e){const s=l.useContext(o);return l.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),l.createElement(o.Provider,{value:s},e.children)}}}]);