"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[82905],{12873:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>c,frontMatter:()=>t,metadata:()=>d,toc:()=>o});const d=JSON.parse('{"id":"lang/python/libraries/fastapi/middleware","title":"FastAPI Middleware","description":"FastAPI Middleware","source":"@site/docs/lang/python/libraries/fastapi/middleware.mdx","sourceDirName":"lang/python/libraries/fastapi","slug":"/lang/python/libraries/fastapi/middleware","permalink":"/docs/lang/python/libraries/fastapi/middleware","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/lang/python/libraries/fastapi/middleware.mdx","tags":[],"version":"current","lastUpdatedAt":1744387113000,"frontMatter":{"id":"middleware","title":"FastAPI Middleware","sidebar_label":"Middleware","description":"FastAPI Middleware","keywords":["fastapi","middleware"]},"sidebar":"python","previous":{"title":"Lifespan","permalink":"/docs/lang/python/libraries/fastapi/lifespan"},"next":{"title":"Protobuf","permalink":"/docs/lang/python/libraries/grpc/protobuf"}}');var a=r(74848),i=r(28453);const t={id:"middleware",title:"FastAPI Middleware",sidebar_label:"Middleware",description:"FastAPI Middleware",keywords:["fastapi","middleware"]},s=void 0,l={},o=[{value:"\ud638\ucd9c \uc21c\uc11c",id:"\ud638\ucd9c-\uc21c\uc11c",level:2}];function p(e){const n={a:"a",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"\ud638\ucd9c-\uc21c\uc11c",children:"\ud638\ucd9c \uc21c\uc11c"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://github.com/encode/starlette/blob/master/starlette/applications.py#L84-L110",children:"Starlette build_middleware_stack"})}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["\ubbf8\ub4e4\uc6e8\uc5b4 \ud638\ucd9c \uc21c\uc11c\ub294 ",(0,a.jsx)(n.code,{children:"FastAPI.user_middleware"}),"\uc5d0 \ub4e4\uc5b4\uc788\ub294 \uc21c\uc11c\ub300\ub85c \uc2e4\ud589\ub429\ub2c8\ub2e4."]}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\uc778\uc2a4\ud134\uc2a4 \uc0dd\uc131 \uc2dc \uc124\uc815\ud55c ",(0,a.jsx)(n.code,{children:"middleware"}),"\uac00 ",(0,a.jsx)(n.code,{children:"FastAPI.user_middleware"}),"\uc758 \uae30\ubcf8\uac12\uc73c\ub85c \uc124\uc815\ub429\ub2c8\ub2e4."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"FastAPI.add_middleware"})," \ub610\ub294 ",(0,a.jsx)(n.code,{children:"@FastAPI.middleware"})," \uc2e4\ud589 \uc2dc ",(0,a.jsx)(n.code,{children:"FastAPI.user_middleware"}),"\uc758 \ub9e8 \uc55e\uc5d0 \ubbf8\ub4e4\uc6e8\uc5b4\ub97c \ucd94\uac00\ud569\ub2c8\ub2e4."]}),"\n",(0,a.jsxs)(n.li,{children:["\ubaa8\ub4e0 \uc124\uc815\uc774 \uc644\ub8cc\ub41c \ud6c4 ",(0,a.jsx)(n.code,{children:"ServerErrorMiddleware"})," -> ",(0,a.jsx)(n.code,{children:"FastAPI.user_middleware"})," -> ",(0,a.jsx)(n.code,{children:"ExceptionMiddleware"})," \uc21c\uc73c\ub85c \ubbf8\ub4e4\uc6e8\uc5b4\uac00 \uc124\uc815\ub429\ub2c8\ub2e4."]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from fastapi import FastAPI, Request, Response\nfrom fastapi.middleware import Middleware\nfrom starlette.middleware.base import BaseHTTPMiddleware, RequestResponseEndpoint\n\n\nasync def middleware1(request: Request, call_next: RequestResponseEndpoint) -> Response:\n    print("Middleware 1")\n    response = await call_next(request)\n    print("Middleware 1")\n    return response\n\nasync def middleware2(request: Request, call_next: RequestResponseEndpoint) -> Response:\n    print("Middleware 2")\n    response = await call_next(request)\n    print("Middleware 2")\n    return response\n\napp = FastAPI(\n    middleware=[\n        Middleware(BaseHTTPMiddleware, dispatch=middleware1),\n    ]\n)\n\napp.add_middleware(BaseHTTPMiddleware, dispatch=middleware2)\n\n@app.middleware("http")\nasync def middleware3(request: Request, call_next: RequestResponseEndpoint) -> Response:\n    print("Middleware 3")\n    response = await call_next(request)\n    print("Middleware 3")\n    return response\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"Middleware 3\nMiddleware 2\nMiddleware 1\nMiddleware 1\nMiddleware 2\nMiddleware 3\n"})})]})}function c(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>s});var d=r(96540);const a={},i=d.createContext(a);function t(e){const n=d.useContext(i);return d.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),d.createElement(i.Provider,{value:n},e.children)}}}]);