"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[92350],{28453:(t,e,r)=>{r.d(e,{R:()=>i,x:()=>a});var n=r(96540);const o={},s=n.createContext(o);function i(t){const e=n.useContext(s);return n.useMemo((function(){return"function"==typeof t?t(e):{...e,...t}}),[e,t])}function a(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(o):t.components||o:i(t.components),n.createElement(s.Provider,{value:e},t.children)}},56361:(t,e,r)=>{r.r(e),r.d(e,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"lang/go/libraries/reverse-proxy","title":"HTTP Reverse Proxy","description":"HTTP Reverse Proxy","source":"@site/docs/lang/go/libraries/reverse-proxy.mdx","sourceDirName":"lang/go/libraries","slug":"/lang/go/libraries/reverse-proxy","permalink":"/docs/lang/go/libraries/reverse-proxy","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/lang/go/libraries/reverse-proxy.mdx","tags":[],"version":"current","lastUpdatedAt":1744038011000,"frontMatter":{"id":"reverse-proxy","title":"HTTP Reverse Proxy","sidebar_label":"Reverse Proxy","description":"HTTP Reverse Proxy","keywords":["http","reverse proxy"]},"sidebar":"go","previous":{"title":"WebSocket","permalink":"/docs/lang/go/libraries/websocket"},"next":{"title":"Custom Email \ubcf4\ub0b4\uae30","permalink":"/docs/lang/go/libraries/firebase/custom-email"}}');var o=r(74848),s=r(28453);const i={id:"reverse-proxy",title:"HTTP Reverse Proxy",sidebar_label:"Reverse Proxy",description:"HTTP Reverse Proxy",keywords:["http","reverse proxy"]},a=void 0,c={},l=[];function p(t){const e={code:"code",pre:"pre",...(0,s.R)(),...t.components};return(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-go",children:'import (\n\t"context"\n\t"errors"\n\t"net/http"\n\t"net/http/httputil"\n\n\t"github.com/gin-gonic/gin"\n\t"github.com/hhk7734/zapx.go"\n\t"go.uber.org/zap"\n)\n\nfunc RouteWithHTTP(scheme string, host string, path string) gin.HandlerFunc {\n\treturn func(c *gin.Context) {\n\t\trp := &httputil.ReverseProxy{\n\t\t\tDirector: func(r *http.Request) {\n\t\t\t\t// \uc694\uccad\uc744 \uc6d0\ud558\ub294 \uacbd\ub85c\ub85c \ubcc0\uacbd\n\t\t\t\tr.URL.Scheme = scheme\n\t\t\t\tr.URL.Host = host\n\t\t\t\tr.Host = host\n\t\t\t},\n\t\t\tErrorHandler: func(w http.ResponseWriter, r *http.Request, err error) {\n\t\t\t\tlogger := zapx.Ctx(r.Context())\n\t\t\t\tswitch {\n\t\t\t\tcase errors.Is(err, context.Canceled):\n\t\t\t\t\t// \ud074\ub77c\uc774\uc5b8\ud2b8\uac00 \uc694\uccad\uc744 \ucde8\uc18c\ud55c \uacbd\uc6b0 \uc678\uc5d0 \uc5d0\ub7ec\uac00 \ubc1c\uc0dd\ud558\ub294 \uacbd\uc6b0\uac00 \uc788\ub294\uc9c0 \ud655\uc778 \ud544\uc694\n\t\t\t\t\tlogger.Warn("request canceled")\n\t\t\t\tdefault:\n\t\t\t\t\tlogger.Error("proxy error", zap.Error(err))\n\t\t\t\t\tc.Status(http.StatusBadGateway)\n\t\t\t\t}\n\t\t\t},\n\t\t}\n\t\trp.ServeHTTP(c.Writer, c.Request)\n\t}\n}\n'})})}function u(t={}){const{wrapper:e}={...(0,s.R)(),...t.components};return e?(0,o.jsx)(e,{...t,children:(0,o.jsx)(p,{...t})}):p(t)}}}]);