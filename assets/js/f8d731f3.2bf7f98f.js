"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[32271],{28453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>i});var l=s(96540);const r={},o=l.createContext(r);function d(e){const n=l.useContext(o);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),l.createElement(o.Provider,{value:n},e.children)}},57222:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>i,default:()=>h,frontMatter:()=>d,metadata:()=>l,toc:()=>c});const l=JSON.parse('{"id":"mlops/kubernetes/tools/kubespray/node","title":"Kubespray Node \ucd94\uac00/\uc81c\uac70","description":"Kubespray Node \ucd94\uac00/\uc81c\uac70","source":"@site/docs/mlops/kubernetes/tools/kubespray/node.mdx","sourceDirName":"mlops/kubernetes/tools/kubespray","slug":"/mlops/kubernetes/tools/kubespray/node","permalink":"/docs/mlops/kubernetes/tools/kubespray/node","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/mlops/kubernetes/tools/kubespray/node.mdx","tags":[],"version":"current","lastUpdatedAt":1740111436000,"frontMatter":{"id":"node","title":"Kubespray Node \ucd94\uac00/\uc81c\uac70","sidebar_label":"Node \ucd94\uac00/\uc81c\uac70","description":"Kubespray Node \ucd94\uac00/\uc81c\uac70","keywords":["kubespray","node","management"]},"sidebar":"kubernetes","previous":{"title":"etcd","permalink":"/docs/mlops/kubernetes/tools/kubespray/etcd"},"next":{"title":"\uc778\uc99d/\uc778\uac00 \ubcc0\uacbd","permalink":"/docs/mlops/kubernetes/tools/kubespray/auth"}}');var r=s(74848),o=s(28453);const d={id:"node",title:"Kubespray Node \ucd94\uac00/\uc81c\uac70",sidebar_label:"Node \ucd94\uac00/\uc81c\uac70",description:"Kubespray Node \ucd94\uac00/\uc81c\uac70",keywords:["kubespray","node","management"]},i=void 0,t={},c=[{value:"Node \ucd94\uac00",id:"node-\ucd94\uac00",level:2},{value:"Control plane",id:"control-plane",level:3},{value:"etcd",id:"etcd",level:3},{value:"Node",id:"node",level:3},{value:"Node \uc81c\uac70",id:"node-\uc81c\uac70",level:2},{value:"\uc81c\uac70 \uc804 \uc791\uc5c5",id:"\uc81c\uac70-\uc804-\uc791\uc5c5",level:3},{value:"\uc81c\uac70",id:"\uc81c\uac70",level:3},{value:"\uc81c\uac70 \ud6c4 \uc791\uc5c5",id:"\uc81c\uac70-\ud6c4-\uc791\uc5c5",level:3}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.admonition,{title:"Reference",type:"info",children:(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/overview/components/",children:"Kubernetes / Kubernetes Components"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://kubespray.io/#/docs/operations/nodes",children:"Kubespray / Adding/replacing a node"})}),"\n"]})}),"\n",(0,r.jsx)(n.h2,{id:"node-\ucd94\uac00",children:"Node \ucd94\uac00"}),"\n",(0,r.jsx)(n.h3,{id:"control-plane",children:"Control plane"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"kube_control_plane"})," \uadf8\ub8f9\uc740 ",(0,r.jsx)(n.code,{children:"etcd"}),"\ub97c \uc81c\uc678\ud55c \ub098\uba38\uc9c0 control plane \ucef4\ud3ec\ub10c\ud2b8\uc778 apiserver, scheduler, controller\ub97c \uc124\uce58\ud560 Node \uadf8\ub8f9\uc785\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"groups['kube_control_plane'][0]"}),"\uc740 \ucd94\uac00\uc801\uc73c\ub85c \uc2e4\ud589\ub418\ub294 task\uac00 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"ansible-playbook -i <inventory> -b cluster.yml\n"})}),"\n",(0,r.jsx)(n.h3,{id:"etcd",children:"etcd"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"etcd"}),"\ub294 etcd\uac00 \uc124\uce58\ub420 Node \uadf8\ub8f9\uc785\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"groups['etcd'][0]"}),"\uc740 \ucd94\uac00\uc801\uc73c\ub85c \uc2e4\ud589\ub418\ub294 task\uac00 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:["Node \uc218\uac00 \uc9dd\uc218\uc778 \uacbd\uc6b0 ",(0,r.jsx)(n.code,{children:"kubernetes/preinstall"})," role \uc2e4\ud589\uc774 \uc2e4\ud328\ud558\ubbc0\ub85c \ubcc0\uacbd \uc911\uc774 \uc544\ub2cc \uacbd\uc6b0 \ud640\uc218\ub85c \uc720\uc9c0\ud574\uc57c\ud569\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:["\ub2e4\ub978 \uadf8\ub8f9\uc73c\ub85c \uc0ac\uc6a9\ub418\ub358 Node\ub294 ",(0,r.jsx)(n.code,{children:"etcd"})," \uadf8\ub8f9\uc5d0 \ucd94\uac00\ud560 \uc218 \uc5c6\uc73c\ubbc0\ub85c \ud574\ub2f9 Node\ub97c \uc81c\uac70\ud588\ub2e4\uac00 \uc6d0\ub798 \uadf8\ub8f9\uacfc \ud568\uaed8 \ub2e4\uc2dc \ucd94\uac00\ud574\uc57c\ud569\ub2c8\ub2e4."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"ansible-playbook -i <inventory> -b cluster.yml \\\n  -l etcd,kube_control_plane \\\n  -e etcd_retries=10 \\\n  -e ignore_assert_errors=true\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"ansible-playbook -i <inventory> -b upgrade-cluster.yml \\\n  -l etcd,kube_control_plane \\\n  -e etcd_retries=10 \\\n  -e ignore_assert_errors=true\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="/etc/kubernetes/manifests/kube-apiserver.yaml"',children:"spec:\n  containers:\n    - command:\n        - --etcd-servers=https://<ip>:2379[,https://<ip>:2379]\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"etcd"}),"\ubcc0\uacbd\uc774 \uc798 \ub418\uc5c8\ub294\uc9c0 ",(0,r.jsx)(n.code,{children:"kube_control_plane"})," \uadf8\ub8f9\uc758 \uac01 Node\uc5d0\uc11c \uc704 \uc635\uc158\uc744 \ud655\uc778\ud569\ub2c8\ub2e4."]}),"\n",(0,r.jsx)(n.h3,{id:"node",children:"Node"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"kube_node"})," \uadf8\ub8f9\uc740 container runtime, kubelet\uc744 \uc124\uce58\ud560 Node \uadf8\ub8f9\uc785\ub2c8\ub2e4."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"ansible-playbook -i <inventory> -b playbooks/facts.yml\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"ansible-playbook -i <inventory> -b scale.yml \\\n  -l <hostname>\n"})}),"\n",(0,r.jsx)(n.h2,{id:"node-\uc81c\uac70",children:"Node \uc81c\uac70"}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsx)(n.p,{children:"kubespray\uc5d0\uc11c \uc5ec\ub7ec \uadf8\ub8f9\uc5d0 \uc18d\ud574\uc788\ub294 Node\ub97c \ud55c \uadf8\ub8f9\uc5d0\uc11c\ub9cc \uc81c\uac70\ud558\ub294 \ubc29\ubc95\uc744 \uc81c\uacf5\ud558\uc9c0 \uc54a\ub294 \uac83 \uac19\uc2b5\ub2c8\ub2e4.(\ubd88\ud655\uc2e4\ud568)"})}),"\n",(0,r.jsx)(n.h3,{id:"\uc81c\uac70-\uc804-\uc791\uc5c5",children:"\uc81c\uac70 \uc804 \uc791\uc5c5"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"groups['etcd'][0]"})," \ub610\ub294 ",(0,r.jsx)(n.code,{children:"groups['kube_control_plane'][0]"}),"\uc778 Node\ub97c \uc81c\uac70\ud558\ub824\ub294 \uacbd\uc6b0 \ud574\ub2f9 Node\uc758 \uc21c\uc11c\ub97c \ubcc0\uacbd\ud574\uc57c\ud569\ub2c8\ub2e4."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="inventory/hosts.yaml"',children:"etcd:\n  hosts:\n    node1: # \uc81c\uac70 \ub300\uc0c1\n    node2:\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="inventory/hosts.yaml"',children:"etcd:\n  hosts:\n    node2:\n    node1: # \uc81c\uac70 \ub300\uc0c1\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"ansible-playbook -i <inventory> -b cluster.yml\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\uc81c\uac70",children:"\uc81c\uac70"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"ansible-playbook -i <inventory> -b remove-node.yml \\\n  -e node=<target>\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"-e node=<target>"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.ansible.com/ansible/latest/inventory_guide/intro_patterns.html",children:"Ansible / Patterns"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\ud574\ub2f9\ud558\ub294 Node\ub4e4\uc744 \ucd08\uae30\ud654\ud560 \uc218 \uc5c6\uac70\ub098 \ud560 \ud544\uc694\uac00 \uc5c6\ub294 \uacbd\uc6b0 \uc544\ub798 \uc544\ub798 \ub450 \uc635\uc158\uc744 \ucd94\uac00\ud558\uba74 \ub429\ub2c8\ub2e4.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"-e reset_nodes=false"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"-e allow_ungraceful_removal=true"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\uc81c\uac70\uac00 \uc644\ub8cc\ub418\uba74 ",(0,r.jsx)(n.code,{children:"inventory/hosts.yaml"}),"\uc5d0\uc11c \uc81c\uac70\ub41c Node\ub97c \uc0ad\uc81c\ud569\ub2c8\ub2e4."]}),"\n",(0,r.jsx)(n.h3,{id:"\uc81c\uac70-\ud6c4-\uc791\uc5c5",children:"\uc81c\uac70 \ud6c4 \uc791\uc5c5"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"etcd"})," \uadf8\ub8f9\uc5d0 \ud3ec\ud568\ub41c Node\uac00 \uc81c\uac70\ub41c \uacbd\uc6b0 Kubernetes \uc640 \ub124\ud2b8\uc6cc\ud06c \uc124\uc815 \ud30c\uc77c\uc744 \uc5c5\ub370\uc774\ud2b8\ub97c \uc704\ud574 ",(0,r.jsx)(n.code,{children:"cluster.yml"})," \ud50c\ub808\uc774\ubd81\uc744 \uc2e4\ud589\ud569\ub2c8\ub2e4."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"ansible-playbook -i <inventory> -b cluster.yml\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\uc9dd\uc218\uac1c\uc758 ",(0,r.jsx)(n.code,{children:"etcd"}),"\ub97c \uac00\uc9c4 \uacbd\uc6b0 ",(0,r.jsx)(n.code,{children:"-e ignore_assert_errors=true"})," \uc635\uc158\uc73c\ub85c \uc5d0\ub7ec\ub97c \ubb34\uc2dc\ud574\uc57c\ud569\ub2c8\ub2e4."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="/etc/kubernetes/manifests/kube-apiserver.yaml"',children:"spec:\n  containers:\n    - command:\n        - --etcd-servers=https://<ip>:2379[,https://<ip>:2379]\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"etcd"}),"\ubcc0\uacbd\uc774 \uc798 \ub418\uc5c8\ub294\uc9c0 ",(0,r.jsx)(n.code,{children:"kube_control_plane"})," \uadf8\ub8f9\uc758 \uac01 Node\uc5d0\uc11c \uc704 \uc635\uc158\uc744 \ud655\uc778\ud569\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"kube_control_plane"}),"\uc758 \uccab \ubc88\uc9f8 Node\uac00 \ubcc0\uacbd\ub41c \uacbd\uc6b0 ",(0,r.jsx)(n.code,{children:"cluster-info"})," ConfigMap\uc744 \ud655\uc778\ud569\ub2c8\ub2e4."]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);