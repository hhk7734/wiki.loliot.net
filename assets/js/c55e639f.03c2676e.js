"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[6061],{1904:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>d,frontMatter:()=>l,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"mlops/monitoring/eck/operator","title":"ECK Operator","description":"ECK Operator","source":"@site/docs/mlops/monitoring/eck/operator.mdx","sourceDirName":"mlops/monitoring/eck","slug":"/mlops/monitoring/eck/operator","permalink":"/docs/mlops/monitoring/eck/operator","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/mlops/monitoring/eck/operator.mdx","tags":[],"version":"current","lastUpdatedAt":1734103299000,"frontMatter":{"id":"operator","title":"ECK Operator","sidebar_label":"Operator","description":"ECK Operator","keywords":["ECK Operator"]},"sidebar":"monitoring","previous":{"title":"Basics","permalink":"/docs/mlops/monitoring/opensearch/basics"},"next":{"title":"dcgm-exporter","permalink":"/docs/mlops/monitoring/dcgm-exporter"}}');var s=t(74848),r=t(28453);const l={id:"operator",title:"ECK Operator",sidebar_label:"Operator",description:"ECK Operator",keywords:["ECK Operator"]},i=void 0,o={},c=[{value:"\uc124\uce58",id:"\uc124\uce58",level:2},{value:"Fluent Bit",id:"fluent-bit",level:2},{value:"Fluentd",id:"fluentd",level:2}];function m(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"\uc124\uce58",children:"\uc124\uce58"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"wget https://download.elastic.co/downloads/eck/2.1.0/crds.yaml -O eck-crds.yaml\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"kubectl apply -f eck-crds.yaml\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"wget https://download.elastic.co/downloads/eck/2.1.0/operator.yaml -O eck-operator.yaml\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"kubectl apply -f eck-operator.yaml\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"istio"}),": ",(0,s.jsx)(n.a,{href:"https://www.elastic.co/guide/en/cloud-on-k8s/current/k8s-service-mesh-istio.html",children:"https://www.elastic.co/guide/en/cloud-on-k8s/current/k8s-service-mesh-istio.html"})]})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'title="elasticsearch.yaml"',children:'apiVersion: elasticsearch.k8s.elastic.co/v1\nkind: Elasticsearch\nmetadata:\n  name: elasticsearch\n  namespace: elastic-system\nspec:\n  version: 8.2.0\n  http:\n    tls:\n      selfSignedCertificate:\n        disabled: true\n  updateStrategy:\n    changeBudget:\n      maxSurge: 3\n      maxUnavailable: 1\n  nodeSets:\n    - name: master\n      config:\n        node.roles:\n          - master\n          - data\n          - ingest\n          - transform\n        node.store.allow_mmap: false\n      count: 1\n      podTemplate:\n        metadata:\n          labels:\n            app: elasticsearch\n            version: v1\n        spec:\n          containers:\n            - name: elasticsearch\n              env:\n                - name: ES_JAVA_OPTS\n                  value: "-Xms2g -Xmx2g"\n              resources:\n                limits:\n                  memory: 4Gi\n                requests:\n                  cpu: 500m\n                  memory: 4Gi\n      volumeClaimTemplates:\n        - metadata:\n            name: elasticsearch-data\n          spec:\n            accessModes:\n              - ReadWriteOnce\n            resources:\n              requests:\n                storage: 20Gi\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"kubectl apply -f elasticsearch.yaml\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'title="kibana.yaml"',children:"apiVersion: kibana.k8s.elastic.co/v1\nkind: Kibana\nmetadata:\n  name: kibana\n  namespace: elastic-system\nspec:\n  version: 8.2.0\n  count: 1\n  http:\n    tls:\n      selfSignedCertificate:\n        disabled: true\n  elasticsearchRef:\n    name: elasticsearch\n    namespace: elastic-system\n  podTemplate:\n    metadata:\n      labels:\n        app: kibana\n        version: v1\n    spec:\n      containers:\n        - name: kibana\n          resources:\n            requests:\n              cpu: 200m\n              memory: 1Gi\n            limits:\n              memory: 2Gi\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"kubectl apply -f kibana.yaml\n"})}),"\n",(0,s.jsx)(n.h2,{id:"fluent-bit",children:"Fluent Bit"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'title="fluent-bit-values.yaml"',children:'env:\n  - name: ES_HOST\n    value: elasticsearch-es-http.elastic-system.svc.cluster.local\n  - name: ES_PORT\n    value: "9200"\n  - name: ES_USER\n    value: "elastic"\n  - name: ES_PASSWORD\n    valueFrom:\n      secretKeyRef:\n        name: elasticsearch-es-elastic-user\n        key: elastic\n\nconfig:\n  # indent\ub97c 4\uce78\uc73c\ub85c \ub9de\ucdb0\uc57c \ud569\ub2c8\ub2e4.\n  outputs: |\n    # https://docs.fluentbit.io/manual/pipeline/outputs/elasticsearch\n    [OUTPUT]\n        Name                es\n        Match               *\n        Host                ${ES_HOST}\n        Port                ${ES_PORT}\n        HTTP_User           ${ES_USER}\n        HTTP_Passwd         ${ES_PASSWORD}\n        Trace_Error         On\n        Buffer_Size         64K\n        Logstash_Format     On\n        Logstash_DateFormat %Y.%m\n        Logstash_Prefix_Key tag\n        Current_Time_Index  On\n        Suppress_Type_Name  On\n        Retry_Limit         5\n'})}),"\n",(0,s.jsx)(n.h2,{id:"fluentd",children:"Fluentd"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'title="fluentd-values.yaml"',children:'env:\n  - name: ES_HOST\n    value: elasticsearch-es-http.elastic-system.svc.cluster.local\n  - name: ES_PORT\n    value: "9200"\n  - name: ES_USER\n    value: "elastic"\n  - name: ES_PASSWORD\n    valueFrom:\n      secretKeyRef:\n        name: elasticsearch-es-elastic-user\n        key: elastic\n\nfileConfigs:\n  output-es.conf: |\n    # https://github.com/uken/fluent-plugin-elasticsearch\n    <match **>\n      @type elasticsearch\n      @id out_es\n      @log_level info\n      include_tag_key true\n      scheme http\n      host "#{ENV[\'ES_HOST\']}"\n      port "#{ENV[\'ES_PORT\']}"\n      user "#{ENV[\'ES_USER\']}"\n      password "#{ENV[\'ES_PASSWORD\']}"\n      reload_connections false\n      reconnect_on_error true\n      reload_on_failure true\n      request_timeout 30s\n      logstash_format true\n      logstash_prefix ${tag}\n      logstash_dateformat %Y.%m\n      sniffer_class_name Fluent::Plugin::ElasticsearchSimpleSniffer\n      suppress_type_name true\n      <buffer>\n        flush_at_shutdown true\n        flush_interval 10s\n        flush_thread_count 4\n        retry_max_interval 30s\n      </buffer>\n    </match>\n'})})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(m,{...e})}):m(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>i});var a=t(96540);const s={},r=a.createContext(s);function l(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);