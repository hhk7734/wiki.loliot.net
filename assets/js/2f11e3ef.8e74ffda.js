"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[20444],{99806:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>t,contentTitle:()=>s,default:()=>u,frontMatter:()=>l,metadata:()=>o,toc:()=>i});const o=JSON.parse('{"id":"mlops/mlops/workflow/argo-cd/auth","title":"Argo CD \uc778\uc99d/\uc778\uac00","description":"Argo CD \uc778\uc99d/\uc778\uac00","source":"@site/docs/mlops/mlops/workflow/argo-cd/auth.mdx","sourceDirName":"mlops/mlops/workflow/argo-cd","slug":"/mlops/mlops/workflow/argo-cd/auth","permalink":"/docs/mlops/mlops/workflow/argo-cd/auth","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/mlops/mlops/workflow/argo-cd/auth.mdx","tags":[],"version":"current","lastUpdatedAt":1735587312000,"frontMatter":{"id":"auth","title":"Argo CD \uc778\uc99d/\uc778\uac00","sidebar_label":"\uc778\uc99d/\uc778\uac00","description":"Argo CD \uc778\uc99d/\uc778\uac00","keywords":["argo","cd","auth"]},"sidebar":"mlops","previous":{"title":"Argo CD","permalink":"/docs/mlops/mlops/workflow/argo-cd/"},"next":{"title":"CRD","permalink":"/docs/mlops/mlops/workflow/argo-cd/crd"}}');var r=a(74848),c=a(28453);const l={id:"auth",title:"Argo CD \uc778\uc99d/\uc778\uac00",sidebar_label:"\uc778\uc99d/\uc778\uac00",description:"Argo CD \uc778\uc99d/\uc778\uac00",keywords:["argo","cd","auth"]},s=void 0,t={},i=[{value:"\uc778\uc99d(Authn)",id:"\uc778\uc99dauthn",level:2},{value:"ConfigMap, Secret\uc73c\ub85c \uacc4\uc815 \uad00\ub9ac",id:"configmap-secret\uc73c\ub85c-\uacc4\uc815-\uad00\ub9ac",level:3},{value:"OIDC",id:"oidc",level:3},{value:"Keycloak",id:"keycloak",level:4},{value:"Casdoor",id:"casdoor",level:4},{value:"Dex",id:"dex",level:3},{value:"GitHub",id:"github",level:4},{value:"\uc778\uac00(Authz)",id:"\uc778\uac00authz",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"\uc778\uc99dauthn",children:"\uc778\uc99d(Authn)"}),"\n",(0,r.jsx)(n.h3,{id:"configmap-secret\uc73c\ub85c-\uacc4\uc815-\uad00\ub9ac",children:"ConfigMap, Secret\uc73c\ub85c \uacc4\uc815 \uad00\ub9ac"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://argo-cd.readthedocs.io/en/stable/operator-manual/user-management/#local-usersaccounts",children:"https://argo-cd.readthedocs.io/en/stable/operator-manual/user-management/#local-usersaccounts"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"SSO \uc124\uc815\uc774 \ubd80\ub2f4\uc2a4\ub7ec\uc6b4 \ub9e4\uc6b0 \uc18c\uaddc\ubaa8 \ud300\uc774\ub098 \uac1c\uc778 \ud504\ub85c\uc81d\ud2b8\uc5d0\uc11c\ub294 ConfigMap, Secret\uc73c\ub85c \uacc4\uc815\uc744 \uad00\ub9ac\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="argo-cd-values.yaml"',children:'configs:\n  cm:\n    # `argocd-cm` ConfigMap\n\n    accounts.<user>: apiKey, login\n    accounts.<user>.enabled: "true"\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"apiKey"}),": API \uc0ac\uc6a9\uc744 \uc704\ud55c \ud1a0\ud070 \uc0dd\uc131\uc744 \ud5c8\uc6a9\ud569\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"login"}),": UI \ub85c\uadf8\uc778\uc744 \ud5c8\uc6a9\ud569\ub2c8\ub2e4."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="argo-cd-values.yaml"',children:"configs:\n  secret:\n    # `argocd-secret` Secret\n\n    # \uc554\ud638\ub294 bcrypt, cost 10\uc73c\ub85c \ud574\uc2f1\ub41c \uac12\uc744 \uc124\uc815\ud569\ub2c8\ub2e4.\n    accounts.<user>.password: $2a$10$...\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"htpasswd -bnBC 10 '' '<password>' | tr -d ':\\n' | sed 's/^$2y/$2a/'\n"})}),"\n",(0,r.jsxs)(n.admonition,{type:"info",children:[(0,r.jsxs)(n.p,{children:["\uc554\ud638\ub294 ",(0,r.jsx)(n.code,{children:"argocd"})," \ucee4\ub9e8\ub4dc\ub85c \uc0dd\uc131\ud558\uc5ec \ub4f1\ub85d\ud560 \uc218\ub3c4 \uc788\uc2b5\ub2c8\ub2e4."]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"argocd account update-password --account <user>\n"})})]}),"\n",(0,r.jsx)(n.h3,{id:"oidc",children:"OIDC"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://argo-cd.readthedocs.io/en/stable/operator-manual/user-management/#existing-oidc-provider",children:"https://argo-cd.readthedocs.io/en/stable/operator-manual/user-management/#existing-oidc-provider"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="argo-cd-values.yaml"',children:'global:\n  # argo-cd\uc758 \uc678\ubd80 \uc811\uc18d \uc8fc\uc18c\uc785\ub2c8\ub2e4.\n  domain: <argoCDDomain>\n\nconfigs:\n  cm:\n    oidc.config: |\n      name: <IDP>\n      issuer: <IDPURL>\n      clientID: <clientID>\n      clientSecret: $argo-cd-client-secret:oidc.<IDP>.clientSecret\n\n      # Optional\n      requestedScopes: ["openid", "profile", "email", "groups"]\n\n      # Optional\n      # https://connect2id.com/products/server/docs/guides/requesting-openid-claims#claims-parameter\n      requestedIDTokenClaims:\n        email:\n          essential: true\n        groups:\n          essential: true\n          values:\n            - <group>\n\n      # Optional\n      logoutURL: <logoutURL>?id_token_hint={{token}}&post_logout_redirect_uri={{logoutRedirectURL}}\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["callback \uc8fc\uc18c\ub294: ",(0,r.jsx)(n.code,{children:"<argoCDURL>/auth/callback"})," \uc785\ub2c8\ub2e4."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Secret\nmetadata:\n  name: argo-cd-client-secret\n  namespace: argo-cd\n  labels:\n    app.kubernetes.io/part-of: argocd # \uc774 label\uc774 \uc788\uc5b4\uc57c \uc124\uc815\uc774 \uc801\uc6a9\ub429\ub2c8\ub2e4.\ntype: Opaque\nstringData:\n  oidc.<IDP>.clientSecret: <clientSecret>\n"})}),"\n",(0,r.jsx)(n.h4,{id:"keycloak",children:"Keycloak"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/mlops/mlops/auth/keycloak/openid-connect",children:"Keycloak OIDC"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://argo-cd.readthedocs.io/en/stable/operator-manual/user-management/keycloak/",children:"https://argo-cd.readthedocs.io/en/stable/operator-manual/user-management/keycloak/"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="argo-cd-values.yaml"',children:"configs:\n  cm:\n    oidc.config: |\n      name: keycloak\n      issuer: <keycloakURL>/realms/<realm>\n      clientID: <clientID>\n      clientSecret: $argo-cd-client-secret:oidc.keycloak.clientSecret\n"})}),"\n",(0,r.jsx)(n.h4,{id:"casdoor",children:"Casdoor"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="argo-cd-values.yaml"',children:"configs:\n  cm:\n    oidc.config: |\n      name: casdoor\n      issuer: <casdoorURL>\n      clientID: <clientID>\n      clientSecret: $argo-cd-client-secret:oidc.casdoor.clientSecret\n"})}),"\n",(0,r.jsx)(n.h3,{id:"dex",children:"Dex"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://argo-cd.readthedocs.io/en/stable/operator-manual/user-management/#dex",children:"https://argo-cd.readthedocs.io/en/stable/operator-manual/user-management/#dex"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://github.com/dexidp/website/tree/main/content/docs/connectors",children:"Example connectors"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"redirectURI"}),"\uc740 ",(0,r.jsx)(n.code,{children:"argocd-cm"}),"\uc758 ",(0,r.jsx)(n.code,{children:"<.data.url>/api/dex/callback"}),"\uc73c\ub85c \uc790\ub3d9 \uc124\uc815 \ub418\uae30 \ub54c\ubb38\uc5d0 \ub530\ub85c \uc124\uc815\ud558\uc9c0 \uc54a\uc544\ub3c4 \ub429\ub2c8\ub2e4."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="argo-cd-values.yaml"',children:"global:\n  # argo-cd\uc758 \uc678\ubd80 \uc811\uc18d \uc8fc\uc18c\uc785\ub2c8\ub2e4.\n  domain: <argoCDDomain>\n\nconfigs:\n  cm:\n    dex.config: |\n      connectors:\n        - type: <type>\n          id: <id>\n          name: <name>\n          config:\n            <key>: <value>\n"})}),"\n",(0,r.jsx)(n.h4,{id:"github",children:"GitHub"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"(User or Organization)Settings - Developer settings - OAuth Apps - New Oauth App"}),"\n",(0,r.jsx)(n.li,{children:"Homepage URL:"}),"\n",(0,r.jsxs)(n.li,{children:["Authorization callback URL: ",(0,r.jsx)(n.code,{children:"https://<host>/api/dex/callback"})]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="argo-cd-values.yaml"',children:"configs:\n  cm:\n    dex.config: |\n      connectors:\n        - type: github\n          id: github\n          name: GitHub\n          config:\n            clientID: <clientID>\n            clientSecret: $argo-cd-client-secret:dex.github.clientSecret\n            # \ud300 \uc774\ub984\uc740 name\uacfc slug\uac00 \uc788\uc2b5\ub2c8\ub2e4.\n            # name\uc740 github\uc5d0\uc11c \uc124\uc815\ud55c \uc774\ub984 \uadf8\ub300\ub85c \uc0ac\uc6a9\ud558\uace0, slug\ub294 \uc18c\ubb38\uc790\uc640 `-`\ub9cc\uc73c\ub85c \ubcc0\ud658\ub41c \uc774\ub984\uc785\ub2c8\ub2e4.\n            # Ex) lol-iot:R&D -> lol-iot:r-d\n            teamNameField: both\n            orgs:\n              - name: <org>\n                # teams\ub97c \uc120\uc5b8\ud558\uc9c0 \uc54a\uc73c\uba74 \ubaa8\ub4e0 \ud300\uc5d0 \ub300\ud55c \uc811\uadfc\uc744 \ud5c8\uc6a9\ud569\ub2c8\ub2e4.\n                # teams:\n                #   - <team>\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\uc778\uac00authz",children:"\uc778\uac00(Authz)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://argo-cd.readthedocs.io/en/stable/operator-manual/rbac/",children:"https://argo-cd.readthedocs.io/en/stable/operator-manual/rbac/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/argoproj/argo-cd/blob/master/assets/builtin-policy.csv",children:"https://github.com/argoproj/argo-cd/blob/master/assets/builtin-policy.csv"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Argo CD\ub294 casbin RBAC\ub97c \uc0ac\uc6a9\ud558\uc5ec \uad8c\ud55c\uc744 \uc81c\uc5b4\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="argo-cd-values.yaml"',children:'configs:\n  rbac:\n    # https://github.com/argoproj/argo-cd/blob/master/docs/operator-manual/rbac.md\n    policy.csv: |\n      p, <role/user/group>, <resource>, <action>, <object>\n      p, <role/user/group>, <resource>, <action>, <appproject>/<object>\n\n      g, <role/user/group>, role:<role>\n\n    # role:readonly, role:admin\n    # https://github.com/argoproj/argo-cd/blob/master/assets/builtin-policy.csv\n    policy.default: "role:readonly"\n\n    # "sub" \uc678\uc5d0 \ucd94\uac00\ub85c \uc778\uc2dd\ud560 \uc218 \uc788\ub294 \uac12\uc744 \ucd94\uac00\ud569\ub2c8\ub2e4. \uae30\ubcf8 \uac12\uc740 "[groups]"\uc785\ub2c8\ub2e4.\n    scopes: "[groups, preferred_username, email]"\n\n    # glob or regex\n    policy.matchMode: "glob"\n'})})]})}function u(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,n,a)=>{a.d(n,{R:()=>l,x:()=>s});var o=a(96540);const r={},c=o.createContext(r);function l(e){const n=o.useContext(c);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),o.createElement(c.Provider,{value:n},e.children)}}}]);