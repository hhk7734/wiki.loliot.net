"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[11156],{28453:(e,n,l)=>{l.d(n,{R:()=>i,x:()=>r});var a=l(96540);const s={},t=a.createContext(s);function i(e){const n=a.useContext(t);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),a.createElement(t.Provider,{value:n},e.children)}},64853:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>m,frontMatter:()=>i,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"lang/python/libraries/sqlalchemy/atlas","title":"Atlas\uc640 SQLAlchemy \uc5f0\ub3d9\ud558\uae30","description":"Atlas\uc640 SQLAlchemy \uc5f0\ub3d9\ud558\uae30","source":"@site/docs/lang/python/libraries/sqlalchemy/atlas.mdx","sourceDirName":"lang/python/libraries/sqlalchemy","slug":"/lang/python/libraries/sqlalchemy/atlas","permalink":"/docs/lang/python/libraries/sqlalchemy/atlas","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/lang/python/libraries/sqlalchemy/atlas.mdx","tags":[],"version":"current","lastUpdatedAt":1740850310000,"frontMatter":{"id":"atlas","title":"Atlas\uc640 SQLAlchemy \uc5f0\ub3d9\ud558\uae30","sidebar_label":"Atlas","description":"Atlas\uc640 SQLAlchemy \uc5f0\ub3d9\ud558\uae30","keywords":["atlas","sqlalchemy","schema","migration"]},"sidebar":"python","previous":{"title":"SQLAlchemy","permalink":"/docs/lang/python/libraries/sqlalchemy/"},"next":{"title":"Repository","permalink":"/docs/lang/python/package/repository"}}');var s=l(74848),t=l(28453);const i={id:"atlas",title:"Atlas\uc640 SQLAlchemy \uc5f0\ub3d9\ud558\uae30",sidebar_label:"Atlas",description:"Atlas\uc640 SQLAlchemy \uc5f0\ub3d9\ud558\uae30",keywords:["atlas","sqlalchemy","schema","migration"]},r=void 0,o={},c=[{value:"\uc2a4\ud0a4\ub9c8 \ub9c8\uc774\uadf8\ub808\uc774\uc158 \ud30c\uc77c \uc0dd\uc131",id:"\uc2a4\ud0a4\ub9c8-\ub9c8\uc774\uadf8\ub808\uc774\uc158-\ud30c\uc77c-\uc0dd\uc131",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"\uc2a4\ud0a4\ub9c8-\ub9c8\uc774\uadf8\ub808\uc774\uc158-\ud30c\uc77c-\uc0dd\uc131",children:"\uc2a4\ud0a4\ub9c8 \ub9c8\uc774\uadf8\ub808\uc774\uc158 \ud30c\uc77c \uc0dd\uc131"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://atlasgo.io/guides/orms/sqlalchemy",children:"Automatic migration planning for SQLAlchemy"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"python3 -m pip install atlas-provider-sqlalchemy\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-hcl",children:'data "external_schema" "sqlalchemy" {\n  # \uc544\ub798 \uba85\ub839\uc5b4\ub97c \uc2e4\ud589\ud558\uba74 SQL \ubb38\uc774 \ucd9c\ub825\ub429\ub2c8\ub2e4.\n  program = [\n    "atlas-provider-sqlalchemy",\n    "--path",\n    "./db",\n    "--dialect",\n    "postgresql"\n  ]\n}\n\nenv "sqlalchemy" {\n  src = data.external_schema.sqlalchemy.url\n  dev = "docker://postgresql/15/dev"\n  migration {\n    dir = "file://migrations"\n  }\n  format {\n    migrate {\n      diff = "{{ sql . \\"  \\" }}"\n    }\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.admonition,{type:"info",children:[(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"db/\n\u251c\u2500\u2500 __init__.py\n\u251c\u2500\u2500 base.py\n\u2514\u2500\u2500 ...\n"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",metastring:'title="atlas_models.py"',children:'import importlib\nimport inspect\nfrom pathlib import Path\n\nfrom atlas_provider_sqlalchemy.ddl import print_ddl  # type: ignore[import-untyped]\n\nimport db\n\nmodels = []\n\ndb_dir = Path(db.__file__).parent\n\nfor script in db_dir.glob("*.py"):\n    if script.suffix == ".py" and script.stem not in ["__init__", "base"]:\n        module_name = f"{db.__name__}.{script.stem}"\n        module = importlib.import_module(module_name)\n\n        for name, obj in inspect.getmembers(module):\n            if inspect.isclass(obj) and obj != db.base.Base and issubclass(obj, db.base.Base):\n                models.append(obj)\n\nprint_ddl("postgresql", models)\n'})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-hcl",children:'data "external_schema" "sqlalchemy" {\n  # \uc544\ub798 \uba85\ub839\uc5b4\ub97c \uc2e4\ud589\ud558\uba74 SQL \ubb38\uc774 \ucd9c\ub825\ub429\ub2c8\ub2e4.\n  program = [\n    "python3",\n    "atlas_models.py"\n  ]\n}\n'})}),(0,s.jsx)(n.p,{children:"\uc704\uc640 \uac19\uc740 \ubc29\ubc95\uc744 \uc0ac\uc6a9\ud560 \uc218\ub3c4 \uc788\uc2b5\ub2c8\ub2e4."})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"atlas migrate diff --env sqlalchemy [title]\n"})}),"\n",(0,s.jsxs)(n.p,{children:["SQLAlchemy \ubaa8\ub378\uc744 \ubcc0\uacbd\ud558\uace0 \uc704 \uba85\ub839\uc5b4\ub97c \uc2e4\ud589\ud560\ub54c\ub9c8\ub2e4 \uc801\uc6a9\ud574\uc57c\ud560 SQL\ud30c\uc77c\uc744 migrations \ub514\ub809\ud1a0\ub9ac\uc5d0 \uc0dd\uc131\ud569\ub2c8\ub2e4. \uc0dd\uc131\ub41c \ud30c\uc77c\uc744 \uc9c1\uc811 \uc218\uc815\ud574\uc57c\ud558\ub294 \uacbd\uc6b0, \uc218\uc815 \ud6c4 \uc544\ub798 \uba85\ub839\uc5b4\ub97c \ud1b5\ud574 ",(0,s.jsx)(n.code,{children:"atlas.sum"})," \ud30c\uc77c\uc744 \uc5c5\ub370\uc774\ud2b8\ud574\uc57c\ud569\ub2c8\ub2e4."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"atlas migrate hash\n"})})]})}function m(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);