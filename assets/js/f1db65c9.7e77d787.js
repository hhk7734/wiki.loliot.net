(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[55609],{10337:(e,n,s)=>{"use strict";s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>i,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"mlops/mlops/event/argo-events","title":"Argo Events","description":"Argo Events","source":"@site/docs/mlops/mlops/event/argo-events.mdx","sourceDirName":"mlops/mlops/event","slug":"/mlops/mlops/event/argo-events","permalink":"/docs/mlops/mlops/event/argo-events","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/mlops/mlops/event/argo-events.mdx","tags":[],"version":"current","lastUpdatedAt":1744481281000,"frontMatter":{"id":"argo-events","title":"Argo Events","sidebar_label":"Argo Events","description":"Argo Events","keywords":["argo","events"]},"sidebar":"mlops","previous":{"title":"OpenMPI","permalink":"/docs/mlops/mlops/workflow/mpi-operator/openmpi"},"next":{"title":"NATS","permalink":"/docs/mlops/mlops/event/nats/"}}');var t=s(74848),o=s(28453),a=s(82331);const i={id:"argo-events",title:"Argo Events",sidebar_label:"Argo Events",description:"Argo Events",keywords:["argo","events"]},l=void 0,c={},d=[{value:"\uc124\uce58",id:"\uc124\uce58",level:2},{value:"EventBus",id:"eventbus",level:2},{value:"EventSource",id:"eventsource",level:2},{value:"GitHub",id:"github",level:3},{value:"AMQP",id:"amqp",level:3},{value:"Sensor",id:"sensor",level:2},{value:"Dependencies",id:"dependencies",level:3},{value:"Triggers",id:"triggers",level:3},{value:"Reference",id:"reference",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"\uc124\uce58",children:"\uc124\uce58"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"helm repo add argo https://argoproj.github.io/argo-helm \\\n&& helm repo update argo\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"mkdir -p workflow/argo/events/{helm,eventbus,eventsource}\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"helm search repo argo/argo-events -l | head -n  10\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"helm show values argo/argo-events \\\n    --version 2.0.0 \\\n    > workflow/argo/events/helm/values.yaml\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="workflow/argo/events/helm/values.yaml"',children:"configs:\n  jetstream:\n    versions:\n      - version: 2.8.1\n        natsImage: nats:2.8.1\n        metricsExporterImage: natsio/prometheus-nats-exporter:0.9.1\n        configReloaderImage: natsio/nats-server-config-reloader:0.6.3\n        startCommand: /nats-server\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"helm upgrade argo-events argo/argo-events \\\n    --install \\\n    --version 2.0.0 \\\n    -n workflow \\\n    --values workflow/argo/events/helm/values.yaml\n"})}),"\n",(0,t.jsx)("center",{children:(0,t.jsx)(a.A,{img:s(19510),width:750})}),"\n",(0,t.jsx)(n.h2,{id:"eventbus",children:"EventBus"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="workflow/argo/events/eventbus/default.yaml"',children:"apiVersion: argoproj.io/v1alpha1\nkind: EventBus\nmetadata:\n  name: default\n  namespace: workflow\nspec:\n  jetstream: # nats streaming(stan)\uc740 \ub354 \uc774\uc0c1 \uac1c\ubc1c\ub418\uc9c0 \uc54a\uc74c\n    version: 2.8.1\n    replicas: 3 # minimum 3\n    affinity:\n      podAntiAffinity:\n        preferredDuringSchedulingIgnoredDuringExecution:\n          - podAffinityTerm:\n              labelSelector:\n                matchLabels:\n                  controller: eventbus-controller\n                  eventbus-name: default\n              topologyKey: kubernetes.io/hostname\n            weight: 100\n"})}),"\n",(0,t.jsx)(n.h2,{id:"eventsource",children:"EventSource"}),"\n",(0,t.jsx)(n.h3,{id:"github",children:"GitHub"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Settings -> Developer setttings -> Personal access tokens -> Generate new tokens","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"admin: repo_hook"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"secret\uc744 \uc784\uc758\ub85c \uc815\ud569\ub2c8\ub2e4."}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Secret\nmetadata:\n  name: <name>\n  namespace: workflow\ntype: Opaque\ndata:\n  token: <base64-token>\n  secret: <base64-secret>\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="workflow/argo/events/eventsource/github.yaml"',children:'apiVersion: argoproj.io/v1alpha1\nkind: EventSource\nmetadata:\n  name: github\n  namespace: workflow\nspec:\n  eventBusName: default\n  service:\n    ports:\n      - port: 12000\n        targetPort: 12000 # pod port\n  github:\n    example: # eventName, \uc784\uc758\ub85c \uc124\uc815\ud558\uba74 \ub429\ub2c8\ub2e4.\n      # https://github.com/argoproj/argo-events/blob/master/api/event-source.md#githubeventsource\n      owner: <owner>\n      repository: <repository>\n      webhook:\n        endpoint: <endpoint>\n        port: "12000" # pod port\n        method: POST\n        url: https://<eventsource-url>\n      # https://docs.github.com/en/developers/webhooks-and-events/webhooks/webhook-events-and-payloads\n      contentType: json\n      insecure: false\n      active: true\n      events:\n        - "*"\n      apiToken:\n        name: <secret-name>\n        key: token\n      webhookSecret:\n        name: <secret-name>\n        key: secret\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["repository -> Settings -> Webhooks -> Add webhook","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\uc544\ub798 \ub0b4\uc6a9\uc5d0 \ub9de\ucdb0 Webhook\uc774 \uc790\ub3d9\uc73c\ub85c \uc0dd\uc131\ub429\ub2c8\ub2e4."}),"\n",(0,t.jsxs)(n.li,{children:["Payload URL: ",(0,t.jsx)(n.code,{children:"https://<eventsource-url>/<endpoint>"})]}),"\n",(0,t.jsx)(n.li,{children:"Content type: application/json"}),"\n",(0,t.jsxs)(n.li,{children:["Secret: ",(0,t.jsx)(n.code,{children:"<secret>"})]}),"\n",(0,t.jsx)(n.li,{children:"Enable SSL verification"}),"\n",(0,t.jsx)(n.li,{children:"Send me everything."}),"\n",(0,t.jsx)(n.li,{children:"Active"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"github-eventsource-svc.workflow"})," Service\uac00 \uc790\ub3d9 \uc0dd\uc131\ub429\ub2c8\ub2e4."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"https://<eventsource-url>/<endpoint>"}),"\uac00 \uc678\ubd80\ub85c \ub178\ucd9c \ub420 \uc218 \uc788\ub3c4\ub85d \ub124\ud2b8\uc6cc\ud06c\ub97c \uad6c\uc131\ud569\ub2c8\ub2e4."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"amqp",children:"AMQP"}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsx)(n.p,{children:"Test \uc911"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="workflow/argo/events/eventsource/rabbitmq.yaml"',children:"apiVersion: argoproj.io/v1alpha1\nkind: EventSource\nmetadata:\n  name: rabbitmq\n  namespace: workflow\nspec:\n  amqp:\n    example: # eventName, \uc784\uc758\ub85c \uc124\uc815\ud558\uba74 \ub429\ub2c8\ub2e4.\n      # https://github.com/argoproj/argo-events/blob/master/api/event-source.md#amqpeventsource\n      url: amqp://<service>.<namespace>:5672\n      jsonBody: true\n      exchangeName: <exchange-name>\n      exchangeType: fanout # direct | fanout | headers | topic\n      routingKey: <routing-key>\n      auth:\n        username:\n          name: <user-secret>\n          key: username\n        password:\n          name: <user-secret>\n          key: password\n"})}),"\n",(0,t.jsx)(n.h2,{id:"sensor",children:"Sensor"}),"\n",(0,t.jsx)(n.h3,{id:"dependencies",children:"Dependencies"}),"\n",(0,t.jsx)(n.h3,{id:"triggers",children:"Triggers"}),"\n",(0,t.jsx)(n.h2,{id:"reference",children:"Reference"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://argoproj.github.io/argo-events/",children:"https://argoproj.github.io/argo-events/"})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},19510:(e,n,s)=>{e.exports={src:Object.assign(Object.create({toString(){return this.src}}),{srcSet:s.p+"assets/ideal-img/argo-events-architecture.1628367.750.jpg 750w",images:[{path:s.p+"assets/ideal-img/argo-events-architecture.1628367.750.jpg",width:750,height:306}],src:s.p+"assets/ideal-img/argo-events-architecture.1628367.750.jpg",placeholder:void 0,width:750,height:306}),preSrc:"data:image/jpeg;base64,/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAAEAAoDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAYH/8QAHhAAAQQCAwEAAAAAAAAAAAAAAQIDBBEABQYUIUH/xAAUAQEAAAAAAAAAAAAAAAAAAAAB/8QAFREBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhEDEQA/ANx5lyibpdn14zUZxPXDtupUTdqHwjzzK2MtbsdpwrIK0BVCqFjGMDH/2Q=="}}}]);