(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[9197],{42896:(e,n,l)=>{e.exports={src:{srcSet:l.p+"assets/ideal-img/forward-to-fluent.27d9d99.750.png 750w",images:[{path:l.p+"assets/ideal-img/forward-to-fluent.27d9d99.750.png",width:750,height:374}],src:l.p+"assets/ideal-img/forward-to-fluent.27d9d99.750.png",toString:function(){return l.p+"assets/ideal-img/forward-to-fluent.27d9d99.750.png"},placeholder:void 0,width:750,height:374},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAFCAYAAAB8ZH1oAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA2ElEQVR4nAHNADL/AAya+FFMt/pyjM3y2IjJ86yO0/2qnNb43prT9dOR0vfZg9D9tITO+q0AstTwzMHj+JLw/v//8fXzud/5/aru////zOf0+u7////n+/3A5e/6tgC+3/b2tt/7otnv+PDd6e+p1fH9quX////F6fz33fn//9Tx/MHU6Pe0AMbn+/y74Ph14evxu8fd7i696f+o2f///8rr+/rP9P//xez9wur4/7cAttr1cazY9jvd6vKKqsjnIajU+HPC2u64wtfpqb7X6bOn1PR3zuj7RNHOpOaWODh2AAAAAElFTkSuQmCC"}},98579:(e,n,l)=>{"use strict";l.r(n),l.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>a});var t=l(74848),s=l(28453),r=l(13012);const i={id:"fluentd",title:"Fluentd",sidebar_label:"Fluentd",description:"Fluentd",keywords:["fluentd"]},d=void 0,o={id:"mlops/mlops/monitoring/collector/fluentd",title:"Fluentd",description:"Fluentd",source:"@site/docs/mlops/mlops/monitoring/collector/fluentd.mdx",sourceDirName:"mlops/mlops/monitoring/collector",slug:"/mlops/mlops/monitoring/collector/fluentd",permalink:"/docs/mlops/mlops/monitoring/collector/fluentd",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedAt:1723059214e3,frontMatter:{id:"fluentd",title:"Fluentd",sidebar_label:"Fluentd",description:"Fluentd",keywords:["fluentd"]},sidebar:"mlops",previous:{title:"Fluent Bit",permalink:"/docs/mlops/mlops/monitoring/collector/fluent-bit"},next:{title:"Pipeline(\ub85c\uadf8 \ubcc0\ud658)",permalink:"/docs/mlops/mlops/monitoring/collector/promtail/pipeline"}},c={},a=[{value:"\uc124\uce58",id:"\uc124\uce58",level:2},{value:"\uc124\uc815",id:"\uc124\uc815",level:2},{value:"Tag pattern",id:"tag-pattern",level:3},{value:"Common Parameters",id:"common-parameters",level:3},{value:"source(input)",id:"sourceinput",level:3},{value:"forward",id:"forward",level:4},{value:"buffer",id:"buffer",level:3},{value:"output",id:"output",level:3},{value:"copy",id:"copy",level:4}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"\uc124\uce58",children:"\uc124\uce58"}),"\n",(0,t.jsx)("center",{children:(0,t.jsx)(r.A,{img:l(42896),width:750})}),"\n",(0,t.jsx)("center",{children:(0,t.jsx)(n.a,{href:"https://kubesphere.io/blogs/deep-dive-into-kubernetes-logging/",children:"https://kubesphere.io/blogs/deep-dive-into-kubernetes-logging/"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"helm repo add fluent https://fluent.github.io/helm-charts\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"helm repo update fluent \\\n&& helm search repo fluent/fluentd -l | head -n 10\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"helm show values fluent/fluentd \\\n  --version 0.3.9 \\\n  > fluentd-values.yaml\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="fluentd-values.yaml"',children:'kind: "DaemonSet" # DaemonSet, Deployment or StatefulSet\n\nlivenessProbe:\n  httpGet:\n    path: /metrics\n    port: metrics\n  initialDelaySeconds: 30\n  timeoutSeconds: 15\n\nreadinessProbe:\n  httpGet:\n    path: /metrics\n    port: metrics\n  initialDelaySeconds: 30\n  timeoutSeconds: 15\n\nresources:\n  requests:\n    cpu: 100m\n    memory: 512Mi\n  limits:\n    memory: 512Mi\n\npodLabels: {}\n\nenv:\n  - # /fluentd/etc/../../etc/fluent/fluent.conf\n    # /etc/fluent/fluent.conf\n    name: "FLUENTD_CONF"\n    value: "../../etc/fluent/fluent.conf"\n\ndashboards:\n  enabled: "false"\n\nplugins: []\n\nconfigMapConfigs: []\n\nfileConfigs:\n  01_sources.conf: |\n\n  02_filters.conf: |\n\n  03_dispatch.conf: |\n\n  04_outputs.conf: |\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"helm upgrade fluentd fluent/fluentd \\\n  --install \\\n  --version 0.3.9 \\\n  -n monitoring \\\n  --history-max 5 \\\n  -f fluentd-values.yaml\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\uc124\uc815",children:"\uc124\uc815"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://docs.fluentd.org/configuration",children:"https://docs.fluentd.org/configuration"})}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"Input -> filter 1 -> ... -> filter N -> Output\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"<source>"}),": \uc5b4\ub5a4 \uc815\ubcf4\ub97c \uc785\ub825\ubc1b\uc744\uc9c0 \uc124\uc815","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"@type"}),"\uc774 \ud544\uc218 \uc785\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"<filter <tag pattern>>"}),": \ubc1c\uc0dd\ud55c \uc774\ubca4\ud2b8\ub97c \uc5b4\ub5bb\uac8c \ucc98\ub9ac\ud560\uc9c0 \uc124\uc815"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"<match <tag pattern>>"}),": \ucc98\ub9ac\ub41c \uac12\uc744 \uc5b4\ub5bb\uac8c \uc0ac\uc6a9\ud560\uc9c0 \uc124\uc815"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"<system>"}),": \uc2dc\uc2a4\ud15c \uc124\uc815"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"<label>"}),": \ub0b4\ubd80 \ub77c\uc6b0\ud305\uc744 \uc704\ud574 \ud544\ud130\uc640 \ucd9c\ub825 \uadf8\ub8f9 \uc124\uc815"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"@include path|glob|url"}),": \ub2e4\ub978 \uc124\uc815\ud30c\uc77c \ud638\ucd9c"]}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsx)(n.p,{children:"filter\uc640 match\ub294 \uc120\uc5b8 \uc21c\uc11c\uac00 \uc911\uc694\ud569\ub2c8\ub2e4. match \uc9c0\uc2dc\ubb38\uc758 \ud328\ud134\uc5d0 \uac78\ub9b0 \uacbd\uc6b0 \uadf8 \ub2e4\uc74c \uc120\uc5b8\ub41c \uc9c0\uc2dc\ubb38\uc740 \uc2e4\ud589\ub418\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."})}),"\n",(0,t.jsx)(n.h3,{id:"tag-pattern",children:"Tag pattern"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["tag\ub294 ",(0,t.jsx)(n.code,{children:"."}),"\uc73c\ub85c \uad6c\ubd84 \ub429\ub2c8\ub2e4."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"*"}),": \ud0dc\uadf8 \ud55c \ud30c\ud2b8\uc5d0 \ub300\ud55c glob\uc785\ub2c8\ub2e4.","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"a.*"}),"\ub294 ",(0,t.jsx)(n.code,{children:"a.b"}),", ",(0,t.jsx)(n.code,{children:"a.c"}),"\uc640 \ub9e4\uce58\ub418\uc9c0\ub9cc ",(0,t.jsx)(n.code,{children:"a"}),", ",(0,t.jsx)(n.code,{children:"a.b.c"}),"\ub294 \ub9e4\uce58\ub418\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"**"}),": \ud0dc\uadf8 0 \uac1c \uc774\uc0c1 \ud30c\ud2b8\uc5d0 \ub300\ud55c glob\uc785\ub2c8\ub2e4.","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"a.**"}),"\ub294 ",(0,t.jsx)(n.code,{children:"a"}),", ",(0,t.jsx)(n.code,{children:"a.b"}),", ",(0,t.jsx)(n.code,{children:"a.b.c"})," \ub4f1\uacfc \ub9e4\uce58\ub429\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"{X, Y}"}),": X \ub610\ub294 Y\uc785\ub2c8\ub2e4.","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"a.{b, c}"})," ",(0,t.jsx)(n.code,{children:"{a, b.*}"})," \ub4f1\uc73c\ub85c \uc0ac\uc6a9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"/regex/"})}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"#{...}"}),": ruby \ud45c\ud604\uc2dd\uc73c\ub85c \ubb38\uc790\uc5f4\uc744 \ub098\ud0c0\ub0bc \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"common-parameters",children:"Common Parameters"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://docs.fluentd.org/configuration/plugin-common-parameters",children:"https://docs.fluentd.org/configuration/plugin-common-parameters"})}),"\n"]}),"\n",(0,t.jsx)("br",{}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"@type"}),": \uc0ac\uc6a9\ud560 \ud50c\ub7ec\uadf8\uc778"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"@id"}),": \uc2dd\ubcc4\uc790"]}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"@log_level"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"@label"})}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsx)(n.p,{children:"conf \ud30c\uc77c\uc744 \uc218\uc815\ud558\uba74 fluentd\ub97c \uc7ac\uc2dc\uc791 \ud574\uc8fc\uc138\uc694."})}),"\n",(0,t.jsx)(n.h3,{id:"sourceinput",children:"source(input)"}),"\n",(0,t.jsx)(n.h4,{id:"forward",children:"forward"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="fluentd-values.yaml"',children:'kind: "Deployment"\n\nservice:\n  ports:\n    - name: "forwarder"\n      protocol: TCP\n      containerPort: 24224\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"# https://docs.fluentd.org/input/forward\n<source>\n    @type forward\n    port 24224\n    bind 0.0.0.0\n</source>\n"})}),"\n",(0,t.jsx)(n.h3,{id:"buffer",children:"buffer"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://docs.fluentd.org/configuration/buffer-section",children:"https://docs.fluentd.org/configuration/buffer-section"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://docs.fluentd.org/buffer",children:"https://docs.fluentd.org/buffer"})}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"<buffer>\n    flush_at_shutdown true\n    flush_interval 10s\n    flush_thread_count 4\n    retry_max_interval 30s\n</buffer>\n"})}),"\n",(0,t.jsx)(n.h3,{id:"output",children:"output"}),"\n",(0,t.jsx)(n.h4,{id:"copy",children:"copy"}),"\n",(0,t.jsx)(n.p,{children:"\ub3d9\uc77c\ud55c tag \ud328\ud134\uc744 \uac16\ub294 match\ub294 \uba3c\uc800 \uc120\uc5b8\ub41c \uac83\ub9cc \uc2e4\ud589\ub418\uae30 \ub54c\ubb38\uc5d0, \uc5ec\ub7ec output\uc744 \uc0ac\uc6a9\ud558\uace0 \uc2f6\ub2e4\uba74 copy\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"<match pattern>\n    @type copy\n    <store>\n        @type <output>\n        ...\n    </store>\n    <store>\n        @type <output>\n        ...\n    </store>\n    <store>\n        @type <output>\n        ...\n    </store>\n</match>\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}}}]);