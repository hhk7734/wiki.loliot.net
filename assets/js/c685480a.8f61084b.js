"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[74332],{7389:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>r,default:()=>a,frontMatter:()=>c,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"mlops/kubernetes/scheduling/affinity","title":"Affinity","description":"node/pod affinity/anti-affinity","source":"@site/docs/mlops/kubernetes/scheduling/affinity.mdx","sourceDirName":"mlops/kubernetes/scheduling","slug":"/mlops/kubernetes/scheduling/affinity","permalink":"/docs/mlops/kubernetes/scheduling/affinity","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/mlops/kubernetes/scheduling/affinity.mdx","tags":[],"version":"current","lastUpdatedAt":1754504024000,"frontMatter":{"id":"affinity","title":"Affinity","sidebar_label":"Affinity","description":"node/pod affinity/anti-affinity","keywords":["kubernetes","affinity","anti-affinity"]},"sidebar":"kubernetes","previous":{"title":"Audit \uc815\ucc45 \uc124\uc815","permalink":"/docs/mlops/kubernetes/security/audit"},"next":{"title":"Taints and Tolerations","permalink":"/docs/mlops/kubernetes/scheduling/taint-toleration"}}');var l=i(74848),d=i(28453);const c={id:"affinity",title:"Affinity",sidebar_label:"Affinity",description:"node/pod affinity/anti-affinity",keywords:["kubernetes","affinity","anti-affinity"]},r=void 0,t={},o=[{value:"nodeAffinity",id:"nodeaffinity",level:2},{value:"podAffinity &amp; podAntiAffinity",id:"podaffinity--podantiaffinity",level:2}];function h(e){const n={admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,d.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h2,{id:"nodeaffinity",children:"nodeAffinity"}),"\n",(0,l.jsx)(n.admonition,{title:"Reference",type:"info",children:(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"kubectl explain pod.spec.affinity.nodeAffinity"})}),"\n"]})}),"\n",(0,l.jsx)(n.p,{children:"nodeAffinity\ub294 Pod\uac00 \uc2a4\ucf00\uc904\ub9c1\ub420 Node\uc758 \uc870\uac74\uc744 \uc815\uc758\ud569\ub2c8\ub2e4."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"spec:\n  affinity:\n    nodeAffinity:\n      requiredDuringSchedulingIgnoredDuringExecution:\n        nodeSelectorTerms:\n          - matchExpressions:\n              - key: kubernetes.io/arch\n                operator: In\n                values:\n                  - amd64\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"requiredDuringSchedulingIgnoredDuringExecution"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"nodeSelectorTerms: []"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\uc5ec\ub7ec \uac1c\ub97c \uc120\uc5b8\ud558\uba74 OR \uc870\uac74\uc774 \uc801\uc6a9\ub429\ub2c8\ub2e4"}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"matchExpressions: []"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\uc5ec\ub7ec \uac1c\ub97c \uc120\uc5b8\ud558\uba74 AND \uc870\uac74\uc774 \uc801\uc6a9\ub429\ub2c8\ub2e4"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"key: <key>"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"operator: In|NotIn|Exists|DoesNotExist|Gt|Lt"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"values: []"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"matchFields: []"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\uc5ec\ub7ec \uac1c\ub97c \uc120\uc5b8\ud558\uba74 AND \uc870\uac74\uc774 \uc801\uc6a9\ub429\ub2c8\ub2e4"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"key: metadata.name"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"operator: In|NotIn|Exists|DoesNotExist|Gt|Lt"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"values: []"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"preferredDuringSchedulingIgnoredDuringExecution: []"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\uc5ec\ub7ec \uac1c\ub97c \uc120\uc5b8\ud558\uba74 \ub9cc\uc871\ud558\ub294 \uc870\uac74\uc758 weight\uc758 \ucd1d\ud569\uc774 \ub192\uc740 Node\uc5d0 Pod\uc744 \uc2a4\ucf00\uc904\ub9c1\ud569\ub2c8\ub2e4"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"weight: 1 ~ 100"})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"preference"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"matchExpressions: []"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"matchFields: []"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"podaffinity--podantiaffinity",children:"podAffinity & podAntiAffinity"}),"\n",(0,l.jsx)(n.admonition,{title:"Reference",type:"info",children:(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"kubectl explain pod.spec.affinity.podAffinity"})}),"\n"]})}),"\n",(0,l.jsxs)(n.p,{children:["Pod\uac00 \uc2a4\ucf00\uc904\ub9c1\ub420 \ub54c ",(0,l.jsx)(n.code,{children:"topologyKey"}),"\uc870\uac74 \ub0b4\uc5d0\uc11c label\uc774 \uc77c\uce58\ud558\ub294 Pod\uc744 \ucc3e\uc2b5\ub2c8\ub2e4. ",(0,l.jsx)(n.code,{children:"podAffinity"}),"\uc758 \uacbd\uc6b0 \uc870\uac74\uc774 \uc77c\uce58\ud558\ub294 \ud1a0\ud3f4\ub85c\uc9c0\uc5d0 Pod\ub97c \ubc30\uce58\ud558\uace0, ",(0,l.jsx)(n.code,{children:"podAntiAffinity"}),"\uc758 \uacbd\uc6b0 \uc870\uac74\uc774 \uc77c\uce58\ud558\ub294 \ud1a0\ud3f4\ub85c\uc9c0\ub97c \ud53c\ud574\uc11c Pod\uc744 \ubc30\uce58\ud569\ub2c8\ub2e4."]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"spec:\n  affinity:\n    podAntiAffinity:\n      preferredDuringSchedulingIgnoredDuringExecution:\n        - weight: 1\n          podAffinityTerm:\n            topologyKey: kubernetes.io/hostname\n            labelSelector:\n              matchExpressions:\n                - key: app.kubernetes.io/name\n                  operator: In\n                  values:\n                    - test-app\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"requiredDuringSchedulingIgnoredDuringExecution"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"topologyKey: <labelKey>"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Node\uc758 label\uc744 \ud655\uc778\ud558\uc5ec ",(0,l.jsx)(n.code,{children:"<topologyKey>: <topologyValue>"}),"\uac00 \uac19\uc740 Node\ub97c \uae30\uc900\uc73c\ub85c selector\uc758 \uc870\uac74\uc744 \ud655\uc778\ud569\ub2c8\ub2e4"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"kubernetes.io/hostname"}),": \ud55c Node \ub0b4\uc5d0\uc11c \uc870\uac74\uc744 \ub9cc\uc871\ud574\uc57c\ud569\ub2c8\ub2e4"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"topology.kubernetes.io/zone"}),": \uac19\uc740 zone \ub0b4\uc5d0\uc11c \uc870\uac74\uc744 \ub9cc\uc871\ud574\uc57c\ud569\ub2c8\ub2e4"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"namespaces: []"})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"namespaceSelector"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"{}"}),"\uc778 \uacbd\uc6b0 \ubaa8\ub4e0 namespace\ub97c \uae30\uc900\uc73c\ub85c \ud569\ub2c8\ub2e4"]}),"\n",(0,l.jsxs)(n.li,{children:["null\uc778 \uacbd\uc6b0 namespaces\uac00 null\uc774\uac70\ub098 ",(0,l.jsx)(n.code,{children:"[]"}),"\uc774\uba74 Pod\uc758 namespace\uac00 \uc870\uac74\uc774 \ub429\ub2c8\ub2e4"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"matchExpressions: []"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"key: <key>"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"operator: In|NotIn|Exists|DoesNotExist"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"values: []"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"matchLabels"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"<key>: <value>"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"matchLabelKeys: []"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"labelSelector\uac00 \uc124\uc815\ub418\uc5b4 \uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"mismatchLabelKeys: []"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"labelSelector\uac00 \uc124\uc815\ub418\uc5b4 \uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"labelSelector"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"matchExpressions: []"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"matchLabels: {}"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"preferredDuringSchedulingIgnoredDuringExecution: []"})}),"\n"]})]})}function a(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(h,{...e})}):h(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>c,x:()=>r});var s=i(96540);const l={},d=s.createContext(l);function c(e){const n=s.useContext(d);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:c(e.components),s.createElement(d.Provider,{value:n},e.children)}}}]);