"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[59943],{28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>l});var s=t(96540);const a={},r=s.createContext(a);function i(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(r.Provider,{value:n},e.children)}},49410:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>i,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"mlops/nn/llm/chat-template","title":"Chat Template","description":"Chat Template","source":"@site/docs/mlops/nn/llm/chat-template.mdx","sourceDirName":"mlops/nn/llm","slug":"/mlops/nn/llm/chat-template","permalink":"/docs/mlops/nn/llm/chat-template","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/mlops/nn/llm/chat-template.mdx","tags":[],"version":"current","lastUpdatedAt":1762182777000,"frontMatter":{"id":"chat-template","title":"Chat Template","sidebar_label":"Chat Template","description":"Chat Template","keywords":["Neural Network","Large Language Model","Chat Template"]},"sidebar":"nn","previous":{"title":"Metrics for inference","permalink":"/docs/mlops/nn/llm/metrics"}}');var a=t(74848),r=t(28453);const i={id:"chat-template",title:"Chat Template",sidebar_label:"Chat Template",description:"Chat Template",keywords:["Neural Network","Large Language Model","Chat Template"]},l=void 0,d={},o=[{value:"Chat Template",id:"chat-template",level:2},{value:"add_generation_prompt",id:"add_generation_prompt",level:2},{value:"Chat Template \uc791\uc131\ud558\uae30",id:"chat-template-\uc791\uc131\ud558\uae30",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"chat-template",children:"Chat Template"}),"\n",(0,a.jsx)(n.admonition,{title:"References",type:"info",children:(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://huggingface.co/docs/transformers/en/chat_templating",children:"Hugging Face / Inference / Chat with Models / Chat templates"})}),"\n"]})}),"\n",(0,a.jsx)(n.p,{children:"\ubaa8\ub4e0 causal LM (\uc778\uacfc\uc801 \uc5b8\uc5b4 \ubaa8\ub378)\uc740 \uc5c4\uccad\ub09c \uc591\uc758 corpus\ub97c \ub300\uc0c1\uc73c\ub85c pre-training\uc744 \uc218\ud589\ud558\uc5ec, \uc774\ub97c \ud1b5\ud574 base LM\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4. \uc774\ud6c4, \ud2b9\uc815 \uc791\uc5c5\uc5d0 \ub9de\ucdb0 fine-tuning\uc744 \uc9c4\ud589\ud558\uc5ec fine-tuned LM\uc744 \uc5bb\uac8c \ub429\ub2c8\ub2e4."}),"\n",(0,a.jsx)(n.p,{children:"ChatGPT \ucc98\ub7fc \ub300\ud654\ud615 AI\uc758 \uacbd\uc6b0 \ub300\ud654\ub97c \uc798 \ucc98\ub9ac\ud558\ub3c4\ub85d fine-tuning\uc774 \ud544\uc694\ud55c\ub370, \ud56d\uc0c1 \uac19\uc740 \ud615\uc2dd\uc758 \uc785\ub825\uc744 \uc8fc\ub294 \uac83\uc774 \uc911\uc694\ud569\ub2c8\ub2e4. \uc608\ub97c \ub4e4\uc5b4, \uc544\ub798\uc640 \uac19\uc740 \ud615\uc2dd\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'system: "assistant\ub294 \uce5c\uc808\ud574\uc57c \ud574. xxx\uc778 \uacbd\uc6b0 yyy \ub97c \uc218\ud589\ud574."\nuser: "\uc624\ub298 \ub0a0\uc528 \uc5b4\ub54c?"\nassistant: "\ub0a0\uc528\ub97c \uac80\uc0c9\ud574\ub3c4 \ub418\ub098\uc694?"\n'})}),"\n",(0,a.jsxs)(n.p,{children:["\uc774\ub7ec\ud55c \ud615\uc2dd\uc744 \ud559\uc2b5\ud558\uba74, ",(0,a.jsx)(n.code,{children:"^system: "})," \ud6c4\uc5d0 \uc624\ub294 \ud14d\uc2a4\ud2b8\ub97c \uae30\ubc18\uc73c\ub85c ",(0,a.jsx)(n.code,{children:"^user: "}),"\uc758 \uc9c8\ubb38\uc5d0 \ub300\ud55c \ub2f5\uc744 ",(0,a.jsx)(n.code,{children:"^assistant: "})," \ub4a4\uc5d0 user\uc758 \uc694\uccad\uc5d0 \ub300\ud55c \ub2f5\uc774 \uc788\uc5b4\uc57c \ud55c\ub2e4\uace0 \ubaa8\ub378\uc774 \ud559\uc2b5\ud558\uac8c \ub429\ub2c8\ub2e4."]}),"\n",(0,a.jsx)(n.p,{children:"\uc560\ud50c\ub9ac\ucf00\uc774\uc158 \uac1c\ubc1c \uc2dc \uc0ac\uc6a9\ud558\ub294 \ub370\uc774\ud130 \ud615\uc2dd\uacfc \ubaa8\ub378\uc774 \ud559\uc2b5\ud55c \ud615\uc2dd\uc774 \ub2e4\ub97c \uc218 \uc788\uae30 \ub54c\ubb38\uc5d0, \uc774\ub97c \ub9de\ucdb0\uc8fc\ub294 \uc791\uc5c5\uc774 \ud544\uc694\ud569\ub2c8\ub2e4. \uc774\ub54c \uc0ac\uc6a9\ud558\ub294 \uac83\uc774 Chat Template\uc785\ub2c8\ub2e4."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from transformers import AutoTokenizer\n\ntokenizer = AutoTokenizer.from_pretrained("meta-llama/Llama-3.2-1B-Instruct")\n\nmessages = [\n    {"role": "system", "content": "assistant\ub294 \uce5c\uc808\ud574\uc57c \ud574. xxx\uc778 \uacbd\uc6b0 yyy \ub97c \uc218\ud589\ud574."},\n    {"role": "user", "content": "\uc624\ub298 \ub0a0\uc528 \uc5b4\ub54c?"},\n]\n\nprint(tokenizer.apply_chat_template(messages, tokenize=False))\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"<|begin_of_text|><|start_header_id|>system<|end_header_id|>\n\nCutting Knowledge Date: December 2023\nToday Date: 24 Oct 2025\n\nassistant\ub294 \uce5c\uc808\ud574\uc57c \ud574. xxx\uc778 \uacbd\uc6b0 yyy \ub97c \uc218\ud589\ud574.<|eot_id|><|start_header_id|>user<|end_header_id|>\n\n\uc624\ub298 \ub0a0\uc528 \uc5b4\ub54c?<|eot_id|>\n"})}),"\n",(0,a.jsx)(n.h2,{id:"add_generation_prompt",children:"add_generation_prompt"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"\uc785\ub825 A"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'system: "assistant\ub294 \uce5c\uc808\ud574\uc57c \ud574. xxx\uc778 \uacbd\uc6b0 yyy \ub97c \uc218\ud589\ud574."\nuser: "\uc624\ub298 \ub0a0\uc528 \uc5b4\ub54c?"\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"\ub2f5"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'"\ub0a0\uc528\ub97c \uac80\uc0c9\ud574\ub3c4 \ub418\ub098\uc694?"\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"\uc785\ub825 B"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'system: "assistant\ub294 \uce5c\uc808\ud574\uc57c \ud574. xxx\uc778 \uacbd\uc6b0 yyy \ub97c \uc218\ud589\ud574."\nuser: "\uc624\ub298 \ub0a0\uc528 \uc5b4\ub54c?"\nassistant:\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"\ub2f5"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'"\ub0a0\uc528\ub97c \uac80\uc0c9\ud574\ub3c4 \ub418\ub098\uc694?"\n'})}),"\n",(0,a.jsxs)(n.p,{children:["\uc704\uc640 \uac19\uc774 \ub450 \ubc29\uc2dd\uc73c\ub85c fine-tuning\uc744 \ud560 \ub54c, \uc785\ub825 B\uac00 \uc785\ub825 A \ubcf4\ub2e4 \ub354 \ub098\uc740 \uc131\ub2a5\uc744 \ubcf4\uc778\ub2e4\uace0 \ud569\ub2c8\ub2e4. \ub530\ub77c\uc11c fine-tuning\uc744 \uc785\ub825 B\ub85c \ud55c \uacbd\uc6b0, \uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc774 \uc785\ub825 A\ub97c \uc8fc\ub354\ub77c\ub3c4 \ubaa8\ub378\uc5d0\uac8c\ub294 \ud559\uc2b5\ud55c \ubc29\uc2dd\ub300\ub85c \uc785\ub825\uc744 \uc8fc\ub3c4\ub85d \ubcc0\ud658\ud574\uc8fc\ub294 \uac83\uc774 \uc88b\uc2b5\ub2c8\ub2e4. \uc774\ub97c \uc704\ud574 ",(0,a.jsx)(n.code,{children:"add_generation_prompt"})," \uc635\uc158\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from transformers import AutoTokenizer\n\ntokenizer = AutoTokenizer.from_pretrained("meta-llama/Llama-3.2-1B-Instruct")\n\nmessages = [\n    {"role": "system", "content": "assistant\ub294 \uce5c\uc808\ud574\uc57c \ud574. xxx\uc778 \uacbd\uc6b0 yyy \ub97c \uc218\ud589\ud574."},\n    {"role": "user", "content": "\uc624\ub298 \ub0a0\uc528 \uc5b4\ub54c?"},\n]\n\nprint(tokenizer.apply_chat_template(messages, tokenize=False, add_generation_prompt=True))\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"<|begin_of_text|><|start_header_id|>system<|end_header_id|>\n\nCutting Knowledge Date: December 2023\nToday Date: 24 Oct 2025\n\nassistant\ub294 \uce5c\uc808\ud574\uc57c \ud574. xxx\uc778 \uacbd\uc6b0 yyy \ub97c \uc218\ud589\ud574.<|eot_id|><|start_header_id|>user<|end_header_id|>\n\n\uc624\ub298 \ub0a0\uc528 \uc5b4\ub54c?<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"<|start_header_id|>assistant<|end_header_id|>"}),"\uac00 \ucd94\uac00\ub41c \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n",(0,a.jsx)(n.h2,{id:"chat-template-\uc791\uc131\ud558\uae30",children:"Chat Template \uc791\uc131\ud558\uae30"}),"\n",(0,a.jsxs)(n.p,{children:["Chat Template\uc740 tokernizer\uc5d0 ",(0,a.jsx)(n.code,{children:"chat_template"})," \uc18d\uc131\uc73c\ub85c \uc800\uc7a5\ub41c Jinja template \uc785\ub2c8\ub2e4."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jinja2",children:"{%- for message in messages %}\n    {{- '<|' + message['role'] + |>\\n' }}\n    {{- message['content'] + eos_token }}\n{%- endfor %}\n{%- if add_generation_prompt %}\n    {{- '<|assistant|>\\n' }}\n{%- endif %}\n"})})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}}}]);