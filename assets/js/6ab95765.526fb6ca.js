"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[69052],{28453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>i});var a=s(96540);const r={},t=a.createContext(r);function l(e){const n=a.useContext(t);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),a.createElement(t.Provider,{value:n},e.children)}},78587:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>d,frontMatter:()=>l,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"mlops/kubernetes/cluster/eks/eks-rbac","title":"EKS RBAC","description":"EKS RBAC","source":"@site/docs/mlops/kubernetes/cluster/eks/eks-rbac.mdx","sourceDirName":"mlops/kubernetes/cluster/eks","slug":"/mlops/kubernetes/cluster/eks/eks-rbac","permalink":"/docs/mlops/kubernetes/cluster/eks/eks-rbac","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/mlops/kubernetes/cluster/eks/eks-rbac.mdx","tags":[],"version":"current","lastUpdatedAt":1758465175000,"frontMatter":{"id":"eks-rbac","title":"EKS RBAC","sidebar_label":"EKS RBAC","description":"EKS RBAC","keywords":["EKS","RBAC"]},"sidebar":"kubernetes","previous":{"title":"NodeGroup","permalink":"/docs/mlops/kubernetes/cluster/eks/node-group"},"next":{"title":"keycloak","permalink":"/docs/mlops/kubernetes/cluster/eks/keycloak"}}');var r=s(74848),t=s(28453);const l={id:"eks-rbac",title:"EKS RBAC",sidebar_label:"EKS RBAC",description:"EKS RBAC",keywords:["EKS","RBAC"]},i=void 0,o={},c=[{value:"Kubernetes Group",id:"kubernetes-group",level:2},{value:"mapUsers",id:"mapusers",level:2},{value:"Policy",id:"policy",level:3},{value:"aws-auth",id:"aws-auth",level:3},{value:"kubectl",id:"kubectl",level:3},{value:"mapRoles",id:"maproles",level:2},{value:"Policy",id:"policy-1",level:3},{value:"aws-auth",id:"aws-auth-1",level:3},{value:"kubectl",id:"kubectl-1",level:3},{value:"Reference",id:"reference",level:2}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"kubernetes-group",children:"Kubernetes Group"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'apiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: guest\nrules:\n  - apiGroups:\n      - ""\n    resources:\n      - nodes\n      - namespaces\n    verbs:\n      - get\n      - list\n\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: guest\nsubjects:\n  - apiGroup: rbac.authorization.k8s.io\n    kind: Group\n    name: guest\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: guest\n\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  name: guest\n  namespace: default\nrules:\n  - apiGroups:\n      - ""\n    resources:\n      - pods\n    verbs:\n      - get\n      - list\n  - apiGroups:\n      - apps\n    resources:\n      - deployments\n      - daemonsets\n      - statefulsets\n      - replicasets\n    verbs:\n      - get\n      - list\n\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  name: guest\n  namespace: default\nsubjects:\n  - apiGroup: rbac.authorization.k8s.io\n    kind: Group\n    name: guest\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: Role\n  name: guest\n'})}),"\n",(0,r.jsx)(n.h2,{id:"mapusers",children:"mapUsers"}),"\n",(0,r.jsx)(n.h3,{id:"policy",children:"Policy"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'name = "read-eks-policy"\nread_eks_policy = aws.iam.Policy(\n    name,\n    name_prefix=name,\n    policy=json.dumps(\n        {\n            "Version": "2012-10-17",\n            "Statement": [\n                {\n                    "Sid": "VisualEditor0",\n                    "Effect": "Allow",\n                    "Action": [\n                        "eks:DescribeCluster",\n                        "eks:ListClusters",\n                    ],\n                    "Resource": "*",\n                }\n            ],\n        }\n    ),\n    tags={\n        "Name": name,\n        "Stack": variable.stack_name,\n    },\n)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"aws-auth",children:"aws-auth"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"kind: ConfigMap\napiVersion: v1\nmetadata:\n  name: aws-auth\n  namespace: kube-system\ndata:\n  mapRoles: |\n    ...\n\n  mapUsers: |\n    - userarn: arn:aws:iam::<account-id>:user/<username>\n      username: <username>\n      groups:\n        - guest\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsxs)(n.p,{children:["userarn\uacfc username\uc758 ",(0,r.jsx)(n.code,{children:"<username>"}),"\uc774 \ub3d9\uc77c\ud560 \ud544\uc694\ub294 \uc5c6\uc2b5\ub2c8\ub2e4."]})}),"\n",(0,r.jsx)(n.h3,{id:"kubectl",children:"kubectl"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"aws sts get-caller-identity\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"aws eks list-clusters\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"aws eks update-kubeconfig \\\n    --name <cluster-name> \\\n    --kubeconfig ~/.kube/<cluster-name>\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"export KUBECONFIG=<config-path>[:<config-path>]\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"kubectl get pods\n"})}),"\n",(0,r.jsx)(n.h2,{id:"maproles",children:"mapRoles"}),"\n",(0,r.jsx)(n.h3,{id:"policy-1",children:"Policy"}),"\n",(0,r.jsx)(n.h3,{id:"aws-auth-1",children:"aws-auth"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"kind: ConfigMap\napiVersion: v1\nmetadata:\n  name: aws-auth\n  namespace: kube-system\ndata:\n  mapRoles: |\n    - rolearn: arn:aws:iam::<account-id>:role/<rolename>\n      username: <rolename>\n      groups:\n        - guest\n\n  mapUsers: |\n    ...\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsxs)(n.p,{children:["rolearn\uacfc username\uc758 ",(0,r.jsx)(n.code,{children:"<rolename>"}),"\uc774 \ub3d9\uc77c\ud560 \ud544\uc694\ub294 \uc5c6\uc2b5\ub2c8\ub2e4."]})}),"\n",(0,r.jsx)(n.h3,{id:"kubectl-1",children:"kubectl"}),"\n",(0,r.jsx)(n.h2,{id:"reference",children:"Reference"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/add-user-role.html",children:"https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/add-user-role.html"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/security_iam_id-based-policy-examples.html",children:"https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/security_iam_id-based-policy-examples.html"})}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}}}]);