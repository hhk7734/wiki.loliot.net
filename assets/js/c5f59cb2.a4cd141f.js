"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[30248],{27425:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>t,default:()=>u,frontMatter:()=>l,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"mlops/mlops/container/s6-overlay","title":"s6-overlay\ub85c \ucee8\ud14c\uc774\ub108 \ud504\ub85c\uc138\uc2a4 \uad00\ub9ac\ud558\uae30","description":"s6-overlay\ub85c \ucee8\ud14c\uc774\ub108 \ud504\ub85c\uc138\uc2a4 \uad00\ub9ac\ud558\uae30","source":"@site/docs/mlops/mlops/container/s6-overlay.mdx","sourceDirName":"mlops/mlops/container","slug":"/mlops/mlops/container/s6-overlay","permalink":"/docs/mlops/mlops/container/s6-overlay","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/mlops/mlops/container/s6-overlay.mdx","tags":[],"version":"current","lastUpdatedAt":1746813776000,"frontMatter":{"id":"s6-overlay","title":"s6-overlay\ub85c \ucee8\ud14c\uc774\ub108 \ud504\ub85c\uc138\uc2a4 \uad00\ub9ac\ud558\uae30","sidebar_label":"s6-overlay","description":"s6-overlay\ub85c \ucee8\ud14c\uc774\ub108 \ud504\ub85c\uc138\uc2a4 \uad00\ub9ac\ud558\uae30","keywords":["s6-overlay","s6","container"]},"sidebar":"mlops","previous":{"title":".dockerignore","permalink":"/docs/mlops/mlops/container/build/dockerignore"},"next":{"title":"k8s \uc778\uc99d(Authn)","permalink":"/docs/mlops/mlops/auth/authn"}}');var i=n(74848),c=n(28453);const l={id:"s6-overlay",title:"s6-overlay\ub85c \ucee8\ud14c\uc774\ub108 \ud504\ub85c\uc138\uc2a4 \uad00\ub9ac\ud558\uae30",sidebar_label:"s6-overlay",description:"s6-overlay\ub85c \ucee8\ud14c\uc774\ub108 \ud504\ub85c\uc138\uc2a4 \uad00\ub9ac\ud558\uae30",keywords:["s6-overlay","s6","container"]},t=void 0,o={},a=[{value:"s6-overlay",id:"s6-overlay",level:2},{value:"\uc124\uce58",id:"\uc124\uce58",level:2},{value:"\uc11c\ube44\uc2a4 \uc124\uc815",id:"\uc11c\ube44\uc2a4-\uc124\uc815",level:2},{value:"\ub514\ub809\ud1a0\ub9ac \uad6c\uc870",id:"\ub514\ub809\ud1a0\ub9ac-\uad6c\uc870",level:3}];function d(e){const s={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",del:"del",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.admonition,{title:"Reference",type:"info",children:(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"https://github.com/just-containers/s6-overlay",children:"s6-overlay GitHub"})}),"\n"]})}),"\n",(0,i.jsx)(s.h2,{id:"s6-overlay",children:"s6-overlay"}),"\n",(0,i.jsxs)(s.blockquote,{children:["\n",(0,i.jsx)(s.p,{children:"s6 is a collection of utilities revolving around process supervision and management, logging, and system initialization."}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["s6-overlay\ub294 s6\ub97c \uc0ac\uc6a9\ud558\uc5ec \ucee8\ud14c\uc774\ub108\uc758 ",(0,i.jsx)(s.strong,{children:"\ud504\ub85c\uc138\uc2a4\ub4e4"}),"\uc744 \uad00\ub9ac\ud558\ub3c4\ub85d \ub3c4\uc640\uc8fc\ub294 \ub3c4\uad6c \ubaa8\uc74c\uc785\ub2c8\ub2e4."]}),"\n",(0,i.jsx)(s.p,{children:"\ucee8\ud14c\uc774\ub108\ub97c \uc2e4\ud589 \ud6c4 \ud504\ub85c\uc138\uc2a4\ub97c \ubcf4\uba74 \uc544\ub798\uc640 \uac19\uc740 \uad6c\uc870\uc640 \ub85c\uadf8\ub97c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-shell",children:"root@6a91358e31c0:/# pstree\ns6-svscan-+-rc.init---<mainService>\n          |-s6-supervise---s6-linux-init-s\n          |-s6-supervise---<service>\n          |-s6-supervise\n          `-s6-supervise---s6-ipcserverd\n"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-shell",children:"s6-rc: info: service s6rc-oneshot-runner: starting\ns6-rc: info: service s6rc-oneshot-runner successfully started\ns6-rc: info: service fix-attrs: starting\ns6-rc: info: service fix-attrs successfully started\ns6-rc: info: service legacy-cont-init: starting\ns6-rc: info: service legacy-cont-init successfully started\ns6-rc: info: service test-service: starting\ns6-rc: info: service test-service successfully started\ns6-rc: info: service legacy-services: starting\ns6-rc: info: service legacy-services successfully started\n\n# \uba54\uc778 \uc11c\ube44\uc2a4 \uc2e4\ud589\n# ...\n\ns6-rc: info: service legacy-services: stopping\ns6-rc: info: service legacy-services successfully stopped\ns6-rc: info: service test-service: stopping\ns6-rc: info: service test-service successfully stopped\ns6-rc: info: service legacy-cont-init: stopping\ns6-rc: info: service legacy-cont-init successfully stopped\ns6-rc: info: service fix-attrs: stopping\ns6-rc: info: service fix-attrs successfully stopped\ns6-rc: info: service s6rc-oneshot-runner: stopping\ns6-rc: info: service s6rc-oneshot-runner successfully stopped\n"})}),"\n",(0,i.jsx)(s.h2,{id:"\uc124\uce58",children:"\uc124\uce58"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-dockerfile",children:'FROM ubuntu:22.04\n\nARG S6_OVERLAY_VERSION=3.2.1.0\n\n# 2: Stop the container\nENV S6_BEHAVIOUR_IF_STAGE2_FAILS=2\n\nRUN apt-get update \\\n    && apt-get install -y --no-install-recommends \\\n    ca-certificates \\\n    curl \\\n    xz-utils \\\n    vim \\\n    && rm -rf /var/lib/apt/lists/*\n\nRUN curl -fsSLO https://github.com/just-containers/s6-overlay/releases/download/v${S6_OVERLAY_VERSION}/s6-overlay-noarch.tar.xz \\\n    && curl -fsSLO https://github.com/just-containers/s6-overlay/releases/download/v${S6_OVERLAY_VERSION}/s6-overlay-x86_64.tar.xz \\\n    && tar -C / -Jxpf s6-overlay-noarch.tar.xz \\\n    && tar -C / -Jxpf s6-overlay-x86_64.tar.xz \\\n    && rm s6-overlay-noarch.tar.xz \\\n    && rm s6-overlay-x86_64.tar.xz\n\nENTRYPOINT [ "/init" ]\n'})}),"\n",(0,i.jsx)(s.h2,{id:"\uc11c\ube44\uc2a4-\uc124\uc815",children:"\uc11c\ube44\uc2a4 \uc124\uc815"}),"\n",(0,i.jsx)(s.h3,{id:"\ub514\ub809\ud1a0\ub9ac-\uad6c\uc870",children:"\ub514\ub809\ud1a0\ub9ac \uad6c\uc870"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-shell",children:"/etc/s6-overlay/s6-rc.d/\n\u251c\u2500\u2500 user/\n\u2502   \u251c\u2500\u2500 contents.d/\n\u2502   \u2502   \u251c\u2500\u2500 <service>\n\u2502   \u2502   \u2514\u2500\u2500 ...\n\u2502   \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 <service>/\n\u2502   \u251c\u2500\u2500 type\n\u2502   \u251c\u2500\u2500 run\n\u2502   \u251c\u2500\u2500 dependencies.d/\n\u2502   \u2502   \u251c\u2500\u2500 base\n\u2502   \u2502   \u251c\u2500\u2500 <dependency>\n\u2502   \u2502   \u2514\u2500\u2500 ...\n\u2502   \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 ...\n"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"/etc/s6-overlay/s6-rc.d"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"user"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"\ud56d\uc0c1 \uc2e4\ud589\ub418\ub294 \uc11c\ube44\uc2a4\uc785\ub2c8\ub2e4."}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"contents.d"}),"\uc5d0 \uc788\ub294 \ud30c\uc77c\ub4e4\uc758 \uc774\ub984\uc5d0 \ud574\ub2f9\ud55c\ub294 \uc11c\ube44\uc2a4\uac00 \uc758\uc874\uc131\uc5d0 \ub530\ub77c \uc2e4\ud589\ub429\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"<service>"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"\uc0ac\uc6a9\uc790 \uc815\uc758 \uc11c\ube44\uc2a4\uc785\ub2c8\ub2e4."}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"type"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"oneshot \ub610\ub294 longrun\uc744 \ud30c\uc77c\uc5d0 \uc791\uc131\ud569\ub2c8\ub2e4."}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"user"}),"\ub294 bundle\uc785\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"run"}),": \uc2e4\ud589\ub420 \uc2a4\ud06c\ub9bd\ud2b8\ub97c \uc791\uc131\ud569\ub2c8\ub2e4."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"dependencies.d"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"\ud574\ub2f9 \uc11c\ube44\uc2a4\uac00 \uc2e4\ud589\ub418\uae30 \uc804\uc5d0 \uc2e4\ud589\ub420 \uc11c\ube44\uc2a4 \ub9ac\uc2a4\ud2b8\ub97c \ud30c\uc77c\uba85\uc73c\ub85c \uc791\uc131\ud569\ub2c8\ub2e4."}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"base"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"\uc758\uc874\uc131\uc73c\ub85c \uac00\uc838\uc57c race condition\uc744 \ud53c\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.del,{children:"legacy-cont-init\uc774 \ubaa8\ub450 \uc2e4\ud589\ub41c \uc774\ud6c4\uc5d0 \uc2e4\ud589\ub418\ub3c4\ub85d \ud574\uc8fc\ub294 \uac83 \uac19\uc2b5\ub2c8\ub2e4."})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]})]})}function u(e={}){const{wrapper:s}={...(0,c.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>l,x:()=>t});var r=n(96540);const i={},c=r.createContext(i);function l(e){const s=r.useContext(c);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(c.Provider,{value:s},e.children)}}}]);