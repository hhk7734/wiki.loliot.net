(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[46261],{25591:(e,n,s)=>{"use strict";s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"mlops/kubernetes/network/service","title":"Service","description":"kubernetes service","source":"@site/docs/mlops/kubernetes/network/service.mdx","sourceDirName":"mlops/kubernetes/network","slug":"/mlops/kubernetes/network/service","permalink":"/docs/mlops/kubernetes/network/service","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/mlops/kubernetes/network/service.mdx","tags":[],"version":"current","lastUpdatedAt":1744914495000,"frontMatter":{"id":"service","title":"Service","sidebar_label":"Service","description":"kubernetes service","keywords":["kubernetes","service"]},"sidebar":"kubernetes","previous":{"title":"StatefulSet","permalink":"/docs/mlops/kubernetes/workloads/statefulset"},"next":{"title":"volumes","permalink":"/docs/mlops/kubernetes/storage/volumes"}}');var c=s(74848),i=s(28453),o=s(82331);const t={id:"service",title:"Service",sidebar_label:"Service",description:"kubernetes service",keywords:["kubernetes","service"]},l=void 0,d={},a=[{value:"Service",id:"service",level:2},{value:"FQDN",id:"fqdn",level:3},{value:"NodePort",id:"nodeport",level:3},{value:"Selector \uc5c6\uc774 Service \uc0dd\uc131",id:"selector-\uc5c6\uc774-service-\uc0dd\uc131",level:2},{value:"Debug",id:"debug",level:2},{value:"Reference",id:"reference",level:2}];function p(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.h2,{id:"service",children:"Service"}),"\n",(0,c.jsx)("center",{children:(0,c.jsx)(o.A,{img:s(36261),width:750})}),"\n",(0,c.jsx)("center",{children:(0,c.jsx)("strong",{children:"Deployment and Service"})}),"\n",(0,c.jsx)("br",{}),"\n",(0,c.jsx)(n.p,{children:"\uac01 Pod\ub294 \uace0\uc720\ud55c IP \uc8fc\uc18c\ub97c \uac16\uc2b5\ub2c8\ub2e4. \ud558\uc9c0\ub9cc Deployment\ub97c \uc0ac\uc6a9\ud558\uc5ec \uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc744 \ubc30\ud3ec\ud560 \ub54c, \ud55c \uc2dc\uc810\uc5d0 \uc2e4\ud589\ub418\ub294 Pod \uc9d1\ud569\uacfc \ub2e4\uc74c \uc2dc\uc810\uc5d0\uc11c \uc2e4\ud589\ub418\uace0 \uc788\ub294 Pod \uc9d1\ud569\uc774 \ub2e4\ub97c \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc774\ub7f0 \uc0c1\ud669\uc5d0\uc11c \ud574\ub2f9 Pod \uc9d1\ud569\uc744 \uc0ac\uc6a9\ud574\uc57c\ud558\ub294 \uc11c\ube44\uc2a4\uac00 \uc874\uc7ac\ud55c\ub2e4\uba74, \uc774 \ubcc0\ud654\ub97c \ucd94\uc801\ud574\uc57c\ud558\ub294 \ubb38\uc81c\uac00 \uc0dd\uae41\ub2c8\ub2e4. \uc774\ub7ec\ud55c \ubb38\uc81c\ub97c \ud574\uacb0\ud558\uae30 \uc704\ud574 Service \ub9ac\uc18c\uc2a4\uac00 \ud544\uc694\ud569\ub2c8\ub2e4."}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Service\nmetadata:\n  name: my-service\nspec:\n  type: ClusterIP # ClusterIP(default)|NodePort|LoadBalancer|ExternalName\n  selector: # selector\ub97c \uc0ac\uc6a9\ud558\uc9c0 \uc54a\uc73c\uba74 Endpoints\ub97c \uc0dd\uc131\ud558\uc5ec \uc218\ub3d9\uc73c\ub85c \ub9e4\ud551\n    app: my-app # Pod\uc758 label\uc5d0 \ud574\ub2f9 key: value \uac00 \uc788\ub294 \uac83\uc744 \uc120\ud0dd\n  ports:\n    - name: http\n      port: 8080 # service port\n      targetPort: 8080 # pod port. pod\uc5d0 port.name\uc744 \uc815\uc758\ud588\ub2e4\uba74 name\uc73c\ub85c \ub300\uccb4 \uac00\ub2a5\n      protocol: TCP # TCP(default)|UDP|SCTP|HTTP|PROXY\n"})}),"\n",(0,c.jsx)(n.admonition,{type:"info",children:(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"kubectl explain [--recursive] service[.<fieldName>]"})," \uc744 \ud1b5\ud574 \uc790\uc138\ud55c \uc124\uba85\uc744 \ubcfc \uc218 \uc788\uc2b5\ub2c8\ub2e4."]})}),"\n",(0,c.jsx)(n.h3,{id:"fqdn",children:"FQDN"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"<name>.<namespace>.svc.cluster.local"}),"\uc774 Kubernetes DNS\uc5d0 \ub4f1\ub85d\ub429\ub2c8\ub2e4."]}),"\n",(0,c.jsxs)(n.p,{children:["\ucee8\ud14c\uc774\ub108 \ub0b4\ubd80\uc5d0\uc11c Service\ub97c \ucc3e\uc744 \ub54c, ",(0,c.jsx)(n.code,{children:"<name>"}),", ",(0,c.jsx)(n.code,{children:"<name>.<namespace>"})," \ub4f1\uc744 \uc0ac\uc6a9\ud558\uc5ec \ucc3e\uc744 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc55e\uc758 \uc77c\ubd80\ub9cc \uc801\uc5c8\uc744 \ub54c, ",(0,c.jsx)(n.code,{children:"/etc/resolv.conf"})," \ud30c\uc77c\uc758 ",(0,c.jsx)(n.code,{children:"search"})," \uc635\uc158\uc5d0 \uc801\ud78c \uac12\uc744 \uae30\uc900\uc73c\ub85c \ud0d0\uc0c9\ud569\ub2c8\ub2e4."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",metastring:'title="/etc/resolv.conf"',children:"...\n\nsearch <namespace>.svc.cluster.local svc.cluster.local cluster.local us-west-2.compute.internal\n\n...\n"})}),"\n",(0,c.jsx)(n.h3,{id:"nodeport",children:"NodePort"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/services-networking/service/#type-nodeport",children:"https://kubernetes.io/docs/concepts/services-networking/service/#type-nodeport"})}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["NodePort\ub294 ",(0,c.jsx)(n.code,{children:"<nodeIP>:<nodePort>"})," -> ",(0,c.jsx)(n.code,{children:"<serviceIP>:<port>"})," -> ",(0,c.jsx)(n.code,{children:"<podIP>:<targetPort>"})," \uc5f0\uacb0\uc744 \ud1b5\ud574 \uc678\ubd80\uc5d0\uc11c pod\ub85c \uc811\uadfc \ud560 \uc218 \uc788\uac8c \ub9cc\ub4e4\uc5b4\uc8fc\ub294 \uc11c\ube44\uc2a4 \uc785\ub2c8\ub2e4. ",(0,c.jsx)(n.code,{children:"<nodeIP>"}),"\ub294 \ud074\ub7ec\uc2a4\ud130\uc5d0 \uc788\ub294 Node\ub77c\uba74 \uc5b4\ub290 Node\uc5d0\uc11c\ub4e0 \uc811\uadfc\uc774 \uac00\ub2a5\ud569\ub2c8\ub2e4."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Service\nspec:\n  type: NodePort\n  ports:\n    - port: 443\n      targetPort: 8443\n      # nodePort: <30000-32767> # \uc124\uc815\ud558\uc9c0 \uc54a\uc73c\uba74 \ud574\ub2f9 \ubc94\uc704\uc5d0\uc11c \ub79c\ub364\ud558\uac8c \uc120\ud0dd\n"})}),"\n",(0,c.jsxs)(n.p,{children:["NodePort\uc758 \ubc94\uc704\ub97c \ubcc0\uacbd\ud558\uace0 \uc2f6\uc740 \uacbd\uc6b0 kube-apiserver\uc758 ",(0,c.jsx)(n.code,{children:"--service-node-port-range=<startPort>-<endPort>"})," \uc635\uc158\uc744 \ucd94\uac00\ud558\uba74 \ub429\ub2c8\ub2e4."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-yaml",metastring:'title="/etc/kubernetes/manifests/kube-apiserver.yaml"',children:"spec:\n  containers:\n    - command:\n        - kube-apiserver\n        - ...\n        - --service-node-port-range=30000-32767\n        - ...\n"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.a,{href:"https://kubernetes.io/blog/2023/05/11/nodeport-dynamic-and-static-allocation/",children:"https://kubernetes.io/blog/2023/05/11/nodeport-dynamic-and-static-allocation/"})}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["Kubernetes 1.28 \ubd80\ud130\ub294 ServiceNodePortStaticSubrange\ub77c\ub294 \uae30\ub2a5\uc774 \uae30\ubcf8\uc801\uc73c\ub85c \ud65c\uc131\ud654 \ub429\ub2c8\ub2e4. \uc774 \uae30\ub2a5\uc740 NodePort\uc758 \uc2dc\uc791 \ud3ec\ud2b8 \ubd80\ud130 ",(0,c.jsx)(n.code,{children:"min(max(16, nodeportSize / 32), 128)"}),"\uac1c\uc758 \ud3ec\ud2b8\uc758 \ub3d9\uc801 \ud560\ub2f9 \uc6b0\uc120\uc21c\uc704\ub97c \ub0ae\ucda5\ub2c8\ub2e4. \uc608\ub97c \ub4e4\uc5b4 30000-32767\uc758 \ubc94\uc704\ub97c \uac16\ub294 \uacbd\uc6b0 30000-30085\uae4c\uc9c0\ub294 \ub2e4\ub978 \ud3ec\ud2b8\ub97c \ubaa8\ub450 \uc0ac\uc6a9\ud558\uae30 \uc804\uae4c\uc9c0\ub294 \ub3d9\uc801 \ud560\ub2f9\uc774 \ub418\uc9c0 \uc54a\uc73c\ubbc0\ub85c \uc0ac\uc6a9\uc790\uac00 \uc815\uc801 \ud560\ub2f9\uc73c\ub85c \uc0ac\uc6a9\ud558\uae30\uc5d0 \uc88b\uc2b5\ub2c8\ub2e4."]}),"\n",(0,c.jsx)(n.h2,{id:"selector-\uc5c6\uc774-service-\uc0dd\uc131",children:"Selector \uc5c6\uc774 Service \uc0dd\uc131"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Service\nmetadata:\n  name: <serviceName>\n  namespace: <namespace>\nspec:\n  ports:\n    - name: <portName>\n      port: <port>\n      targetPort: <targetPort>\n"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/services-networking/endpoint-slices/",children:"EndpointSlices"})}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-yaml",children:"apiVersion: discovery.k8s.io/v1\nkind: EndpointSlice\nmetadata:\n  name: <name>\n  namespace: <namespace>\n  labels:\n    kubernetes.io/service-name: <serviceName>\naddressType: <addressType>\nports:\n  - name: <portName>\n    appProtocol: <appProtocol>\n    protocol: TCP\n    port: <targetPort>\nendpoints:\n  - addresses:\n      - <IP>\n"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"addressType: <addressType>"}),": IPv4, IPv6, FQDN"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"ports"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"appProtocol: <appProtocol>"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"\uc5b4\ub5a4 \ud504\ub85c\ud1a0\ucf5c\uc744 \uc4f0\ub294\uc9c0\uc5d0 \ub300\ud55c \ud78c\ud2b8\uc785\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"endpoints"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"conditions"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"ready: <bool>"}),": Pod\uc758 Ready\uc640 \ub9e4\ud551\ub418\ub294 \uac12\uc73c\ub85c \uc678\ubd80 \uc8fc\uc18c\ub97c \uc124\uc815\ud55c \uacbd\uc6b0 \uc9c1\uc811 ",(0,c.jsx)(n.code,{children:"true"}),"\ub85c \uc124\uc815\ud574\uc57c \ud569\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"debug",children:"Debug"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"kubectl run tmp-shell --rm -it --image nicolaka/netshoot -- sh\n"})}),"\n",(0,c.jsx)(n.h2,{id:"reference",children:"Reference"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.a,{href:"https://kubernetes.io/ko/docs/concepts/services-networking/service/",children:"https://kubernetes.io/ko/docs/concepts/services-networking/service/"})}),"\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.a,{href:"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#service-v1-core",children:"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#service-v1-core"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(p,{...e})}):p(e)}},36261:(e,n,s)=>{e.exports={src:Object.assign(Object.create({toString(){return this.src}}),{srcSet:s.p+"assets/ideal-img/service.4b1bf24.750.jpg 750w",images:[{path:s.p+"assets/ideal-img/service.4b1bf24.750.jpg",width:750,height:556}],src:s.p+"assets/ideal-img/service.4b1bf24.750.jpg",placeholder:void 0,width:750,height:556}),preSrc:"data:image/jpeg;base64,/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAAHAAoDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAUI/8QAIBAAAQMDBQEAAAAAAAAAAAAAAQACAxESIQQFEzFRgf/EABQBAQAAAAAAAAAAAAAAAAAAAAL/xAAXEQADAQAAAAAAAAAAAAAAAAAAAQIx/9oADAMBAAIRAxEAPwDRW7AnUcZoWSzRtkAFLm2nBznrwfVdEbQAKIiVPAo//9k="}}}]);