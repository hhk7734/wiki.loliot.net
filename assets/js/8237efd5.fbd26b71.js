"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[2539],{15945:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>c,default:()=>a,frontMatter:()=>d,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"mlops/kubernetes/security/audit","title":"Kubernetes Audit \uc815\ucc45 \uc124\uc815\ud558\uae30","description":"Kubernetes Audit \uc815\ucc45 \uc124\uc815\ud558\uae30","source":"@site/docs/mlops/kubernetes/security/audit.mdx","sourceDirName":"mlops/kubernetes/security","slug":"/mlops/kubernetes/security/audit","permalink":"/docs/mlops/kubernetes/security/audit","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/mlops/kubernetes/security/audit.mdx","tags":[],"version":"current","lastUpdatedAt":1746033570000,"frontMatter":{"id":"audit","title":"Kubernetes Audit \uc815\ucc45 \uc124\uc815\ud558\uae30","sidebar_label":"Audit \uc815\ucc45 \uc124\uc815","description":"Kubernetes Audit \uc815\ucc45 \uc124\uc815\ud558\uae30","keywords":["kubernetes","audit"]},"sidebar":"kubernetes","previous":{"title":"SecurityContext","permalink":"/docs/mlops/kubernetes/security/security-context"},"next":{"title":"Affinity","permalink":"/docs/mlops/kubernetes/scheduling/affinity"}}');var r=s(74848),l=s(28453);const d={id:"audit",title:"Kubernetes Audit \uc815\ucc45 \uc124\uc815\ud558\uae30",sidebar_label:"Audit \uc815\ucc45 \uc124\uc815",description:"Kubernetes Audit \uc815\ucc45 \uc124\uc815\ud558\uae30",keywords:["kubernetes","audit"]},c=void 0,t={},o=[{value:"Audit(\uac10\uc0ac)",id:"audit\uac10\uc0ac",level:2},{value:"Audit \uc815\ucc45",id:"audit-\uc815\ucc45",level:2},{value:"log \ubc31\uc5d4\ub4dc \uc124\uc815",id:"log-\ubc31\uc5d4\ub4dc-\uc124\uc815",level:2}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"audit\uac10\uc0ac",children:"Audit(\uac10\uc0ac)"}),"\n",(0,r.jsx)(n.p,{children:"Audit \uae30\ub85d\uc740 \ub204\uac00 \ubb34\uc5c7\uc744 \uc5b8\uc81c \uc5b4\ub514\uc11c \uc694\uccad\ud588\ub294\uc9c0, \uadf8\ub9ac\uace0 \uadf8 \uc694\uccad\uc774 \uc5b4\ub5bb\uac8c \ucc98\ub9ac\ub418\uc5c8\ub294\uc9c0\ub97c \uc54c \uc218 \uc788\ub3c4\ub85d \uc2dc\uac04\uc21c\uc73c\ub85c \uc815\ub9ac\ud55c \uac83\uc785\ub2c8\ub2e4."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"kube-apiserver"}),"\ub294 Audit \uc815\ucc45 \uc124\uc815\uc5d0 \ub530\ub77c Audit \uc774\ubca4\ud2b8\ub97c \uc804\ucc98\ub9ac\ud55c \ud6c4 \uc124\uc815\ub41c \ubc31\uc5d4\ub4dc\uc5d0 \uc800\uc7a5\ud569\ub2c8\ub2e4. \ud604\uc7ac\ub294 ",(0,r.jsx)(n.strong,{children:"log"}),"\uc640 ",(0,r.jsx)(n.strong,{children:"webhook"})," \ubc31\uc5d4\ub4dc\ub9cc \uc9c0\uc6d0\ud569\ub2c8\ub2e4."]}),"\n",(0,r.jsx)(n.h2,{id:"audit-\uc815\ucc45",children:"Audit \uc815\ucc45"}),"\n",(0,r.jsx)(n.admonition,{title:"Reference",type:"info",children:(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/debug/debug-cluster/audit/",children:"Kubernetes / Docs / Auditing"})}),"\n"]})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"apiVersion: audit.k8s.io/v1\nkind: Policy\n# omitStages: []\n# omitManagedFields: false\nrules:\n  - level: <level>\n    users: [<user>]\n    userGroups: [<userGroup>]\n    omitStages: []\n    resources:\n      - group: <group>\n        resources: [<resource>]\n        resourceNames: [<resourceName>]\n    verbs: [<verb>]\n    namespaces: [<namespace>]\n    nonResourceURLs: [<nonResourceURL>]\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"omitStages: []"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\uc0dd\ub7b5\ud558\uac70\ub098 ",(0,r.jsx)(n.code,{children:"[]"}),"\ub85c \uc124\uc815\ud558\uba74 \uc801\uc6a9\ub418\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"RequestReceived"}),": request\ub294 \ubc1b\uc558\uc9c0\ub9cc \ucc98\ub9ac\ud558\uc9c0 \uc54a\uc740 \uc0c1\ud0dc\uc785\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ResponseStarted"}),": response header\ub294 \ubcf4\ub0c8\uc9c0\ub9cc body\uc740 \ubcf4\ub0b4\uc9c0 \uc54a\uc740 \uc0c1\ud0dc\ub85c watch \uac19\uc740 long-running task\uc5d0\ub9cc \uc0ac\uc6a9\ub429\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ResponseComplete"}),": response body\uc744 \ubaa8\ub450 \ubcf4\ub0b8 \uc0c1\ud0dc\uc785\ub2c8\ub2e4."]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"Panic"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"omitManagedFields: false"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"true"}),"\ub85c \uc124\uc815\ud558\uba74 managedFields\ub97c \uae30\ub85d\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"false"}),"\ub85c \uc124\uc815\ud558\uba74 managedFields\ub97c \uae30\ub85d\ud569\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"rules: []"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\uc120\uc5b8 \uc21c\uc11c\uc5d0 \ub9de\ucdb0 Audit \uc774\ubca4\ud2b8\ub97c \ub9e4\uce6d\uc2dc\ucf1c\ubcf4\uace0 \uccab \ubc88\uc9f8\ub85c \ub9e4\uce6d\ub418\ub294 \uaddc\uce59\uc5d0 \ub530\ub77c Audit \uc774\ubca4\ud2b8\ub97c \ucc98\ub9ac\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"level: <level>"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"None"}),": \ub9e4\uce6d\ub418\ub294 \uc774\ubca4\ud2b8\ub97c \uae30\ub85d\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Metadata"}),": user, timestamp, resource, verb \ub4f1\ub9cc \uae30\ub85d\ud569\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Request"}),": request metadata\uc640 body\ub9cc \uae30\ub85d\ud569\ub2c8\ub2e4. non-resource request\ub294 \uae30\ub85d\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"RequestResponse"}),": request metadata\uc640 body, response body\ub97c \uae30\ub85d\ud569\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"users: []"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\uc0dd\ub7b5\ud558\uac70\ub098 ",(0,r.jsx)(n.code,{children:"[]"}),"\ub85c \uc124\uc815\ud558\uba74 \ubaa8\ub4e0 user\uc5d0 \ub300\ud574 \ub9e4\uce6d\ub429\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"userGroups: []"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\uc0dd\ub7b5\ud558\uac70\ub098 ",(0,r.jsx)(n.code,{children:"[]"}),"\ub85c \uc124\uc815\ud558\uba74 \ubaa8\ub4e0 userGroup\uc5d0 \ub300\ud574 \ub9e4\uce6d\ub429\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"verb: []"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\uc0dd\ub7b5\ud558\uac70\ub098 ",(0,r.jsx)(n.code,{children:"[]"}),"\ub85c \uc124\uc815\ud558\uba74 \ubaa8\ub4e0 verb\uc5d0 \ub300\ud574 \ub9e4\uce6d\ub429\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"resources: []"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\uc120\uc5b8\ud558\uc5b8\uc9c0 \uc54a\uac70\ub098 ",(0,r.jsx)(n.code,{children:"[]"}),"\ub85c \uc124\uc815\ud558\uba74 \ubaa8\ub4e0 resource\uc5d0 \ub300\ud574 \ub9e4\uce6d\ub429\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"group: <group>"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\uc0dd\ub7b5\ud558\uac70\ub098 ",(0,r.jsx)(n.code,{children:'""'}),"\ub85c \uc124\uc815\ud558\uba74 core API group\uc744 \uc758\ubbf8\ud569\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"resources: []"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\uc0dd\ub7b5, ",(0,r.jsx)(n.code,{children:"[]"}),", ",(0,r.jsx)(n.code,{children:'["*"]'}),"\ub85c \uc124\uc815\ud558\uba74 \ubaa8\ub4e0 resource\uc640 subresources \ub300\ud574 \ub9e4\uce6d\ub429\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"pods"}),"\uc740 pods resource\ub9cc \uc758\ubbf8\ud558\uba70 subresource\ub97c \ud3ec\ud568\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"pods/*"}),"\uc740 pods\uc758 \ubaa8\ub4e0 subresource\ub97c \uc758\ubbf8\ud569\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"*/scale"}),"\uc740 \ubaa8\ub4e0 resource\uc758 scale subresource\ub97c \uc758\ubbf8\ud569\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"resourceNames: []"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\uc0dd\ub7b5\ud558\uac70\ub098 ",(0,r.jsx)(n.code,{children:"[]"}),"\ub85c \uc124\uc815\ud558\uba74 \ubaa8\ub4e0 resourceName\uc5d0 \ub300\ud574 \ub9e4\uce6d\ub429\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"namespaces: []"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\uc0dd\ub7b5\ud558\uac70\ub098 ",(0,r.jsx)(n.code,{children:"[]"}),"\ub85c \uc124\uc815\ud558\uba74 \ubaa8\ub4e0 namespace\uc5d0 \ub300\ud574 \ub9e4\uce6d\ub429\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'""'}),"\uc740 non-namespaced resource\ub97c \uc758\ubbf8\ud569\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"nonResourceURLs: []"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"*"}),"\uc744 \uc4f8 \uc218 \uc788\uc9c0\ub9cc \ub9c8\uc9c0\ub9c9\uc5d0\ub9cc \uc368\uc57c\ud569\ub2c8\ub2e4.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["e.g., ",(0,r.jsx)(n.code,{children:"/healthz*"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"omitStages: []"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\uc0dd\ub7b5\ud558\uac70\ub098 ",(0,r.jsx)(n.code,{children:"[]"}),"\ub85c \uc124\uc815\ud558\uba74 \uc801\uc6a9\ub418\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:".omitStages"}),"\uc640\uc758 \ud569\uc9d1\ud569\uc73c\ub85c \uc801\uc6a9\ub429\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"omitManagedFields: false"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"true"}),"\ub85c \uc124\uc815\ud558\uba74 managedFields\ub97c \uae30\ub85d\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"false"}),"\ub85c \uc124\uc815\ud558\uba74 managedFields\ub97c \uae30\ub85d\ud569\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:["\uc0dd\ub7b5\ud558\uba74 ",(0,r.jsx)(n.code,{children:".omitManagedFields"})," \uc124\uc815\uc744 \ub530\ub985\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"log-\ubc31\uc5d4\ub4dc-\uc124\uc815",children:"log \ubc31\uc5d4\ub4dc \uc124\uc815"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="/etc/kubernetes/kubeadm-config.yaml"',children:'apiVersion: kubeadm.k8s.io/v1beta4\nkind: ClusterConfiguration\napiServer:\n  extraArgs:\n    - name: audit-policy-file\n      value: /etc/kubernetes/audit-policy/apiserver-audit-policy.yaml\n    - name: audit-log-path\n      value: /var/log/audit/kube-apiserver-audit.log\n    - name: audit-log-maxage\n      value: "30"\n    - name: audit-log-maxbackup\n      value: "10"\n    - name: audit-log-maxsize\n      value: "100"\n  extraVolumes:\n    - name: audit-policy\n      hostPath: /etc/kubernetes/audit-policy\n      mountPath: /etc/kubernetes/audit-policy\n    - name: audit-logs\n      hostPath: /var/log/kubernetes/audit/\n      mountPath: /var/log/audit/\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"--audit-log-maxage=<days>"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"--audit-log-maxbackup=<number>"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"--audit-log-maxsize=<MB>"})}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\ubcc0\uacbd \ud6c4 ",(0,r.jsx)(n.a,{href:"/docs/mlops/kubernetes/tools/kubeadm/control-plane",children:"Kubeadm\uc73c\ub85c Control Plane \uad00\ub9ac\ud558\uae30"}),"\ub97c \ucc38\uace0\ud558\uc5ec kube-apiserver\ub97c \uc7ac\uc2dc\uc791\ud569\ub2c8\ub2e4."]})]})}function a(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>c});var i=s(96540);const r={},l=i.createContext(r);function d(e){const n=i.useContext(l);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);