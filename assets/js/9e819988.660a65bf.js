"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[51730],{28453:(e,n,i)=>{i.d(n,{R:()=>c,x:()=>t});var r=i(96540);const l={},s=r.createContext(l);function c(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:c(e.components),r.createElement(s.Provider,{value:n},e.children)}},68679:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>t,default:()=>u,frontMatter:()=>c,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"mlops/serving/gateway-api-inference-extension/endpoint-picker","title":"Gateway API Inference Extension (GIE) EndPoint Picker (EPP)","description":"Gateway API Inference Extension (GIE) EndPoint Picker (EPP)","source":"@site/docs/mlops/serving/gateway-api-inference-extension/endpoint-picker.mdx","sourceDirName":"mlops/serving/gateway-api-inference-extension","slug":"/mlops/serving/gateway-api-inference-extension/endpoint-picker","permalink":"/docs/mlops/serving/gateway-api-inference-extension/endpoint-picker","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/mlops/serving/gateway-api-inference-extension/endpoint-picker.mdx","tags":[],"version":"current","lastUpdatedAt":1754585922000,"frontMatter":{"id":"endpoint-picker","title":"Gateway API Inference Extension (GIE) EndPoint Picker (EPP)","sidebar_label":"EndPoint Picker (EPP)","description":"Gateway API Inference Extension (GIE) EndPoint Picker (EPP)","keywords":["Gateway API","Inference Extension","Endpoint Picker"]},"sidebar":"serving","previous":{"title":"\uc124\uce58 \uac00\uc774\ub4dc","permalink":"/docs/mlops/serving/gateway-api-inference-extension/"},"next":{"title":"\ub77c\uc6b0\ud305 \uad00\ub9ac\ud558\uae30","permalink":"/docs/mlops/serving/gateway-api-inference-extension/route"}}');var l=i(74848),s=i(28453);const c={id:"endpoint-picker",title:"Gateway API Inference Extension (GIE) EndPoint Picker (EPP)",sidebar_label:"EndPoint Picker (EPP)",description:"Gateway API Inference Extension (GIE) EndPoint Picker (EPP)",keywords:["Gateway API","Inference Extension","Endpoint Picker"]},t=void 0,d={},o=[{value:"Scheduler",id:"scheduler",level:2},{value:"EndpointPickerConfig",id:"endpointpickerconfig",level:2},{value:"\uc124\uc815",id:"\uc124\uc815",level:3},{value:"\uae30\ubcf8 Plugin Type",id:"\uae30\ubcf8-plugin-type",level:3}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",mermaid:"mermaid",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.mermaid,{value:"flowchart TD\n  C[Client] -- 1\ufe0f\u20e3 request --\x3e E[Envoy]\n  E -- 2\ufe0f\u20e3 request --\x3e EPP[Endpoint Picker]\n  EPP -- 3\ufe0f\u20e3 request + routingHint --\x3e E\n  E -- 4\ufe0f\u20e3 request --\x3e DW1[Decode Worker]\n  EPP -.- IP\n  IP@{ shape: card, label: InferencePool } -.- DW1\n  IP -.- DW2[Decode Worker]\n  IP -.- PW[Prefill Worker]"}),"\n",(0,l.jsx)(n.h2,{id:"scheduler",children:"Scheduler"}),"\n",(0,l.jsx)(n.mermaid,{value:"sequenceDiagram\n  participant E as Envoy\n  participant EPP as Endpoint Picker\n  participant D as Dialector\n  participant S as Scheduler\n  participant PH as ProfileHandler\n\n  E ->> EPP: 2\ufe0f\u20e3 request\n  EPP ->> D: HandleRequest()\n  D ->> S: Schedule()\n\n  loop\n    S ->> PH: Pick()\n    PH --\x3e> S: []SchedulerProfile\n\n    create participant SP as SchedulerProfile\n    S ->> SP: Run()\n    SP ->> SP: runFilterPlugins()\n    SP ->> SP: runScorerPlugins()\n    SP ->> SP: runPickerPlugin()\n    destroy SP\n    SP --\x3e> S: ProfileRunResult\n  end\n\n  S ->> PH: ProcessResults()\n  PH --\x3e> S: SchedulingResult\n  S --\x3e D: SchedulingResult\n  D ->> D: prepareRequest(), runPreRequestPlugins()\n  D --\x3e> EPP: RequestContext\n  EPP --\x3e> E: 3\ufe0f\u20e3 request + routingHint"}),"\n",(0,l.jsx)(n.h2,{id:"endpointpickerconfig",children:"EndpointPickerConfig"}),"\n",(0,l.jsx)(n.admonition,{title:"Reference",type:"info",children:(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://gateway-api-inference-extension.sigs.k8s.io/guides/epp-configuration/config-text/",children:"GIE / Guides / Configuring Plugins via text"})}),"\n"]})}),"\n",(0,l.jsx)(n.h3,{id:"\uc124\uc815",children:"\uc124\uc815"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"apiVersion: inference.networking.x-k8s.io/v1alpha1\nkind: EndpointPickerConfig\nplugins:\n  - name: <name>\n    type: <type>\n    parameters:\n      <key>: <value>\nschedulingProfiles:\n  - name: <name>\n    plugins:\n      - pluginRef: <pluginName>\n        weight: <weight>\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"plugins: []"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["SchedulerProfile\uc5d0 \ub4f1\ub85d\ud560 ",(0,l.jsx)(n.strong,{children:"FilterPlugin"}),", ",(0,l.jsx)(n.strong,{children:"ScorerPlugin"}),", ",(0,l.jsx)(n.strong,{children:"PickerPlugin"}),"\uacfc ",(0,l.jsx)(n.strong,{children:"ProfileHandler"}),", ",(0,l.jsx)(n.strong,{children:"PreRequestPlugin"}),", ",(0,l.jsx)(n.strong,{children:"PostRequestPlugin"}),"\uc744 \uc124\uc815\ud569\ub2c8\ub2e4."]}),"\n",(0,l.jsx)(n.li,{children:"ProfileHandler\ub294 \ubc18\ub4dc\uc2dc \ud558\ub098\ub9cc \uc124\uc815\ud574\uc57c \ud569\ub2c8\ub2e4."}),"\n",(0,l.jsx)(n.li,{children:"\uc124\uc815\ud55c PreRequestPlugin\uacfc PostRequestPlugin\uc740 \ubaa8\ub450 \uc2e4\ud589\ub429\ub2c8\ub2e4."}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"name: <name>"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\uc124\uc815\ud558\uc9c0 \uc54a\uc73c\uba74 ",(0,l.jsx)(n.code,{children:"type"}),"\uc774 \uc0ac\uc6a9\ub429\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"type: <type>"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"EPP\uc5d0 \ub4f1\ub85d\ub41c plugin type \uc911 \ud558\ub098\ub97c \uc9c0\uc815\ud569\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"parameters"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"plugin\uc5d0 \uc804\ub2ec\ud560 \ud30c\ub77c\ubbf8\ud130\ub97c \uc124\uc815\ud569\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"schedulingProfiles: []"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"name: <name>"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"scheduler\uac00 \uc0ac\uc6a9\ud560 profile \uc774\ub984\uc744 \uc124\uc815\ud569\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"plugins: []"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["scheduler\uac00 \uc0ac\uc6a9\ud560 ",(0,l.jsx)(n.strong,{children:"FilterPlugin"}),", ",(0,l.jsx)(n.strong,{children:"ScorerPlugin"}),", ",(0,l.jsx)(n.strong,{children:"PickerPlugin"}),"\uc744 \uc124\uc815\ud569\ub2c8\ub2e4."]}),"\n",(0,l.jsx)(n.li,{children:"PickerPlugin\uc740 \ubc18\ub4dc\uc2dc \ud558\ub098\ub9cc \uc124\uc815\ud574\uc57c \ud569\ub2c8\ub2e4."}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"pluginRef: <pluginName>"})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"weight: 1"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"plugin\uc774 scorer\uc77c \ub54c \uc0ac\uc6a9\ub418\ub294 \uac00\uc911\uce58\uc785\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"\uae30\ubcf8-plugin-type",children:"\uae30\ubcf8 Plugin Type"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["ProfileHandler","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"single-profile-handler"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"FilterPlugin"}),"\n",(0,l.jsxs)(n.li,{children:["ScorerPlugin","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"prefix-cache-scorer"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"hashBlockSize: 64"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"maxPrefixBlocksToMatch: 256"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"lruCapacityPerServer: 31250"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"lora-affinity-scorer"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"kv-cache-utilization-scorer"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"queue-scorer"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"lora-affinity-scorer"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["PickerPlugin","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"max-score-picker"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"maxNumOfEndpoints: 1"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"random-picker"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"maxNumOfEndpoints: 1"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"PreRequestPlugin"}),"\n",(0,l.jsx)(n.li,{children:"PostRequestPlugin"}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}}}]);