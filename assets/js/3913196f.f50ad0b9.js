"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[88209],{16595:(e,n,c)=>{c.r(n),c.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"mlops/storage/ceph/object-gateway","title":"Ceph Object Gateway, S3 \ud638\ud658 Object Storage","description":"Ceph Object Gateway, S3 \ud638\ud658 Object Storage","source":"@site/docs/mlops/storage/ceph/object-gateway.mdx","sourceDirName":"mlops/storage/ceph","slug":"/mlops/storage/ceph/object-gateway","permalink":"/docs/mlops/storage/ceph/object-gateway","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/mlops/storage/ceph/object-gateway.mdx","tags":[],"version":"current","lastUpdatedAt":1758994254000,"frontMatter":{"id":"object-gateway","title":"Ceph Object Gateway, S3 \ud638\ud658 Object Storage","sidebar_label":"Object Storage","description":"Ceph Object Gateway, S3 \ud638\ud658 Object Storage","keywords":["ceph","object gateway","object storage"]},"sidebar":"storage","previous":{"title":"Block Device","permalink":"/docs/mlops/storage/ceph/rbd"},"next":{"title":"Provisioning","permalink":"/docs/mlops/storage/ceph/provisioning"}}');var t=c(74848),o=c(28453);const i={id:"object-gateway",title:"Ceph Object Gateway, S3 \ud638\ud658 Object Storage",sidebar_label:"Object Storage",description:"Ceph Object Gateway, S3 \ud638\ud658 Object Storage",keywords:["ceph","object gateway","object storage"]},r=void 0,l={},a=[{value:"Operator \uc124\uc815",id:"operator-\uc124\uc815",level:2},{value:"CephObjectStore \uc0dd\uc131",id:"cephobjectstore-\uc0dd\uc131",level:2},{value:"Local Object Store",id:"local-object-store",level:3},{value:"External Object Store",id:"external-object-store",level:3},{value:"StorageClass \uc0dd\uc131",id:"storageclass-\uc0dd\uc131",level:2},{value:"ObjectBucketClaim \uc0dd\uc131",id:"objectbucketclaim-\uc0dd\uc131",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"operator-\uc124\uc815",children:"Operator \uc124\uc815"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="rook-ceph-values.yaml"',children:"rbacAggregate:\n  enableOBCs: true\n"})}),"\n",(0,t.jsx)(n.h2,{id:"cephobjectstore-\uc0dd\uc131",children:"CephObjectStore \uc0dd\uc131"}),"\n",(0,t.jsx)(n.admonition,{title:"Reference",type:"info",children:(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://rook.io/docs/rook/latest-release/Storage-Configuration/Object-Storage-RGW/object-storage/",children:"Rook / Object Storage Overview"})}),"\n"]})}),"\n",(0,t.jsx)(n.h3,{id:"local-object-store",children:"Local Object Store"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: ceph.rook.io/v1\nkind: CephObjectStore\nspec:\n  metadataPool:\n  dataPool:\n  gateway:\n    port: 9000\n    instances: 1\n    priorityClassName: system-cluster-critical\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"metadataPool"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"failureDomain: <crushType|osd>"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\uae30\ubcf8 \uac12\uc740 ",(0,t.jsx)(n.code,{children:"host"}),"\uc785\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"replicated"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"size: <size>"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"dataPool"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"failureDomain: <crushType|osd>"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\uae30\ubcf8 \uac12\uc740 ",(0,t.jsx)(n.code,{children:"host"}),"\uc785\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"replicated"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"size: <size>"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"gateway"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"port: <port>"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"instances: <replicas>"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"resources"})}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"placement"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"nodeAffinity"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"podAffinity"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"podAntiAffinity"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"tolerations"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"topologySpreadConstraints"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"external-object-store",children:"External Object Store"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: ceph.rook.io/v1\nkind: CephObjectStore\nspec:\n  gateway:\n    port: 9000\n    externalRgwEndpoints:\n      - ip: <objectStoreIP>\n        # hostname: <objectStoreHostname>\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"gateway"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"port: <port>"})}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"externalRgwEndpoints: []"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"ip \ub610\ub294 hostname\uc744 \uc9c0\uc815\ud569\ub2c8\ub2e4."}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"ip: <objectStoreIP>"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"hostname: <objectStoreHostname>"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"externalRgwEndpoints"}),"\uc758 \uccab\ubc88\uc9f8 ip \ub610\ub294 hostname\uc744 \ucc38\uc870\ud558\ub294 \ub9ac\uc18c\uc2a4\ub4e4\uc774 \ub9ce\uc73c\ubbc0\ub85c, Provider Storage Cluster\uc5d0 Object Store\uc5d0 \ub300\ud55c LoadBalancer \ub610\ub294 NodePort \ud0c0\uc785\uc758 Service\ub97c \ub9cc\ub4e4\uc5b4\uc11c \ud558\ub098\ub9cc \uc124\uc815\ud558\ub294 \uac83\uc744 \uad8c\uc7a5\ud569\ub2c8\ub2e4."]})}),"\n",(0,t.jsx)(n.h2,{id:"storageclass-\uc0dd\uc131",children:"StorageClass \uc0dd\uc131"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: storage.k8s.io/v1\nkind: StorageClass\nprovisioner: <cephClusterNamespace>.ceph.rook.io/bucket\nvolumeBindingMode: Immediate\nreclaimPolicy: Delete\nparameters:\n  objectStoreName: <cephObjectStoreName>\n  objectStoreNamespace: <cephObjectStoreNamespace>\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsxs)(n.p,{children:["\ubb38\uc11c\uc0c1\uc5d0 ",(0,t.jsx)(n.code,{children:"provisioner"}),"\ub85c ",(0,t.jsx)(n.code,{children:"<operatorNamespace>.ceph.rook.io/bucket"}),"\uc744 \uc0ac\uc6a9\ud558\ub77c\uace0 \ub418\uc5b4 \uc788\uc9c0\ub9cc, ",(0,t.jsx)(n.code,{children:"<cephClusterNamespace>.ceph.rook.io/bucket"}),"\uc744 \uc0ac\uc6a9\ud574\uc57c \uc791\ub3d9\ud569\ub2c8\ub2e4."]})}),"\n",(0,t.jsx)(n.h2,{id:"objectbucketclaim-\uc0dd\uc131",children:"ObjectBucketClaim \uc0dd\uc131"}),"\n",(0,t.jsx)(n.admonition,{title:"Reference",type:"info",children:(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://rook.io/docs/rook/latest-release/Storage-Configuration/Object-Storage-RGW/object-storage/",children:"Rook / Object Storage / Overview"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://rook.io/docs/rook/latest-release/Storage-Configuration/Object-Storage-RGW/ceph-object-bucket-claim/",children:"Rook / Object Storage / Bucket Claim"})}),"\n"]})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Secret\nmetadata:\n  name: rgw-admin-ops-user\n  namespace: <cephClusterNamespace>\ntype: kubernetes.io/rook\ndata:\n  accessKey: <accessKey | base64>\n  secretKey: <secretKey | base64>\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: objectbucket.io/v1alpha1\nkind: ObjectBucketClaim\nspec:\n  generateBucketName: <bucketNamePrefix>\n  storageClassName: <storageClassName>\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"bucketName: <bucketName>"})}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"generateBucketName: <bucketNamePrefix>"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\ub3d9\uc77c\ud55c bucketName\uc5d0 \ub300\ud55c \ucda9\ub3cc\uc744 \ubc29\uc9c0\ud558\ub824\ub294 \uacbd\uc6b0 \uad8c\uc7a5\ub429\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"storageClassName: <storageClassName>"})}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"additionalConfig"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:'maxObjects: "1000"'})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:'maxSize: "2G"'})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.admonition,{type:"info",children:[(0,t.jsxs)(n.p,{children:["ObjectBucketClaim namespace\uc640 name\uc774 \ub3d9\uc77c\ud55c ConfigMap, Secret\uc774 \uc0dd\uc131\ub429\ub2c8\ub2e4. ConfigMap\uc5d0\ub294 ",(0,t.jsx)(n.code,{children:"BUCKET_HOST"}),", ",(0,t.jsx)(n.code,{children:"BUCKET_NAME"}),", ",(0,t.jsx)(n.code,{children:"BUCKET_PORT"}),", ",(0,t.jsx)(n.code,{children:"BUCKET_REGION"}),", ",(0,t.jsx)(n.code,{children:"BUCKET_SUBREGION"}),"\uc774 \uc800\uc7a5\ub418\uc5b4 \uc788\uace0, Secret\uc5d0\ub294 ",(0,t.jsx)(n.code,{children:"AWS_ACCESS_KEY_ID"}),", ",(0,t.jsx)(n.code,{children:"AWS_SECRET_ACCESS_KEY"}),"\uac00 \uc800\uc7a5\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4."]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Pod\nspec:\n  containers:\n    - name: s5cmd\n      image: docker.io/peakcom/s5cmd:v2.3.0\n      imagePullPolicy: IfNotPresent\n      command: [sleep, infinity]\n      envFrom:\n        - secretRef:\n            name: <objectBucketClaimName>\n        - configMapRef:\n            name: <objectBucketClaimName>\n"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"/s5cmd --endpoint-url http://$BUCKET_HOST:$BUCKET_PORT ls\n"})})]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,n,c)=>{c.d(n,{R:()=>i,x:()=>r});var s=c(96540);const t={},o=s.createContext(t);function i(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);