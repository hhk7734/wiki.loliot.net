"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[712],{28182:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>l,toc:()=>a});const l=JSON.parse('{"id":"mlops/kubernetes/workloads/horizontalpodautoscaler","title":"Kubernetes HorizontalPodAutoscaler \uac00\uc774\ub4dc","description":"Kubernetes HorizontalPodAutoscaler \uac00\uc774\ub4dc","source":"@site/docs/mlops/kubernetes/workloads/horizontalpodautoscaler.mdx","sourceDirName":"mlops/kubernetes/workloads","slug":"/mlops/kubernetes/workloads/horizontalpodautoscaler","permalink":"/docs/mlops/kubernetes/workloads/horizontalpodautoscaler","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/mlops/kubernetes/workloads/horizontalpodautoscaler.mdx","tags":[],"version":"current","lastUpdatedAt":1760456564000,"frontMatter":{"id":"horizontalpodautoscaler","title":"Kubernetes HorizontalPodAutoscaler \uac00\uc774\ub4dc","sidebar_label":"HorizontalPodAutoscaler","description":"Kubernetes HorizontalPodAutoscaler \uac00\uc774\ub4dc","keywords":["kubernetes","horizontalpodautoscaler"]},"sidebar":"kubernetes","previous":{"title":"StatefulSet","permalink":"/docs/mlops/kubernetes/workloads/statefulset"},"next":{"title":"Service","permalink":"/docs/mlops/kubernetes/network/service"}}');var s=i(74848),r=i(28453);const o={id:"horizontalpodautoscaler",title:"Kubernetes HorizontalPodAutoscaler \uac00\uc774\ub4dc",sidebar_label:"HorizontalPodAutoscaler",description:"Kubernetes HorizontalPodAutoscaler \uac00\uc774\ub4dc",keywords:["kubernetes","horizontalpodautoscaler"]},c=void 0,d={},a=[{value:"Control Plane \uc124\uc815",id:"control-plane-\uc124\uc815",level:2},{value:"HorizontalPodAutoscaler",id:"horizontalpodautoscaler",level:2},{value:"Specification",id:"specification",level:3},{value:"Algorithm",id:"algorithm",level:3},{value:"Default Behavior",id:"default-behavior",level:3}];function t(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.admonition,{title:"Reference",type:"info",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/",children:"Kubernetes Docs / Tasks / Run Applications / Horizontal Pod Autoscaling"})}),"\n"]})}),"\n",(0,s.jsx)(n.h2,{id:"control-plane-\uc124\uc815",children:"Control Plane \uc124\uc815"}),"\n",(0,s.jsx)(n.admonition,{title:"Reference",type:"info",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/",children:"Kubernetes Docs / Reference / kube-controller-manager"})}),"\n"]})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["kube-controller-manager","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"--horizontal-pod-autoscaler-sync-period 15s"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"metric\uc744 \uc5c5\ub370\uc774\ud2b8\ud558\ub294 \uc8fc\uae30\uc785\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"--horizontal-pod-autoscaler-cpu-initialization-period 5m"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"--horizontal-pod-autoscaler-initial-readiness-delay 30s"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"--horizontal-pod-autoscaler-downscale-stabilization 5m"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"--horizontal-pod-autoscaler-tolerance 0.1"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"horizontalpodautoscaler",children:"HorizontalPodAutoscaler"}),"\n",(0,s.jsx)(n.h3,{id:"specification",children:"Specification"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: autoscaling/v2\nkind: HorizontalPodAutoscaler\nspec:\n  scaleTargetRef:\n    name: <name>\n  maxReplicas: 10\n  metrics: []\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"scaleTargetRef"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\uac19\uc740 Namespace\uc5d0 \uc874\uc7ac\ud558\ub294 \ub9ac\uc18c\uc2a4\uc5ec\uc57c \ud569\ub2c8\ub2e4."}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"apiVersion: <apiVersion>"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"kind: <kind>"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"name: <name>"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"minReplicas: 1"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"maxReplicas: <int>"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"metrics: []"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"type: Resource|ContainerResource|External|Object|Pods"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"resource"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"name: cpu|memory"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"target"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"type: Utilization|Value|AverageValue"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"containerResource"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"container: <containerName>"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"name: cpu|memory"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"target"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"type: Utilization|Value|AverageValue"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"external"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/docs/mlops/provisioning/keda/crd",children:"KEDA CRD \uac00\uc774\ub4dc"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"metric"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"target"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"type: Value|AverageValue"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"object"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"pods"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"behavior"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/kubernetes/enhancements/blob/master/keps/sig-autoscaling/853-configurable-hpa-scale-velocity/README.md",children:"kubernetes/enhancements GitHub / Configurable scale up/down velocity for HPA"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"scaleUp|scaleDown"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#default-behavior",children:"Default Behavior"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"stabilizationWindowSeconds: <seconds>"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\uc8fc\uc5b4\uc9c4 \uc2dc\uac04 \ub3d9\uc548 \uc81c\uc548\ub41c desiredReplicas \uc911 \uac00\uc7a5 \ud070(down)/\uc791\uc740(up) \uac12\uc744 \uc801\uc6a9\ud569\ub2c8\ub2e4."}),"\n",(0,s.jsx)(n.li,{children:"0 ~ 3600 \uc124\uc815 \uac00\ub2a5\ud569\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"tolerance: <ratio>"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\uae30\ubcf8\uac12\uc740 ",(0,s.jsx)(n.code,{children:"0.1"})," \uc785\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"selectPolicy: Max"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Max"}),": \uc815\ucc45 \uc911 \uac00\uc7a5 \ub192\uc740 \uc218\uce58\ub97c \uc801\uc6a9\ud569\ub2c8\ub2e4."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Min"}),": \uc815\ucc45 \uc911 \uac00\uc7a5 \ub0ae\uc740 \uc218\uce58\ub97c \uc801\uc6a9\ud569\ub2c8\ub2e4."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Disabled"}),": \uc815\ucc45\uc744 \uc801\uc6a9\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"policies: []"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"type: Percent|Pods"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Percent"}),": \ucd5c\ub300 ",(0,s.jsx)(n.code,{children:"currentReplicas * value / 100"}),"\ub9cc\ud07c scale up/down \ud569\ub2c8\ub2e4."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Pods"}),": \ucd5c\ub300 ",(0,s.jsx)(n.code,{children:"value"}),"\ub9cc\ud07c scale up/down \ud569\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"value: <int>"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"periodSeconds: <seconds>"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\uc815\ucc45\uc774 \uc120\ud0dd\ub418\uace0 \ub2e4\uc74c \uc815\ucc45\uc774 \uc120\ud0dd\ub418\uae30\uae4c\uc9c0\uc758 \uc2dc\uac04\uc785\ub2c8\ub2e4."}),"\n",(0,s.jsx)(n.li,{children:"1 ~ 1800 \uc124\uc815 \uac00\ub2a5\ud569\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"algorithm",children:"Algorithm"}),"\n",(0,s.jsx)(n.admonition,{title:"Reference",type:"info",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/kubernetes/kubernetes/blob/f7fb7cd86b6db5531087b4ae3b1e8198af3c927e/pkg/controller/podautoscaler/horizontal.go#L753",children:"kubernetes/kubernetes GitHub / pkg/controller/podautoscaler/horizontal.go"})}),"\n"]})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"desiredReplicas := currentReplicas\nratio := currentMetricValue / desiredMetricValue\n\nif math.Abs(ratio-1) > tolerance {\n\tdesiredReplicas = int32(math.Ceil(float64(currentReplicas) * ratio))\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"desiredReplicas\uc640 recommendations\uc5d0\uc11c upStabilizationWindowSeconds\uc640 downStabilizationWindowSeconds\ub97c \uc0ac\uc6a9\ud558\uc5ec upRecommendation\uacfc downRecommendation\uc744 \uad6c\ud558\uace0, desiredReplicas\ub97c recommendations\uc5d0 \ucd94\uac00\ud569\ub2c8\ub2e4."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"desiredReplicas = currentReplicas\nif desiredReplicas < upRecommendation {\n\tdesiredReplicas = upRecommendation\n}\nif desiredReplicas > downRecommendation {\n\tdesiredReplicas = downRecommendation\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"\uc815\ucc45\uc744 \uc801\uc6a9\ud569\ub2c8\ub2e4."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"if desiredReplicas > currentReplicas {\n\tdesiredReplicas = upPolicy(desiredReplicas)\n} else if desiredReplicas < currentReplicas {\n\tdesiredReplicas = downPolicy(desiredReplicas)\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"default-behavior",children:"Default Behavior"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"spec:\n  behavior:\n    scaleUp:\n      selectPolicy: Max\n      policies:\n        - type: Pods\n          value: 4\n          periodSeconds: 60\n        - type: Percent\n          value: 100\n          periodSeconds: 60\n      stabilizationWindowSeconds: 0\n    scaleDown:\n      policies:\n        - type: Percent\n          value: 100\n          periodSeconds: 60\n      stabilizationWindowSeconds: 300\n"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(t,{...e})}):t(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>c});var l=i(96540);const s={},r=l.createContext(s);function o(e){const n=l.useContext(r);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),l.createElement(r.Provider,{value:n},e.children)}}}]);