"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[88261],{28453:(n,e,i)=>{i.d(e,{R:()=>l,x:()=>s});var t=i(96540);const r={},c=t.createContext(r);function l(n){const e=t.useContext(c);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:l(n.components),t.createElement(c.Provider,{value:e},n.children)}},63084:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>a,contentTitle:()=>d,default:()=>x,frontMatter:()=>o,metadata:()=>t,toc:()=>h});const t=JSON.parse('{"id":"mlops/network/cni","title":"Container Network Interface(CNI)","description":"Container Network Interface(CNI)","source":"@site/docs/mlops/network/cni.mdx","sourceDirName":"mlops/network","slug":"/mlops/network/cni","permalink":"/docs/mlops/network/cni","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/mlops/network/cni.mdx","tags":[],"version":"current","lastUpdatedAt":1746964508000,"frontMatter":{"id":"cni","title":"Container Network Interface(CNI)","sidebar_label":"CNI","description":"Container Network Interface(CNI)","keywords":["Container Network Interface","cni"]},"sidebar":"network","next":{"title":"Cilium","permalink":"/docs/mlops/network/cilium/"}}');var r=i(74848),c=i(28453),l=i(98180),s=i(79883);const o={id:"cni",title:"Container Network Interface(CNI)",sidebar_label:"CNI",description:"Container Network Interface(CNI)",keywords:["Container Network Interface","cni"]},d=void 0,a={},h=[{value:"CNI",id:"cni",level:2},{value:"CNI \uc124\uc815",id:"cni-\uc124\uc815",level:2},{value:"\uaddc\uce59",id:"\uaddc\uce59",level:3},{value:"\uc608\uc2dc",id:"\uc608\uc2dc",level:3}];function u(n){const e={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",mermaid:"mermaid",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.h2,{id:"cni",children:"CNI"}),"\n",(0,r.jsx)("center",{children:(0,r.jsxs)("figure",{children:[(0,r.jsx)(s.A,{src:(0,l.Ay)("img/mlops/network/calico/cni-with-calico-ipam.drawio")}),(0,r.jsx)("figcaption",{children:"Calico CNI and Calico IPAM(pod-network-cidr=10.130.0.0/16)"}),(0,r.jsx)("figcaption",{children:(0,r.jsx)(e.a,{href:"https://www.youtube.com/watch?v=JyLtg_SJ1lo",children:"https://www.youtube.com/watch?v=JyLtg_SJ1lo"})})]})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"#cni-%EC%84%A4%EC%A0%95",children:"Network configuration format"})}),"\n",(0,r.jsxs)(e.li,{children:["Execution Protocol","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\ud50c\ub7ec\uadf8\uc778\uc740 \uc2e4\ud589\ud30c\uc77c\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(e.li,{children:"\ud50c\ub7ec\uadf8\uc778\uc740 \ud658\uacbd \ubcc0\uc218\uc640 stdin\uc744 \ud1b5\ud574 \uc124\uc815\uac12\uc744 \ubc1b\uc2b5\ub2c8\ub2e4."}),"\n",(0,r.jsx)(e.li,{children:"\ud50c\ub7ec\uadf8\uc778\uc740 \uc124\uc815 \uc131\uacf5 \uc2dc stdout, \uc2e4\ud328 \uc2dc stderr\ub85c \uacb0\uacfc\ub97c \ubc18\ud658\ud569\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["Execution of Network Configurations","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\ucee8\ud14c\uc774\ub108 \ub7f0\ud0c0\uc784\uc740 \ub124\ud2b8\uc6cc\ud06c \uc124\uc815\uc744 \ud574\uc11d\ud558\uc5ec CNI \ud50c\ub7ec\uadf8\uc778\uc744 \uc2e4\ud589\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsxs)(e.li,{children:["\uc218\uba85 \uc8fc\uae30","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\ucee8\ud14c\uc774\ub108 \ub7f0\ud0c0\uc784\uc740 \ud50c\ub7ec\uadf8\uc778\uc744 \ud638\ucd9c\ud558\uae30 \uc804\uc5d0 \ucee8\ud14c\uc774\ub108\uc5d0 \ub300\ud55c \uc0c8 \ub124\ud2b8\uc6cc\ud06c \ub124\uc784\uc2a4\ud398\uc774\uc2a4\ub97c \uc0dd\uc131\ud574\uc57c \ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(e.li,{children:"..."}),"\n",(0,r.jsx)(e.li,{children:"\ucee8\ud14c\uc774\ub108 \ub7f0\ud0c0\uc784\uc740 \ucee8\ud14c\uc774\ub108\uc758 \ub124\ud2b8\uc6cc\ud06c \ub124\uc784\uc2a4\ud398\uc774\uc2a4 \uc815\ub9ac\ub97c \ub2f4\ub2f9\ud569\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["Plugin Delegation","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"CNI \ud50c\ub7ec\uadf8\uc778\uc740 \uc77c\ubd80 \uae30\ub2a5\uc744 \ub2e4\ub978 \ud50c\ub7ec\uadf8\uc778\uc5d0 \uc704\uc784\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.(e.g., IPAM plugin)"}),"\n",(0,r.jsx)(e.li,{children:"\uc704\uc784\ubc1b\uc740 \ud50c\ub7ec\uadf8\uc778\uc740 \uc2e4\ud589\ud30c\uc77c\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(e.li,{children:"\uc704\uc784\ubc1b\uc740 \ud50c\ub7ec\uadf8\uc778\uc740 CNI \ud50c\ub7ec\uadf8\uc778\uc5d0 \uc804\ub2ec\ub41c \uac83\uacfc \ub3d9\uc77c\ud55c \ud658\uacbd \ubcc0\uc218\uc640 stdin\uc744 \ubaa8\ub450 \uc124\uc815\uac12\uc73c\ub85c \ubc1b\uc544\uc57c\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(e.li,{children:"\uc704\uc784\ubc1b\uc740 \ud50c\ub7ec\uadf8\uc778\uc740 \uc124\uc815 \uc131\uacf5 \uc2dc stdout, \uc2e4\ud328 \uc2dc stderr\ub85c \uacb0\uacfc\ub97c \ubc18\ud658\ud569\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["Result Types","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"CNI \ud50c\ub7ec\uadf8\uc778\uc758 \uc2e4\ud589 \uacb0\uacfc\uc5d0 \ub300\ud55c JSON \ud615\uc2dd\uc758 \uc2a4\ud0a4\ub9c8\uac00 \uc788\uc2b5\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"Pod\uc744 \uc0dd\uc131\ud558\uba74 CNI plugin\uc740 \uc544\ub798\uc640 \uac19\uc740 \uc808\ucc28\ub85c \ud638\ucd9c\ub418\uc5b4 \ub124\ud2b8\uc6cc\ud06c\ub97c \uc124\uc815\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(e.mermaid,{value:"sequenceDiagram\n  participant kubelet\n  participant CR as Container Runtime\n  participant CNI as CNI Plugin\n\n  kubelet ->> CR: RunPodSandbox\n\n  create participant Sandbox\n\n  CR ->> Sandbox: create\n\n  CR ->> CNI: CNI_COMMAND=ADD\n  CNI ->> Sandbox: configure network\n\n  Note over kubelet, Sandbox: ..."}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Container Runtime\uc740","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Sandbox \ucee8\ud14c\uc774\ub108\ub97c \uc0dd\uc131\ud558\uace0 Network Namespace\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"/etc/cni/net.d/"}),"\uc5d0\uc11c \uc54c\ud30c\ubcb3\uc21c\uc73c\ub85c \uccab\ubc88\uc9f8 CNI \uc124\uc815 \ud30c\uc77c(",(0,r.jsx)(e.code,{children:".conf"}),", ",(0,r.jsx)(e.code,{children:".conflist"}),")\uc744 \uc77d\uc2b5\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(e.li,{children:["\uc124\uc815\uc5d0 \ub9de\ucdb0 CNI plugin\uc758 ",(0,r.jsx)(e.code,{children:"ADD"})," \uba85\ub839\uc5b4\ub97c \ud638\ucd9c\ud569\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"cni-\uc124\uc815",children:"CNI \uc124\uc815"}),"\n",(0,r.jsx)(e.h3,{id:"\uaddc\uce59",children:"\uaddc\uce59"}),"\n",(0,r.jsx)(e.admonition,{title:"Reference",type:"info",children:(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://github.com/containernetworking/cni/blob/main/SPEC.md#section-1-network-configuration-format",children:"CNI GitHub / SPEC.md # Network Configuration Format"})}),"\n"]})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"cniVersion"}),", ",(0,r.jsx)(e.code,{children:"cniVersions"})]}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.code,{children:"name"})}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"plugins"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://www.cni.dev/plugins/current/",children:"https://www.cni.dev/plugins/current/"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://github.com/containernetworking/plugins",children:"https://github.com/containernetworking/plugins"})}),"\n",(0,r.jsxs)(e.li,{children:["plugin\uc774 \ud558\ub098\uc778 \uacbd\uc6b0 ",(0,r.jsx)(e.code,{children:"plugins"}),"\uc5c6\uc774 \uc0c1\uc704\uc5d0 \uc784\ubca0\ub529 \ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"type"}),"\uc744 \uc81c\uc678\ud55c \ub098\uba38\uc9c0 \ud544\ub4dc\ub294 \ud50c\ub7ec\uadf8\uc778\ub9c8\ub2e4 \ub2e4\ub974\uba70, \uc815\ud574\uc9c4 \uac12\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"type"}),": CNI \ubc14\uc774\ub108\ub9ac \uc774\ub984\uacfc \ub9e4\uce6d\ub418\ub294 \uac12\uc785\ub2c8\ub2e4.","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.code,{children:"ls /opt/cni/bin"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"ipam"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"type"}),": IPAM \ubc14\uc774\ub108\ub9ac \uc774\ub984\uacfc \ub9e4\uce6d\ub418\ub294 \uac12\uc785\ub2c8\ub2e4.","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://www.cni.dev/plugins/current/ipam/",children:"https://www.cni.dev/plugins/current/ipam/"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.code,{children:"dhcp"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.code,{children:"host-local"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.code,{children:"static"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\uc608\uc2dc",children:"\uc608\uc2dc"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",metastring:'title="/etc/cni/net.d/10-calico.conflist"',children:'{\n\t"cniVersion": "0.3.1",\n\t"name": "k8s-pod-network",\n\t"plugins": [\n\t\t{\n\t\t\t"type": "calico",\n\t\t\t// plugin specific parameters\n\t\t\t"datastore_type": "kubernetes",\n\t\t\t"ipam": {\n\t\t\t\t"type": "calico-ipam",\n\t\t\t\t"assign_ipv4": "true"\n\t\t\t},\n\t\t\t"policy": {\n\t\t\t\t"type": "k8s"\n\t\t\t},\n\t\t\t"kubernetes": {\n\t\t\t\t"kubeconfig": "/etc/cni/net.d/calico-kubeconfig"\n\t\t\t}\n\n\t\t\t//...\n\t\t}\n\t]\n}\n'})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",metastring:'title="/etc/cni/net.d/00-multus.conf"',children:'{\n\t"cniVersion": "0.3.1",\n\t"name": "multus-cni-network",\n\t"type": "multus-shim",\n\t"capabilities": {\n\t\t"bandwidth": true,\n\t\t"portMappings": true\n\t},\n\t"clusterNetwork": "/host/etc/cni/net.d/10-calico.conflist"\n}\n'})})]})}function x(n={}){const{wrapper:e}={...(0,c.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(u,{...n})}):u(n)}},79883:(n,e,i)=>{i.d(e,{A:()=>c});var t=i(96540),r=i(74848);function c(n){let{src:e}=n;const[i,c]=(0,t.useState)("loading..."),l=(0,t.useRef)(null);return(0,t.useEffect)((()=>{if("undefined"==typeof window)return;const n=window.GraphViewer;n?fetch(e).then((n=>{if(!n.ok)throw new Error("Failed to fetch drawio file");return n.text()})).then((e=>{if(!e)return void c("Drawio file is empty");const i={editable:"_blank",highlight:"#0000ff",nav:!0,resize:!0,toolbar:"zoom lightbox",xml:e};l.current.dataset.mxgraph=JSON.stringify(i),c(""),setTimeout((()=>{n.createViewerForElement(l.current)}),0)})).catch((n=>{c("Failed to load diagram: "+n.message)})):c("GraphViewer is not loaded")}),[e]),(0,r.jsxs)("div",{className:"w-full p-4",children:[i&&(0,r.jsx)("p",{children:i}),(0,r.jsx)("div",{className:"w-full bg-white",ref:l})]})}}}]);