"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[40061],{28453:(e,n,a)=>{a.d(n,{R:()=>s,x:()=>o});var i=a(96540);const t={},r=i.createContext(t);function s(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),i.createElement(r.Provider,{value:n},e.children)}},74462:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>b,frontMatter:()=>s,metadata:()=>i,toc:()=>m});const i=JSON.parse('{"id":"mlops/mlops/event/rabbitmq","title":"RabbitMQ","description":"RabbitMQ","source":"@site/docs/mlops/mlops/event/rabbitmq.mdx","sourceDirName":"mlops/mlops/event","slug":"/mlops/mlops/event/rabbitmq","permalink":"/docs/mlops/mlops/event/rabbitmq","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/mlops/mlops/event/rabbitmq.mdx","tags":[],"version":"current","lastUpdatedAt":1744038011000,"frontMatter":{"id":"rabbitmq","title":"RabbitMQ","sidebar_label":"RabbitMQ","description":"RabbitMQ","keywords":["rabbitmq"]},"sidebar":"mlops","previous":{"title":"Redis","permalink":"/docs/mlops/mlops/event/redis/"},"next":{"title":"RabbitMQ Flow","permalink":"/docs/mlops/mlops/event/rabbitmq-flow"}}');var t=a(74848),r=a(28453);const s={id:"rabbitmq",title:"RabbitMQ",sidebar_label:"RabbitMQ",description:"RabbitMQ",keywords:["rabbitmq"]},o=void 0,l={},m=[{value:"\uc124\uce58",id:"\uc124\uce58",level:2},{value:"CRDs",id:"crds",level:2},{value:"RabbitmqCluster",id:"rabbitmqcluster",level:3},{value:"User &amp;&amp; Permission",id:"user--permission",level:3},{value:"Queue",id:"queue",level:3},{value:"Exchange",id:"exchange",level:3},{value:"Binding",id:"binding",level:3},{value:"Policy",id:"policy",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"\uc124\uce58",children:"\uc124\uce58"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"helm repo add bitnami https://charts.bitnami.com/bitnami \\\n&& helm repo update bitnami\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"helm search repo bitnami/rabbitmq-cluster-operator -l | head -n 10\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"helm show values bitnami/rabbitmq-cluster-operator \\\n    --version 2.6.6 \\\n    > values.yaml\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"helm upgrade rabbitmq-operator bitnami/rabbitmq-cluster-operator \\\n    --install \\\n    --version 2.6.6 \\\n    -n workflow \\\n    -f values.yaml\n"})}),"\n",(0,t.jsx)(n.h2,{id:"crds",children:"CRDs"}),"\n",(0,t.jsx)(n.h3,{id:"rabbitmqcluster",children:"RabbitmqCluster"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.rabbitmq.com/kubernetes/operator/using-operator.html",children:"https://www.rabbitmq.com/kubernetes/operator/using-operator.html"})}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'apiVersion: rabbitmq.com/v1beta1\nkind: RabbitmqCluster\nmetadata:\n  name: rabbitmq\n  namespace: workflow\nspec:\n  replicas: 1\n  rabbitmq:\n    additionalConfig: |\n      cluster_partition_handling = pause_minority\n      vm_memory_high_watermark_paging_ratio = 0.99\n      disk_free_limit.relative = 2.0\n      collect_statistics_interval = 30000\n  resources:\n    requests:\n      cpu: 200m\n      memory: 2Gi\n    limits:\n      memory: 2Gi\n  persistence:\n    storage: 10Gi\n  affinity:\n    podAntiAffinity:\n      requiredDuringSchedulingIgnoredDuringExecution:\n        - labelSelector:\n            matchExpressions:\n              - key: app.kubernetes.io/name\n                operator: In\n                values:\n                  - rabbitmq\n          topologyKey: kubernetes.io/hostname\n  override:\n    statefulSet:\n      spec:\n        template:\n          spec:\n            containers: []\n            topologySpreadConstraints:\n              - maxSkew: 1\n                topologyKey: "topology.kubernetes.io/zone"\n                whenUnsatisfiable: DoNotSchedule\n                labelSelector:\n                  matchLabels:\n                    app.kubernetes.io/name: rabbitmq\n'})}),"\n",(0,t.jsx)(n.h3,{id:"user--permission",children:"User && Permission"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Secret\nmetadata:\n  name: <secret-name>\n  namespace: workflow\ntype: Opaque\nstringData:\n  username: <username>\n  password: <password>\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/rabbitmq/messaging-topology-operator/blob/main/api/v1beta1/user_types.go",children:"https://github.com/rabbitmq/messaging-topology-operator/blob/main/api/v1beta1/user_types.go"})}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: rabbitmq.com/v1beta1\nkind: User\nmetadata:\n  name: <crd-name>\n  namespace: workflow\nspec:\n  tags:\n    - <tag> # management | policymaker | monitoring | administrator\n  importCredentialsSecret:\n    name: <secret-name>\n  rabbitmqClusterReference:\n    name: rabbitmq\n    namespace: workflow\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/rabbitmq/messaging-topology-operator/blob/main/api/v1beta1/permission_types.go",children:"https://github.com/rabbitmq/messaging-topology-operator/blob/main/api/v1beta1/permission_types.go"})}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'apiVersion: rabbitmq.com/v1beta1\nkind: Permission\nmetadata:\n  name: <crd-name>\n  namespace: workflow\nspec:\n  userReference:\n    name: <user-crd-name>\n  vhost: "/"\n  permissions:\n    configure: ".*"\n    read: ".*"\n    write: ".*"\n  rabbitmqClusterReference:\n    name: rabbitmq\n    namespace: workflow\n'})}),"\n",(0,t.jsx)(n.h3,{id:"queue",children:"Queue"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/rabbitmq/messaging-topology-operator/blob/main/api/v1beta1/queue_types.go",children:"https://github.com/rabbitmq/messaging-topology-operator/blob/main/api/v1beta1/queue_types.go"})}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: rabbitmq.com/v1beta1\nkind: Queue\nmetadata:\n  name: <crd-name>\n  namespace: workflow\nspec:\n  name: <queue-name>\n  type: quorum # classic | quorum | stream\n  durable: true # false\uba74 server\uac00 \uc7ac\uc2dc\uc791\ub420 \ub54c, \ud050 \ub0b4\uc6a9\uc774 \uc0ad\uc81c\ub428\n  autoDelete: false # true\uba74 \ubaa8\ub4e0 Subscriber\uac00 \uad6c\ub3c5\uc744 \ucde8\uc18c\ud560 \ub54c, \ud050\uac00 \uc0ad\uc81c\ub428\n  rabbitmqClusterReference:\n    name: rabbitmq\n    namespace: workflow\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"Queue"}),", ",(0,t.jsx)(n.code,{children:"Exchange"}),"\uc5d0\uc11c ",(0,t.jsx)(n.code,{children:"arguments"})," \ub300\uc2e0 ",(0,t.jsx)(n.code,{children:"Policy"}),"\ub97c \uc0ac\uc6a9\ud558\uba74 \uc0dd\uc131 \ud6c4\uc5d0\ub3c4 \uc635\uc158 \ubcc0\uacbd\uc744 \ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]})}),"\n",(0,t.jsx)(n.h3,{id:"exchange",children:"Exchange"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/rabbitmq/messaging-topology-operator/blob/main/api/v1beta1/exchange_types.go",children:"https://github.com/rabbitmq/messaging-topology-operator/blob/main/api/v1beta1/exchange_types.go"})}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: rabbitmq.com/v1beta1\nkind: Exchange\nmetadata:\n  name: <crd-name>\n  namespace: workflow\nspec:\n  name: <exchange-name>\n  type: direct # direct | fanout | headers | topic\n  durable: true\n  autoDelete: false\n  rabbitmqClusterReference:\n    name: rabbitmq\n    namespace: workflow\n"})}),"\n",(0,t.jsx)(n.h3,{id:"binding",children:"Binding"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/rabbitmq/messaging-topology-operator/blob/main/api/v1beta1/binding_types.go",children:"https://github.com/rabbitmq/messaging-topology-operator/blob/main/api/v1beta1/binding_types.go"})}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: rabbitmq.com/v1beta1\nkind: Binding\nmetadata:\n  name: <crd-name>\n  namespace: workflow\nspec:\n  source: <source-name> # Exchange\uc758 \uc774\ub984\n  destination: <destination-name>\n  destinationType: queue # queue | exchange\n  # `.`\uc73c\ub85c \uad6c\ubd84\ub418\ub294 tag\uc758 \ub098\uc5f4\n  # `*`: \uc784\uc758\uc758 tag \ud558\ub098\n  # `#`: \uc784\uc758\uc758 tag 0 \uac1c \uc774\uc0c1\n  # a.* -> a.a, a.b, ...\n  # a.# -> a, a.a, a.a.a, ...\n  routingKey: <routing-key>\n  rabbitmqClusterReference:\n    name: rabbitmq\n    namespace: workflow\n"})}),"\n",(0,t.jsx)(n.h3,{id:"policy",children:"Policy"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/rabbitmq/messaging-topology-operator/blob/main/api/v1beta1/policy_types.go",children:"https://github.com/rabbitmq/messaging-topology-operator/blob/main/api/v1beta1/policy_types.go"})}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: rabbitmq.com/v1beta1\nkind: Policy\nmetadata:\n  name: <crd-name>\n  namespace: workflow\nspec:\n  name: <policy-name>\n  vhost: /\n  pattern: <pattern> # \uc774 Policy\ub97c \uc801\uc6a9\ud560 Queue \ub610\ub294 Exchange\uc758 \uc774\ub984 \ud328\ud134\n  applyTo: all # queues | exchanges | all\n  priority: 0\n  definition:\n    <key>: <value>\n  rabbitmqClusterReference: # Policy\uac00 \ub4f1\ub85d\ub420 \ud074\ub7ec\uc2a4\ud130\n    name: rabbitmq\n    namespace: workflow\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["\uc0ac\uc6a9\ub420 ",(0,t.jsx)(n.code,{children:"definition"}),"\uc758 \uacbd\uc6b0 management \uc6f9\uc5d0\uc11c ",(0,t.jsx)(n.code,{children:"Queue"}),"\ub610\ub294 ",(0,t.jsx)(n.code,{children:"Exchange"}),"\ub97c GUI\ub85c \uc0dd\uc131\ud574\ubcf4\uba74 \uc27d\uac8c \uc54c \uc218 \uc788\uc2b5\ub2c8\ub2e4."]})})]})}function b(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);