"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[89403],{26040:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>h,contentTitle:()=>t,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>x});const i=JSON.parse('{"id":"mlops/mlops/workflow/mpi-operator/openmpi","title":"OpenMPI","description":"OpenMPI","source":"@site/docs/mlops/mlops/workflow/mpi-operator/openmpi.mdx","sourceDirName":"mlops/mlops/workflow/mpi-operator","slug":"/mlops/mlops/workflow/mpi-operator/openmpi","permalink":"/docs/mlops/mlops/workflow/mpi-operator/openmpi","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/mlops/mlops/workflow/mpi-operator/openmpi.mdx","tags":[],"version":"current","lastUpdatedAt":1746033570000,"frontMatter":{"id":"openmpi","title":"OpenMPI","sidebar_label":"OpenMPI","description":"OpenMPI","keywords":["mpi","openmpi"]},"sidebar":"mlops","previous":{"title":"MPIJob","permalink":"/docs/mlops/mlops/workflow/mpi-operator/mpijob"},"next":{"title":"Argo Events","permalink":"/docs/mlops/mlops/event/argo-events"}}');var s=l(74848),r=l(28453),c=l(86025),d=l(74856);const o={id:"openmpi",title:"OpenMPI",sidebar_label:"OpenMPI",description:"OpenMPI",keywords:["mpi","openmpi"]},t=void 0,h={},x=[{value:"OpenMPI Architecture",id:"openmpi-architecture",level:2},{value:"\uc124\uce58",id:"\uc124\uce58",level:2},{value:"mpirun/mpiexec",id:"mpirunmpiexec",level:2}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"openmpi-architecture",children:"OpenMPI Architecture"}),"\n",(0,s.jsx)("center",{children:(0,s.jsxs)("figure",{children:[(0,s.jsx)(d.A,{src:(0,c.Ay)("img/mlops/mlops/workflow/mpi-ooerator/mpi-architecture.drawio")}),(0,s.jsx)("figcaption",{children:"OpenMPI Architecture"})]})}),"\n",(0,s.jsx)("br",{}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Frameworks","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.open-mpi.org/en/main/developers/frameworks.html",children:"OpenMPI / Internal frameworks"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"pml"}),": Potin-to-point Management Layer","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"MPI_Send"}),", ",(0,s.jsx)(n.code,{children:"MPI_Recv"})," \ub4f1\uc758 \ucc98\ub9ac\ub97c \ub2f4\ub2f9\ud569\ub2c8\ub2e4."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"ob1"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\ub2e4\uc591\ud55c ",(0,s.jsx)(n.code,{children:"btl"})," \ubc31\uc5d4\ub4dc\ub97c \uc870\ud569\ud558\uc5ec \uc0ac\uc6a9 \uac00\ub2a5\ud569\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"cm"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"mtl"}),"\uc744 \uc0ac\uc6a9\ud569\ub2c8\ub2e4."]}),"\n",(0,s.jsx)(n.li,{children:"Matching Network, iWARP\uc5d0\uc11c \uc8fc\ub85c \uc0ac\uc6a9\ub429\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"ucx"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"UCX\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4."}),"\n",(0,s.jsx)(n.li,{children:"IB, RoCE \ub124\ud2b8\uc6cc\ud06c\uc5d0\uc11c \uc8fc\ub85c \uc0ac\uc6a9\ub429\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"btl"}),": point-to-point Byte Transfer Layer","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"tcp"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"openib"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"vader"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"mtl"}),": Matching Transport Layer"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"coll"}),": COLLective algorithms","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"MPI_Bcast"}),", ",(0,s.jsx)(n.code,{children:"MPI_Allreduce"})," \ub4f1\uc758 \ucc98\ub9ac\ub97c \ub2f4\ub2f9\ud569\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"osc"}),": One-Sided Communication","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"MPI_Put"}),", ",(0,s.jsx)(n.code,{children:"MPI_Get"})," \ub4f1\uc758 \ucc98\ub9ac\ub97c \ub2f4\ub2f9\ud569\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\uc124\uce58",children:"\uc124\uce58"}),"\n",(0,s.jsx)(n.admonition,{title:"Reference",type:"info",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www-lb.open-mpi.org/software/ompi",children:"OpenMPI / Download"})}),"\n"]})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"tar xf openmpi-5.0.7.tar.bz2\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"cd openmpi-5.0.7\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"mkdir build && cd build \\\n&& ../configure --prefix=/usr \\\n    <flags>\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"--with-ucx=<ucxInstallPrefix>"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/docs/lang/design/protocol/ucx",children:"UCX"})}),"\n",(0,s.jsxs)(n.li,{children:["btl_uct \uad00\ub828 \ucef4\ud30c\uc77c \uc5d0\ub7ec\uac00 \ubc1c\uc0dd\ud558\uba74 ",(0,s.jsx)(n.code,{children:"--enable-mca-no-build=btl-uct"}),"\ub97c \ucd94\uac00\ud558\uace0 mpirun \uc0ac\uc6a9\uc2dc ",(0,s.jsx)(n.code,{children:"--mca btl ^uct"}),"\ub97c \ucd94\uac00\ud569\ub2c8\ub2e4."]}),"\n",(0,s.jsxs)(n.li,{children:["\ucd94\uac00 \uc624\ubc84\ud5e4\ub4dc\uac00 \uc788\ub2e4\uba74 ",(0,s.jsx)(n.code,{children:"--mca btl ^vader,tcp,openib,uct"})," \uc635\uc158\uc73c\ub85c \uae30\ubcf8 btl\uc744 \uc81c\uc678\uc2dc\ucf1c\ubcfc \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"--with-platform=contrib/platform/mellanox/optimized"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"--with-knem=<knemInstallPrefix>"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"make -j $(nproc) all\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"make install\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"ldconfig\n"})}),"\n",(0,s.jsx)(n.h2,{id:"mpirunmpiexec",children:"mpirun/mpiexec"}),"\n",(0,s.jsx)(n.admonition,{title:"Reference",type:"info",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.open-mpi.org/en/main/man-openmpi/man1/mpirun.1.html",children:"OpenMPI / mpirunt"})}),"\n"]})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"mpirun <flags> <program> [<args>]\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Launch \uc124\uc815","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"-n <num>"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\uc2e4\ud589\ud560 ",(0,s.jsx)(n.code,{children:"program"}),"\uc758 \uc218\ub97c \uc9c0\uc815\ud569\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"-H|--host <host>[:<slot>],[<host>[:<slot>],...]"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"--hostfile <path>"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"--mca <key> [^]<value>[,<value>,...]"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"^"}),"\ub294 \uc81c\uc678\ub97c \uc758\ubbf8\ud569\ub2c8\ub2e4."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"OMPI_MCA_<key>=<value>"})," \ud615\uc2dd\uc758 \ud658\uacbd\ubcc0\uc218\ub85c \uc124\uc815\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"-x <env>[=<value>]"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\ud658\uacbd\ubcc0\uc218\ub97c \uc124\uc815\ud569\ub2c8\ub2e4."}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"<env>"}),"\ub9cc \uc124\uc815\ud558\uba74 \ud604\uc7ac \ud658\uacbd\ubcc0\uc218\uc758 \uac12\uc744 \uc0ac\uc6a9\ud569\ub2c8\ub2e4."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"foo*"}),"\uc744 \uc124\uc815\ud558\uba74 \ud604\uc7ac \ud658\uacbd\ubcc0\uc218 \uc911 ",(0,s.jsx)(n.code,{children:"foo"}),"\ub85c \uc2dc\uc791\ud558\ub294 \ubaa8\ub4e0 \ud658\uacbd\ubcc0\uc218\ub97c \uc124\uc815\ud569\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Mapping, ranking, binding \uc124\uc815","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"--map-by <mapping>"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"slot"}),": \uac01 \ud504\ub85c\uc138\uc2a4\ub97c \uac01 \ub178\ub4dc\uc758 slot\uc5d0 \ub9e4\ud551\ud569\ub2c8\ub2e4.(\ud55c \ub178\ub4dc\uc758 slot\uc744 \ubaa8\ub450 \uc0ac\uc6a9\ud558\uba74 \ub2e4\uc74c \ub178\ub4dc\ub85c \ub118\uc5b4\uac11\ub2c8\ub2e4.)"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"--bind-to <bound>"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"none"}),": \ud504\ub85c\uc138\uc2a4\ub97c \ubc14\uc778\ub529\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"numa"}),": \uac01 \ud504\ub85c\uc138\uc2a4\ub97c NUMA \uc601\uc5ed\uc5d0 \uc788\ub294 \ubaa8\ub4e0 CPU\uc5d0 \ubc14\uc778\ub529\ud569\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Specific \uc124\uc815","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"--allow-run-as-root"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"root \uad8c\ud55c\uc73c\ub85c \uc2e4\ud589\ud569\ub2c8\ub2e4."}),"\n",(0,s.jsx)(n.li,{children:"\uad8c\uc7a5\ub418\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\uc6a9\uc5b4","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Resource Manager(RM)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"slurm \ub4f1"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"slot"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\ud504\ub85c\uc138\uc2a4\ub97c \uc2e4\ud589\ud560 \uc218 \uc788\ub294 \ud560\ub2f9\uac00\ub2a5\ud55c \ub2e8\uc704\uc785\ub2c8\ub2e4."}),"\n",(0,s.jsx)(n.li,{children:"\uc124\uc815\ud558\uc9c0 \uc54a\uc73c\uba74 CPU \uc218 \ub610\ub294 RM\uc774 \uacb0\uc815\ud569\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},28453:(e,n,l)=>{l.d(n,{R:()=>c,x:()=>d});var i=l(96540);const s={},r=i.createContext(s);function c(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),i.createElement(r.Provider,{value:n},e.children)}},74856:(e,n,l)=>{l.d(n,{A:()=>r});var i=l(96540),s=l(74848);function r(e){let{src:n}=e;const[l,r]=(0,i.useState)("loading..."),c=(0,i.useRef)(null);return(0,i.useEffect)((()=>{if("undefined"==typeof window)return;const e=window.GraphViewer;e?fetch(n).then((e=>{if(!e.ok)throw new Error("Failed to fetch drawio file");return e.text()})).then((n=>{if(!n)return void r("Drawio file is empty");const l={editable:"_blank",highlight:"#0000ff",nav:!0,resize:!0,toolbar:"zoom lightbox",xml:n};c.current.dataset.mxgraph=JSON.stringify(l),r(""),setTimeout((()=>{e.createViewerForElement(c.current)}),0)})).catch((e=>{r("Failed to load diagram: "+e.message)})):r("GraphViewer is not loaded")}),[n]),(0,s.jsxs)("div",{className:"w-full",children:[l&&(0,s.jsx)("p",{children:l}),(0,s.jsx)("div",{className:"w-full bg-white",ref:c})]})}}}]);