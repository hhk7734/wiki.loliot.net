"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[51],{28453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>i});var a=s(96540);const t={},l=a.createContext(t);function r(e){const n=a.useContext(l);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),a.createElement(l.Provider,{value:n},e.children)}},87998:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>d,frontMatter:()=>r,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"mlops/mlops/event/nats/nats","title":"NATS","description":"NATS","source":"@site/docs/mlops/mlops/event/nats/nats.mdx","sourceDirName":"mlops/mlops/event/nats","slug":"/mlops/mlops/event/nats/","permalink":"/docs/mlops/mlops/event/nats/","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/mlops/mlops/event/nats/nats.mdx","tags":[],"version":"current","lastUpdatedAt":1740111436000,"frontMatter":{"id":"nats","title":"NATS","sidebar_label":"NATS","description":"NATS","keywords":["nats"]},"sidebar":"mlops","previous":{"title":"Argo Events","permalink":"/docs/mlops/mlops/event/argo-events"},"next":{"title":"CLI","permalink":"/docs/mlops/mlops/event/nats/cli"}}');var t=s(74848),l=s(28453);const r={id:"nats",title:"NATS",sidebar_label:"NATS",description:"NATS",keywords:["nats"]},i=void 0,o={},c=[{value:"\uc124\uce58",id:"\uc124\uce58",level:2},{value:"NATS",id:"nats",level:3},{value:"NACK",id:"nack",level:3},{value:"Test",id:"test",level:2}];function m(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"\uc124\uce58",children:"\uc124\uce58"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"helm repo add nats https://nats-io.github.io/k8s/helm/charts\n"})}),"\n",(0,t.jsx)(n.h3,{id:"nats",children:"NATS"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs/mlops/kubernetes/storage/persistent-volume",children:"PersistentVolume"})}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"helm repo update nats \\\n&& helm search repo nats/nats -l | head -n 10\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"helm show values nats/nats \\\n    --version 1.1.2 \\\n    > nats-values.yaml\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/nats-io/k8s/tree/main/helm/charts/nats#merge",children:"https://github.com/nats-io/k8s/tree/main/helm/charts/nats#merge"})}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="nats-values.yaml"',children:'fullnameOverride: ""\n\nconfig:\n  cluster:\n    enabled: true\n    replicas: 3\n\n  jetstream:\n    enabled: true\n\n    fileStore:\n      enabled: true\n      dir: /data\n\n      pvc:\n        size: 10Gi\n\n        merge:\n          spec:\n            accessModes:\n              - "ReadWriteOnce"\n\n    memoryStore:\n      enabled: false\n\n  merge:\n    # <<>> \ub85c \uac10\uc2f8\uba74 "" \uc5c6\uc774 \uc785\ub825 \uadf8\ub300\ub85c \uc124\uc815\ub429\ub2c8\ub2e4.\n    max_payload: << 1MB >> # \ucd5c\ub313\uac12: 64MB, \uad8c\uc7a5 \ucd5c\ub313\uac12: 8MB\n\n    # authorization:\n    #   users:\n    #     - user: << $NATS_USER >>\n    #       password: << $NATS_PASSWORD >>\n    #     - nkey: <nkey-user>\n    accounts:\n      dev:\n        users: []\n      prod:\n        users: []\n      SYS:\n        users:\n          - user: << $NATS_ADMIN_USER >>\n            password: << $NATS_ADMIN_PASSWORD >>\n\n    system_account: SYS\n\ncontainer:\n  env:\n    NATS_ADMIN_USER:\n      valueFrom:\n        secretKeyRef:\n          name: <secretName>\n          key: user\n    NATS_ADMIN_PASSWORD:\n      valueFrom:\n        secretKeyRef:\n          name: <secretName>\n          key: password\n  merge:\n    resources:\n      requests:\n        cpu: 500m\n        memory: 1Gi\n      limits:\n        memory: 1Gi\n\nservice:\n  ports:\n    monitor:\n      enabled: true\n\nstatefulSet:\n  merge:\n    metadata:\n      labels: {}\n\npodTemplate:\n  merge:\n    metadata:\n      labels:\n        app.kubernetes.io/name: nats\n        app.kubernetes.io/instance: <fullname>\n    spec:\n      affinity:\n        podAntiAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n            - podAffinityTerm:\n                labelSelector:\n                  matchLabels:\n                    app.kubernetes.io/name: nats\n                    app.kubernetes.io/instance: <fullname>\n                topologyKey: kubernetes.io/hostname\n              weight: 100\n      tolerations: []\n\nnatsBox:\n  enabled: false\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"helm template nats nats/nats \\\n    --version 1.1.2 \\\n    -n event \\\n    -f nats-values.yaml \\\n    > nats.yaml\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"helm upgrade nats nats/ntas \\\n    --install \\\n    --version 1.1.2 \\\n    -n event \\\n    --history-max 5 \\\n    -f nats-values.yaml\n"})}),"\n",(0,t.jsx)(n.h3,{id:"nack",children:"NACK"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"kubectl apply -f https://github.com/nats-io/nack/releases/download/v0.12.0/crds.yml\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"helm repo update nats \\\n&& helm search repo nats/nack -l | head -n 10\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"helm show values nats/nack \\\n    --version 0.23.0 \\\n    > nack-values.yaml\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="nack-values.yaml"',children:"resources:\n  requests:\n    cpu: 10m\n    memory: 64Mi\n  limits:\n    memory: 64Mi\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"helm template nack nats/nack \\\n    --version 0.23.0 \\\n    -n event \\\n    -f nack-values.yaml \\\n    > nack.yaml\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"helm upgrade nack nats/nack \\\n    --install \\\n    --history-max 5 \\\n    --version 0.23.0 \\\n    -n event \\\n    -f nack-values.yaml\n"})}),"\n",(0,t.jsx)(n.h2,{id:"test",children:"Test"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"kubectl run -i --rm --tty nats-box --image=natsio/nats-box --restart=Never\n"})})]})}function d(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(m,{...e})}):m(e)}}}]);