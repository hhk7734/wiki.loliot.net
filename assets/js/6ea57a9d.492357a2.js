"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[19001],{28453:(e,o,n)=>{n.d(o,{R:()=>s,x:()=>t});var l=n(96540);const r={},c=l.createContext(r);function s(e){const o=l.useContext(c);return l.useMemo(function(){return"function"==typeof e?e(o):{...o,...e}},[o,e])}function t(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),l.createElement(c.Provider,{value:o},e.children)}},39513:(e,o,n)=>{n.r(o),n.d(o,{assets:()=>i,contentTitle:()=>t,default:()=>p,frontMatter:()=>s,metadata:()=>l,toc:()=>d});const l=JSON.parse('{"id":"mlops/storage/ceph/reboot","title":"Ceph \ub178\ub4dc \uc7ac\uc2dc\uc791\ud558\uae30","description":"Ceph \ub178\ub4dc \uc7ac\uc2dc\uc791\ud558\uae30","source":"@site/docs/mlops/storage/ceph/reboot.mdx","sourceDirName":"mlops/storage/ceph","slug":"/mlops/storage/ceph/reboot","permalink":"/docs/mlops/storage/ceph/reboot","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/mlops/storage/ceph/reboot.mdx","tags":[],"version":"current","lastUpdatedAt":1750091233000,"frontMatter":{"id":"reboot","title":"Ceph \ub178\ub4dc \uc7ac\uc2dc\uc791\ud558\uae30","sidebar_label":"\ub178\ub4dc \uc7ac\uc2dc\uc791","description":"Ceph \ub178\ub4dc \uc7ac\uc2dc\uc791\ud558\uae30","keywords":["ceph","reboot"]},"sidebar":"storage","previous":{"title":"Central Storage Cluster","permalink":"/docs/mlops/storage/ceph/central-storage-cluster"},"next":{"title":"MinIO","permalink":"/docs/mlops/storage/minio/"}}');var r=n(74848),c=n(28453);const s={id:"reboot",title:"Ceph \ub178\ub4dc \uc7ac\uc2dc\uc791\ud558\uae30",sidebar_label:"\ub178\ub4dc \uc7ac\uc2dc\uc791",description:"Ceph \ub178\ub4dc \uc7ac\uc2dc\uc791\ud558\uae30",keywords:["ceph","reboot"]},t=void 0,i={},d=[{value:"\ub178\ub4dc \ud55c \ub300 \uc7ac\uc2dc\uc791",id:"\ub178\ub4dc-\ud55c-\ub300-\uc7ac\uc2dc\uc791",level:2},{value:"\uc804\uccb4 \ub178\ub4dc \uc7ac\uc2dc\uc791",id:"\uc804\uccb4-\ub178\ub4dc-\uc7ac\uc2dc\uc791",level:2},{value:"\uc2a4\ud1a0\ub9ac\uc9c0\ub97c \uc0ac\uc6a9\ud558\ub294 \ubaa8\ub4e0 \uc11c\ube44\uc2a4 scale down",id:"\uc2a4\ud1a0\ub9ac\uc9c0\ub97c-\uc0ac\uc6a9\ud558\ub294-\ubaa8\ub4e0-\uc11c\ube44\uc2a4-scale-down",level:3},{value:"Ceph OSD \uc124\uc815",id:"ceph-osd-\uc124\uc815",level:3},{value:"Rook \ucef4\ud3ec\ub10c\ud2b8 scale down",id:"rook-\ucef4\ud3ec\ub10c\ud2b8-scale-down",level:3},{value:"\ub178\ub4dc \uc815\ube44/\uc7ac\uc2dc\uc791",id:"\ub178\ub4dc-\uc815\ube44\uc7ac\uc2dc\uc791",level:3},{value:"Rook \ucef4\ud3ec\ub10c\ud2b8 scale up",id:"rook-\ucef4\ud3ec\ub10c\ud2b8-scale-up",level:3},{value:"Ceph OSD \uc124\uc815",id:"ceph-osd-\uc124\uc815-1",level:3}];function a(e){const o={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.h2,{id:"\ub178\ub4dc-\ud55c-\ub300-\uc7ac\uc2dc\uc791",children:"\ub178\ub4dc \ud55c \ub300 \uc7ac\uc2dc\uc791"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-shell",children:"for _option in noout; do\n    kubectl rook-ceph ceph osd set ${_option}\ndone\n"})}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-shell",children:"kubectl cordon <node>\n"})}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-shell",children:"kubectl drain <node> --ignore-daemonsets --delete-emptydir-data\n"})}),"\n",(0,r.jsx)(o.p,{children:"\ud574\ub2f9 \ub178\ub4dc\uc5d0 \uc811\uc18d\ud558\uac70\ub098 IPMI \ub4f1\uc744 \ud1b5\ud574 \ub178\ub4dc\ub97c \uc7ac\uc2dc\uc791\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-shell",children:"kubectl uncordon <node>\n"})}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-shell",children:"for _option in noout; do\n    kubectl rook-ceph ceph osd unset ${_option}\ndone\n"})}),"\n",(0,r.jsx)(o.h2,{id:"\uc804\uccb4-\ub178\ub4dc-\uc7ac\uc2dc\uc791",children:"\uc804\uccb4 \ub178\ub4dc \uc7ac\uc2dc\uc791"}),"\n",(0,r.jsx)(o.admonition,{title:"Reference",type:"info",children:(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsx)(o.li,{children:(0,r.jsx)(o.a,{href:"https://rook.io/docs/rook/latest-release/Upgrade/node-maintenance",children:"Rook / Upgrade / Node Maintenance"})}),"\n"]})}),"\n",(0,r.jsx)(o.h3,{id:"\uc2a4\ud1a0\ub9ac\uc9c0\ub97c-\uc0ac\uc6a9\ud558\ub294-\ubaa8\ub4e0-\uc11c\ube44\uc2a4-scale-down",children:"\uc2a4\ud1a0\ub9ac\uc9c0\ub97c \uc0ac\uc6a9\ud558\ub294 \ubaa8\ub4e0 \uc11c\ube44\uc2a4 scale down"}),"\n",(0,r.jsx)(o.h3,{id:"ceph-osd-\uc124\uc815",children:"Ceph OSD \uc124\uc815"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-shell",children:"for _option in noout nodown norebalance nobackfill norecover pause; do\n    kubectl rook-ceph ceph osd set ${_option}\ndone\n"})}),"\n",(0,r.jsx)(o.p,{children:"\ub178\ub4dc \uc7ac\uc2dc\uc791 \uc804\uc5d0 ceph\uc774 OSD \uc0c1\ud0dc\ub97c \uccb4\ud06c\ud558\uac70\ub098 \ubcf5\uad6c\ud558\ub824\ub294 \uc2dc\ub3c4\ub97c \uc704\uc758 \uba85\ub839\uc5b4\ub85c \ub9c9\uc544\uc57c\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(o.h3,{id:"rook-\ucef4\ud3ec\ub10c\ud2b8-scale-down",children:"Rook \ucef4\ud3ec\ub10c\ud2b8 scale down"}),"\n",(0,r.jsxs)(o.ol,{children:["\n",(0,r.jsx)(o.li,{children:"Rook Operator"}),"\n",(0,r.jsx)(o.li,{children:"CephFS plugin provisioner"}),"\n",(0,r.jsx)(o.li,{children:"RBD plugin provisioner"}),"\n",(0,r.jsx)(o.li,{children:"OSD"}),"\n",(0,r.jsx)(o.li,{children:"MON"}),"\n",(0,r.jsx)(o.li,{children:"MGR"}),"\n",(0,r.jsx)(o.li,{children:"Etc."}),"\n"]}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-shell",children:"kubectl -n rook-ceph scale deployment rook-ceph-operator --replicas=0\n"})}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-shell",children:"for _category in rook-ceph-rgw csi-cephfsplugin-provisioner csi-rbdplugin-provisioner rook-ceph-osd rook-ceph-mon rook-ceph-mgr rook-ceph-exporter rook-ceph-crashcollector; do\n    for _item in $(kubectl get deployment -n rook-ceph | awk '/^'\"${_category}\"'/{print $1}'); do\n        kubectl -n rook-ceph scale deployment ${_item} --replicas=0;\n        while [[ $(kubectl get deployment -n rook-ceph ${_item} -o jsonpath='{.status.readyReplicas}') != \"\" ]]; do\n            sleep 5;\n        done;\n    done;\ndone\n"})}),"\n",(0,r.jsx)(o.h3,{id:"\ub178\ub4dc-\uc815\ube44\uc7ac\uc2dc\uc791",children:"\ub178\ub4dc \uc815\ube44/\uc7ac\uc2dc\uc791"}),"\n",(0,r.jsx)(o.h3,{id:"rook-\ucef4\ud3ec\ub10c\ud2b8-scale-up",children:"Rook \ucef4\ud3ec\ub10c\ud2b8 scale up"}),"\n",(0,r.jsxs)(o.ol,{children:["\n",(0,r.jsx)(o.li,{children:"MON"}),"\n",(0,r.jsx)(o.li,{children:"OSD, MGR"}),"\n",(0,r.jsx)(o.li,{children:"Etc."}),"\n",(0,r.jsx)(o.li,{children:"Rook Operator"}),"\n"]}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-shell",children:"for _item in $(kubectl get deployment -n rook-ceph | awk '/^rook-ceph-mon/{print $1}'); do\n    kubectl -n rook-ceph scale deployment ${_item} --replicas=1;\n    while [[ $(kubectl get deployment -n rook-ceph ${_item} -o jsonpath='{.status.replicas}') != \"1\" ]]; do\n        sleep 5;\n    done;\ndone\n"})}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-shell",children:"for _category in rook-ceph-mgr rook-ceph-osd; do\n    for _item in $(kubectl get deployment -n rook-ceph | awk '/^'\"${_category}\"'/{print $1}'); do\n        kubectl -n rook-ceph scale deployment ${_item} --replicas=1;\n        while [[ $(kubectl get deployment -n rook-ceph ${_item} -o jsonpath='{.status.replicas}') != \"1\" ]]; do\n            sleep 5;\n        done;\n    done;\ndone\n"})}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-shell",children:"for _category in rook-ceph-exporter rook-ceph-crashcollector; do\n    for _item in $(kubectl get deployment -n rook-ceph | awk '/^'\"${_category}\"'/{print $1}'); do\n        kubectl -n rook-ceph scale deployment ${_item} --replicas=1;\n        while [[ $(kubectl get deployment -n rook-ceph ${_item} -o jsonpath='{.status.replicas}') != \"1\" ]]; do\n            sleep 5;\n        done;\n    done;\ndone\n"})}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-shell",children:"kubectl -n rook-ceph scale deployment rook-ceph-operator --replicas=1\n"})}),"\n",(0,r.jsx)(o.p,{children:"Operator\uac00 \uc2e4\ud589\ub418\uba74 \uc790\ub3d9\uc73c\ub85c \ucef4\ud3ec\ub10c\ud2b8\ub4e4\uc744 \ubcf5\uad6c\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(o.h3,{id:"ceph-osd-\uc124\uc815-1",children:"Ceph OSD \uc124\uc815"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-shell",children:"for _option in noout nodown norebalance nobackfill norecover pause; do\n    kubectl rook-ceph ceph osd unset ${_option}\ndone\n"})}),"\n",(0,r.jsxs)(o.p,{children:["\uc7ac\uc2dc\uc791 \ud6c4 k8s \uc0c1\ud0dc\ub97c \ud655\uc778\ud569\ub2c8\ub2e4. \ubb38\uc81c\uac00 \uc5c6\uc73c\uba74 \uc7ac\uc2dc\uc791 \uc804\uc5d0 ",(0,r.jsx)(o.code,{children:"set"}),"\ud588\ub358 \ud50c\ub798\uadf8\ub4e4\uc744 \ubaa8\ub450 ",(0,r.jsx)(o.code,{children:"unset"})," \uba85\ub839\uc5b4\ub85c \ud574\uc81c\ud569\ub2c8\ub2e4."]})]})}function p(e={}){const{wrapper:o}={...(0,c.R)(),...e.components};return o?(0,r.jsx)(o,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);