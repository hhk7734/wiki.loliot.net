"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[16728],{81185:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>t,contentTitle:()=>c,default:()=>a,frontMatter:()=>i,metadata:()=>l,toc:()=>o});const l=JSON.parse('{"id":"mlops/mlops/kubernetes/tools/k0s","title":"k0s","description":"k0s","source":"@site/docs/mlops/mlops/kubernetes/tools/k0s.mdx","sourceDirName":"mlops/mlops/kubernetes/tools","slug":"/mlops/mlops/kubernetes/tools/k0s","permalink":"/docs/mlops/mlops/kubernetes/tools/k0s","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/mlops/mlops/kubernetes/tools/k0s.mdx","tags":[],"version":"current","lastUpdatedAt":1734021015000,"frontMatter":{"id":"k0s","title":"k0s","sidebar_label":"k0s","description":"k0s","keywords":["k0s"]},"sidebar":"mlops","previous":{"title":"Helm\uc73c\ub85c \ubc30\ud3ec\ud558\uae30","permalink":"/docs/mlops/mlops/kubernetes/tools/helm"},"next":{"title":"Etc","permalink":"/docs/mlops/mlops/kubernetes/tools/etc"}}');var r=n(74848),d=n(28453);const i={id:"k0s",title:"k0s",sidebar_label:"k0s",description:"k0s",keywords:["k0s"]},c=void 0,t={},o=[{value:"\uc124\uce58",id:"\uc124\uce58",level:2},{value:"\uc758\uc874\uc131 \ud655\uc778",id:"\uc758\uc874\uc131-\ud655\uc778",level:2},{value:"Controller",id:"controller",level:2},{value:"start",id:"start",level:3},{value:"kubeconfig",id:"kubeconfig",level:3},{value:"stop",id:"stop",level:3},{value:"Worker",id:"worker",level:2},{value:"token",id:"token",level:3},{value:"start",id:"start-1",level:3}];function h(e){const s={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h2,{id:"\uc124\uce58",children:"\uc124\uce58"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://docs.k0sproject.io/head/install/",children:"https://docs.k0sproject.io/head/install/"})}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"curl -sSLf https://get.k0s.sh | sudo K0S_VERSION=v1.27.10+k0s.0 sh\n"})}),"\n",(0,r.jsx)(s.h2,{id:"\uc758\uc874\uc131-\ud655\uc778",children:"\uc758\uc874\uc131 \ud655\uc778"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"k0s sysinfo\n"})}),"\n",(0,r.jsxs)(s.admonition,{type:"info",children:[(0,r.jsx)(s.p,{children:"\ub7a8\uc774 \ubd80\uc871\ud55c \ud658\uacbd\uc778 \uacbd\uc6b0 swap\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."}),(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://docs.k0sproject.io/head/system-requirements/",children:"https://docs.k0sproject.io/head/system-requirements/"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/docs/linux/kernel/storage/swap",children:"Swap Memory"})}),"\n"]})]}),"\n",(0,r.jsx)(s.h2,{id:"controller",children:"Controller"}),"\n",(0,r.jsx)(s.h3,{id:"start",children:"start"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"k0s config create > k0s.yaml\n"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://docs.k0sproject.io/head/configuration/",children:"https://docs.k0sproject.io/head/configuration/"})}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-yaml",metastring:'title="k0s.yaml"',children:"apiVersion: k0s.k0sproject.io/v1beta1\nkind: ClusterConfig\nmetadata:\n  name: k0s\nspec:\n  api:\n    # externalAddress - loadbalancer - controllers\n    # \ubaa8\ub4e0 \ud074\ub7ec\uc2a4\ud130 \ucef4\ud3ec\ub10c\ud2b8\uac00 \uc774 \uc8fc\uc18c\ub97c \uc0ac\uc6a9\ud558\ub3c4\ub85d \uc124\uc815\n    # \uc0c8 Node\uac00 \ucd94\uac00\ub420 \ub54c \uc0ac\uc6a9\n    externalAddress: <host|ip>\n    # API\uc5d0 \ubc14\uc778\ub529\ud560 \ub85c\uceec \uc8fc\uc18c\n    address: <host|ip>\n    # \uc778\uc99d\uc11c\ub97c \uc11c\ube59\ud558\ub294 API \uc11c\ubc84\uc5d0 \ub123\uc744 \ucd94\uac00 \uc8fc\uc18c\n    sans:\n      - <address>\n      - <externalAddress>\n      - <host|ip>\n  storage:\n    type: etcd\n    etcd:\n      peerAddress: <address>\n  network:\n    podCIDR: 10.244.0.0/16 # 10.244.0.1 ~ 10.244.255.255\n    serviceCIDR: 10.96.0.0/12 # 10.96.0.1 ~ 10.111.255.255\n    clusterDomain: cluster.local\n  telemetry:\n    enabled: false\n"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"api"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"extraArgs"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"oidc-issuer-url: <url>/.well-known/openid-configuration"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"oidc-client-id: <clientID>"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"oidc-username-claim: email"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"oidc-groups-claim: groups"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"network"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"provider: kuberouter|calico|custom"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"default: kuberouter"}),"\n",(0,r.jsx)(s.li,{children:"\ub124\ud2b8\uc6cc\ud06c \ud504\ub85c\ubc14\uc774\ub354\ub97c \ubcc0\uacbd\ud558\ub294 \uc720\uc77c\ud55c \ubc29\ubc95\uc740 \ud074\ub7ec\uc2a4\ud130\ub97c \uc7ac\ubc30\ud3ec\ud558\ub294 \uac83\uc785\ub2c8\ub2e4."}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://docs.cilium.io/en/stable/installation/k0s/",children:"Cilium \uc0ac\uc6a9\ud558\uae30"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"kubeProxy"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"disabled: true|false"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"\uc544\ub798 \uba85\ub839\uc5b4\ub97c \ud1b5\ud574 controller \uc11c\ube44\uc2a4\ub97c \uc124\uce58\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"sudo k0s install controller \\\n  --config k0s.yaml\n"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"--enable-worker"}),": controller, worker\ub97c \ubaa8\ub450 \uc124\uce58\ud569\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"--single"}),": controller + worker, worker\ub97c \ucd94\uac00\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"--kubelet-extra-args <extraArgs>"}),": kubelet \uc635\uc158","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"--node-ip=<ip>"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"--enable-dynamic-config"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"\ub3d9\uc801\uc73c\ub85c \uad6c\uc131\uc744 \ubcc0\uacbd\ud560 \uc218 \uc788\ub294 \uae30\ub2a5\uc744 \ud65c\uc131\ud654 \ud569\ub2c8\ub2e4."}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"spec.api"}),", ",(0,r.jsx)(s.code,{children:"spec.storage"}),", ",(0,r.jsx)(s.code,{children:"spec.network.podCIDR"}),", ",(0,r.jsx)(s.code,{children:"spec.network.serviceCIDR"}),", ",(0,r.jsx)(s.code,{children:"spec.network.provider"}),"\ub294 \ubcc0\uacbd\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://docs.k0sproject.io/head/networking/",children:"https://docs.k0sproject.io/head/networking/"})}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"\ud544\uc694\ud55c \ud3ec\ud2b8\uac00 \uc5f4\ub824\uc788\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Protocol"}),(0,r.jsx)(s.th,{children:"Port"}),(0,r.jsx)(s.th,{children:"Service"}),(0,r.jsx)(s.th,{children:"Direction"}),(0,r.jsx)(s.th,{children:"Notes"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"TCP"}),(0,r.jsx)(s.td,{children:"2380"}),(0,r.jsx)(s.td,{children:"etcd peers"}),(0,r.jsx)(s.td,{children:"controller<->controller"}),(0,r.jsx)(s.td,{})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"TCP"}),(0,r.jsx)(s.td,{children:"6443"}),(0,r.jsx)(s.td,{children:"Kubernetes API Server"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"worker=>controller"})}),(0,r.jsx)(s.td,{})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"TCP"}),(0,r.jsx)(s.td,{children:"179"}),(0,r.jsx)(s.td,{children:"kube-router"}),(0,r.jsx)(s.td,{children:"worker<->worker"}),(0,r.jsx)(s.td,{children:"BGP"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"TCP"}),(0,r.jsx)(s.td,{children:"4789"}),(0,r.jsx)(s.td,{children:"Calico"}),(0,r.jsx)(s.td,{children:"worker<->worker"}),(0,r.jsx)(s.td,{children:"VXLAN"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"TCP"}),(0,r.jsx)(s.td,{children:"10250"}),(0,r.jsx)(s.td,{children:"kubelet"}),(0,r.jsx)(s.td,{children:'master,worker=>host "*"'}),(0,r.jsx)(s.td,{})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"TCP"}),(0,r.jsx)(s.td,{children:"9443"}),(0,r.jsx)(s.td,{children:"k0s-api"}),(0,r.jsx)(s.td,{children:"controller<->controller"}),(0,r.jsx)(s.td,{})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"TCP"}),(0,r.jsx)(s.td,{children:"8132"}),(0,r.jsx)(s.td,{children:"konnectivity"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"worker<->controller"})}),(0,r.jsx)(s.td,{})]})]})]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"sudo k0s start\n"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"sudo k0s status\n"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"--out <format>"}),": json \ub610\ub294 yaml \ud615\uc2dd\uc73c\ub85c \ucd9c\ub825"]}),"\n"]}),"\n",(0,r.jsxs)(s.admonition,{type:"info",children:[(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"sudo k0s status"})," \uac12\uc774 \uc548\ub098\uc624\uac70\ub098 \uc5d0\ub7ec\uac00 \uc788\ub2e4\uace0 \ub098\uc624\ub294 \uacbd\uc6b0 \uc544\ub798 \uba85\ub839\uc5b4\ub97c \ud1b5\ud574 \uc2e4\ud589 \uc0c1\ud0dc\uc640 \ub85c\uadf8\ub97c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"systemctl status k0scontroller\n"})}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"journalctl -xe -u k0scontroller\n"})})]}),"\n",(0,r.jsx)(s.h3,{id:"kubeconfig",children:"kubeconfig"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://docs.k0sproject.io/head/user-management/",children:"https://docs.k0sproject.io/head/user-management/"})}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"sudo k0s kubeconfig create <user>\n"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"--groups <group>"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"system:masters"})," \uadf8\ub8f9\uc740 \uae30\ubcf8\uc801\uc73c\ub85c cluster-admin ClusterRole\uc5d0 \ubc14\uc778\ub529\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"stop",children:"stop"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"sudo k0s stop\n"})}),"\n",(0,r.jsx)(s.p,{children:"\ub2e4\uc2dc \uc2dc\uc791\ud560 \uc77c\uc774 \uc5c6\uc5b4 \uc644\uc804\ud788 \uc0ad\uc81c\ud558\uace0 \uc2f6\uc740 \uacbd\uc6b0 \uc544\ub798 \uba85\ub839\uc5b4\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"sudo k0s reset\n"})}),"\n",(0,r.jsx)(s.h2,{id:"worker",children:"Worker"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://docs.k0sproject.io/head/k0s-multi-node/",children:"https://docs.k0sproject.io/head/k0s-multi-node/"})}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"token",children:"token"}),"\n",(0,r.jsx)(s.p,{children:"\ub9c8\uc2a4\ud130 \ub178\ub4dc\uc5d0\uc11c \uc544\ub798 \uba85\ub839\uc5b4\ub97c \ud1b5\ud574 \ud1a0\ud070\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"sudo k0s token create --role=worker --expiry=1h > <tokenFile>\n"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"cat <tokenFile> | base64 -d | gunzip -\n"})}),"\n",(0,r.jsx)(s.h3,{id:"start-1",children:"start"}),"\n",(0,r.jsx)(s.p,{children:"\uc791\uc5c5 \ub178\ub4dc\uc5d0\uc11c \uc544\ub798 \uba85\ub801\uc5b4\ub97c \ud1b5\ud574 worker \uc11c\ube44\uc2a4\ub97c \uc124\uce58\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"sudo k0s install worker --token-file <tokenFile>\n"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"--kubelet-extra-args <extraArgs>"}),": kubelet \uc635\uc158","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"--node-ip=<ip>"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"--labels <key>=<value>[,<key>=<vlaue> ...]"}),": Node labels","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"kubernetes.io/role=worker"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"--taints <key>=<value>:<effect>[,<key>=<value>:<effect> ...]"}),": Node taints","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"node.cilium.io/agent-not-ready=true:NoExecute"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"sudo k0s start\n"})}),"\n",(0,r.jsxs)(s.admonition,{type:"info",children:[(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"sudo k0s status"})," \uac12\uc774 \uc548\ub098\uc624\uac70\ub098 \uc5d0\ub7ec\uac00 \uc788\ub2e4\uace0 \ub098\uc624\ub294 \uacbd\uc6b0 \uc544\ub798 \uba85\ub839\uc5b4\ub97c \ud1b5\ud574 \uc2e4\ud589 \uc0c1\ud0dc\uc640 \ub85c\uadf8\ub97c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"systemctl status k0sworker\n"})}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"journalctl -xe -u k0sworker\n"})})]})]})}function a(e={}){const{wrapper:s}={...(0,d.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>i,x:()=>c});var l=n(96540);const r={},d=l.createContext(r);function i(e){const s=l.useContext(d);return l.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),l.createElement(d.Provider,{value:s},e.children)}}}]);